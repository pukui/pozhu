<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>9.5-9.9做题总结 | Pozhu's blog</title><meta name="keywords" content="解题报告"><meta name="author" content="Pozhu"><meta name="copyright" content="Pozhu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="9.5-9.9做题总结">
<meta property="og:type" content="article">
<meta property="og:title" content="9.5-9.9做题总结">
<meta property="og:url" content="http://pukui.github.io/2022/09/10/9-5-9-9%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="Pozhu&#39;s blog">
<meta property="og:description" content="9.5-9.9做题总结">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s1.328888.xyz/2022/08/10/4eAxp.webp">
<meta property="article:published_time" content="2022-09-10T00:28:03.000Z">
<meta property="article:modified_time" content="2022-09-14T09:15:16.685Z">
<meta property="article:author" content="Pozhu">
<meta property="article:tag" content="解题报告">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s1.328888.xyz/2022/08/10/4eAxp.webp"><link rel="shortcut icon" href="https://s1.328888.xyz/2022/09/09/91KLp.png"><link rel="canonical" href="http://pukui.github.io/2022/09/10/9-5-9-9%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '9.5-9.9做题总结',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-09-14 17:15:16'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/07/27/Ds1AN.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s1.328888.xyz/2022/08/10/4eAxp.webp')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Pozhu's blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">9.5-9.9做题总结</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2022-09-10T00:28:03.000Z" title="发表于 2022-09-10 08:28:03">2022-09-10</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/">做题总结</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.9k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>40分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="9.5-9.9做题总结"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="9-5"><a href="#9-5" class="headerlink" title="9.5"></a>9.5</h1><h2 id="A"><a href="#A" class="headerlink" title="A"></a>A</h2><p>长度为 $2^N$ 的序列 $A$ ，编号 $0..2^N-1$<br>对于每一个 $K (0 &lt; k &lt; 2^N)$ ，求 $\max(A_i + A_j) (i \text{ or } j \le K )$</p>
<p>数学题，码量很小，把 $i,j$ 看成二进制下 $1$ 的集合，就相当于 $i \subseteq k, j \subseteq k $</p>
<p>也就是对于每个 $k$ 去寻找子集最大值和次大值进行一个相加就是答案。</p>
<p>考虑维护这个子集信息，发现可以搞一个 $n$ 维的前缀$\max$ 。然后就行了，写成代码就像是这样 ： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 20</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> inf 1e9</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">node</span>&#123;</span><br><span class="line">    <span class="type">int</span> m1,m2;</span><br><span class="line">    <span class="built_in">node</span>()&#123;&#125;</span><br><span class="line">    <span class="built_in">node</span>(<span class="type">int</span> _x,<span class="type">int</span> _y) : <span class="built_in">m1</span>(_x),<span class="built_in">m2</span>(_y)&#123;&#125;</span><br><span class="line">    <span class="keyword">friend</span> node <span class="keyword">operator</span> + (node a,node b)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a.m1 &gt; b.m1) <span class="keyword">return</span> node&#123;a.m1,<span class="built_in">max</span>(a.m2,b.m1)&#125;;</span><br><span class="line">        <span class="keyword">return</span> node&#123;b.m1,<span class="built_in">max</span>(a.m1,b.m2)&#125;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;a[<span class="number">1</span> &lt;&lt; N];</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> n,m;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios :: <span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    m = <span class="number">1</span> &lt;&lt; n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; m;i++) cin &gt;&gt; a[i].m1,a[i].m2 = -inf;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; n;i++) </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>;j &lt; m;j++) </span><br><span class="line">    <span class="keyword">if</span>((j &gt;&gt; i) &amp; <span class="number">1</span>) a[j] = a[j] + a[j ^ (<span class="number">1</span> &lt;&lt; i)];</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>;j &lt; m;j++)</span><br><span class="line">    ans = <span class="built_in">max</span>(ans,a[j].m1 + a[j].m2),cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="B"><a href="#B" class="headerlink" title="B"></a>B</h2><p>对于两个长度为 $n$ 的 $01$ 串 $s,t$ ，你可以对 $s$ 进行两种操作：把相邻两个 $0$ 变成 $1$ 或把相邻两个 $1$ 变成 $0$ ，定义 $s$ 到 $t$ 的距离为最少操作次数使得 $s$ 变成 $t$ ，如过没法变则距离为 $0$ 。</p>
<p>现在你有两个不完整的字符串，可以把其中的 $?$ 变成 $0$ 或 $1$ ，求所有情况所得到的两个 $01$ 串的距离之和。</p>
<p>多组数据。</p>
<p>考虑把奇数（或者偶数也一样）位置的字符取反，这样我们就把反转操作变成了交换相邻不同项。</p>
<p>我们把取反后的字符串记为 $s’,t’$ 显然充要条件是两字符串中 $1$ 的个数相同。</p>
<p>可以考了通过计算逆序对数来解决这个问题，但是对于 $01$ 串有更好计算的结论 ： 设 $s′$ 中第 $i$ 个 $1$ 的下标为 $x_i$，$t′$ 中第 $i$ 个 $1$ 的下标为 $yi$，那么最少交换次数为  $|xi−yi|$ , 其中 $c$ 表示 $s′,t′$ 中 $1$ 的个数.</p>
<p>考虑进一步化简，设 $a_i$ 表示 $s′$ 中前 $i$ 个数中 $1$ 的个数， $b_i$  表示 $t′$ 中前 $i$ 个数中 $1$ 的个数，答案就是 $\sum_{i=1}^|ai−bi|$。因为每次交换两个数，最多只能使一个前缀和发生变化。</p>
<p>然后就简单了，我们记 $pre_{i,j}$ 表示前 $i$ 个数使得 $ai−bi=j$ 的方案数， $suf_{i,j}$ 表示对应后缀的方案数，那么贡献就是  $pre_{i,j}×suf_{i+1,−j}×|j|$ 。</p>
<p>代码 ：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 2010</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> p = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">eq</span><span class="params">(<span class="type">char</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> a == <span class="string">&#x27;?&#x27;</span> || a == b + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">char</span> a[N],b[N];</span><br><span class="line">ll suf[N][N &lt;&lt; <span class="number">1</span>],pre[N][N &lt;&lt; <span class="number">1</span>];</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%s%s&quot;</span>,&amp;n,a+<span class="number">1</span>,b+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt;= n + <span class="number">1</span>;i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>;j &lt;= n &lt;&lt; <span class="number">1</span>;j++)</span><br><span class="line">    suf[i][j] = pre[i][j] = <span class="number">0</span> ;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i&lt;=n;i+=<span class="number">2</span>) </span><br><span class="line">    <span class="keyword">if</span>(a[i] != <span class="string">&#x27;?&#x27;</span>) a[i] = (a[i] ^ <span class="number">48</span> ^ <span class="number">1</span>) + <span class="number">48</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i&lt;=n;i+=<span class="number">2</span>) </span><br><span class="line">    <span class="keyword">if</span>(b[i] != <span class="string">&#x27;?&#x27;</span>) b[i] = (b[i] ^ <span class="number">48</span> ^ <span class="number">1</span>) + <span class="number">48</span>;</span><br><span class="line">    pre[<span class="number">0</span>][n] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">0</span>;i &lt; n;i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>;j &lt;= n &lt;&lt; <span class="number">1</span>;j++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k &lt;= <span class="number">1</span>;k++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> q = <span class="number">0</span>;q &lt;= <span class="number">1</span>;q++)</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">eq</span>(a[i + <span class="number">1</span>],k) &amp;&amp; <span class="built_in">eq</span>(b[i + <span class="number">1</span>],q) &amp;&amp; j + k - q &gt;= <span class="number">0</span>)</span><br><span class="line">    (pre[i + <span class="number">1</span>][j + k - q] += pre[i][j]) %= p;</span><br><span class="line">    suf[n + <span class="number">1</span>][n] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = n + <span class="number">1</span>;i &gt;= <span class="number">2</span>;i--)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>;j &lt;= n &lt;&lt; <span class="number">1</span>;j++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k &lt;= <span class="number">1</span>;k++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> q = <span class="number">0</span>;q &lt;= <span class="number">1</span>;q++)</span><br><span class="line">    <span class="keyword">if</span>(<span class="built_in">eq</span>(a[i - <span class="number">1</span>],k) &amp;&amp; <span class="built_in">eq</span>(b[i - <span class="number">1</span>],q) &amp;&amp; j + k - q &gt;= <span class="number">0</span>)</span><br><span class="line">    (suf[i - <span class="number">1</span>][j + k - q] += suf[i][j]) %= p;</span><br><span class="line">    ll ans = <span class="number">0ll</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = -n;j&lt;=n;j++)</span><br><span class="line">    (ans += pre[i][j + n] * suf[i + <span class="number">1</span>][n - j] % p * <span class="built_in">abs</span>(j) % p) %= p;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,ans);</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line">    <span class="keyword">for</span>(<span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);T;T--)</span><br><span class="line">    <span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="C"><a href="#C" class="headerlink" title="C"></a>C</h2><p>给定一个整数数列 $a$，定义 $f(a)=\max_{1\leq i<j \leq n}(a_j-a_i)$，保证 $f(a)>0f(a)&gt;0$。</p>
<p>你需要求出至少需要修改 $a$ 的多少个位置才能使 $f(a)$ 变小。</p>
<p>注意，你修改之后的数也必须是整数。</p>
<p>首先原序列的 $f(x)$ 值 $O(n)$ 易求。然后考虑改变谁的值使答案变小。</p>
<p>容易发现贡献是这样产生的（假装有图）</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">    ----</span><br><span class="line">    /</span><br><span class="line">   /           ---</span><br><span class="line">  /            /</span><br><span class="line"> /            /</span><br><span class="line">---          /</span><br><span class="line">            /</span><br><span class="line">         -----</span><br><span class="line">                        -　----</span><br><span class="line">                         /</span><br><span class="line">                        /</span><br><span class="line">                       /</span><br><span class="line">                      /</span><br><span class="line">                   ---   -  </span><br></pre></td></tr></table></figure>
<p>并且除此之外的部分都不会有贡献，容易找到这样的每一部分，总答案就是每部分答案的和。</p>
<p>考虑如何计算每一部分的答案，考虑在每部分中找到一个点，改变它前缀小值和后缀大值，这个节点通过枚举找到最小贡献，处理前缀后缀可以线性预处理，然而用一些小trick可以避免这个东西。</p>
<p>然后没了</p>
<p>代码 ： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 1000010</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> inf 1000000000</span></span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line"><span class="type">int</span> ans;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"><span class="type">int</span> premin = inf;</span><br><span class="line"><span class="type">int</span> maxx,mxnum;</span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;n);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i&lt;=n;i++) </span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;a[i]);</span><br><span class="line">        premin = <span class="built_in">min</span>(premin,a[i]);</span><br><span class="line">        maxx = <span class="built_in">max</span>(maxx,a[i] - premin);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> i,j,cnt1,cnt2;</span><br><span class="line">    <span class="keyword">for</span>(i = <span class="number">1</span>;i&lt;=n;i=j,ans += cnt2)</span><br><span class="line">    <span class="keyword">for</span>(j = i,cnt1 = <span class="number">0</span>,cnt2 = <span class="number">0</span>; j &lt;= n &amp;&amp; a[i] &lt;= a[j];j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(a[j] == a[i]) cnt1++;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span>(a[j] - a[i] == maxx)</span><br><span class="line">        &#123;</span><br><span class="line">            cnt1--;</span><br><span class="line">            cnt2 = <span class="built_in">min</span>(cnt2,cnt1);</span><br><span class="line">            ans++;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">     </span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,ans);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="9-6"><a href="#9-6" class="headerlink" title="9.6"></a>9.6</h1><h2 id="A-1"><a href="#A-1" class="headerlink" title="A"></a>A</h2><p>有 $n$ 个数。你需要找出它们的一个排列，满足 $m$ 个条件，每个条件形如 $x_a$ 必须在 $x_b$ 之前。</p>
<p>在此基础上，你要最大化这个排列的子段和。</p>
<p>考虑网络流，首先计算整个序列的正数和，然后考虑减去不合法的贡献。</p>
<p>我们把每个正数拆成两个点，一个连源点，一个连汇点。</p>
<p>然后把每个负数拆成两个点，自己连自己。</p>
<p>对于一个 $x$ 必须在 $y$ 之前的限制，我们在两边的点对 $x$ 向 $y$ 连边，容易发现这样跑出来的二分图最小割就是不合法贡献，减去即可</p>
<p>代码 ： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">namespace</span> Pozhu&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> in(i) (i)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> out(i) (i + n)</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> N = <span class="number">2010</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> M = <span class="number">1e6</span> + <span class="number">10</span>;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> INF = <span class="number">0x3f3f3f3f</span>;</span><br><span class="line"><span class="type">int</span> a[N];</span><br><span class="line"> </span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="type">int</span> v, nxt, w;</span><br><span class="line">&#125; e[M];</span><br><span class="line"><span class="type">int</span> cur[N], head[N], cnt = <span class="number">1</span>;</span><br><span class="line"><span class="type">int</span> dis[N];</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> v, <span class="type">int</span> w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    e[++cnt].v = v;</span><br><span class="line">    e[cnt].w = w;</span><br><span class="line">    e[cnt].nxt = head[u];</span><br><span class="line">    head[u] = cnt;</span><br><span class="line"> </span><br><span class="line">    e[++cnt].v = u;</span><br><span class="line">    e[cnt].w = <span class="number">0</span>;</span><br><span class="line">    e[cnt].nxt = head[v];</span><br><span class="line">    head[v] = cnt;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">bool</span> <span class="title">bfs</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">memset</span>(dis, <span class="number">0</span>, <span class="built_in">sizeof</span>(dis));</span><br><span class="line">    <span class="built_in">memcpy</span>(cur, head, <span class="built_in">sizeof</span>(head));</span><br><span class="line">    queue&lt;<span class="type">int</span>&gt; q;</span><br><span class="line">    q.<span class="built_in">push</span>(s);</span><br><span class="line">    dis[s] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">while</span> (!q.<span class="built_in">empty</span>())</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> u = q.<span class="built_in">front</span>();</span><br><span class="line">        q.<span class="built_in">pop</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = head[u]; i; i = e[i].nxt)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> v = e[i].v;</span><br><span class="line">            <span class="keyword">if</span> (!dis[v] &amp;&amp; e[i].w)</span><br><span class="line">            &#123;</span><br><span class="line">                dis[v] = dis[u] + <span class="number">1</span>;</span><br><span class="line">                q.<span class="built_in">push</span>(v);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dis[t];</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u, <span class="type">int</span> flow, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (u == t || !flow)</span><br><span class="line">        <span class="keyword">return</span> flow;</span><br><span class="line">    <span class="type">int</span> rest = flow, i;</span><br><span class="line">    <span class="keyword">for</span> (i = cur[u]; i; i = e[i].nxt)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v = e[i].v;</span><br><span class="line">        <span class="keyword">if</span> (dis[v] == dis[u] + <span class="number">1</span> &amp;&amp; e[i].w)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> k = <span class="built_in">dfs</span>(v, <span class="built_in">min</span>(rest, e[i].w), t);</span><br><span class="line">            <span class="keyword">if</span> (!k)</span><br><span class="line">                dis[v] = <span class="number">0</span>;</span><br><span class="line">            e[i].w -= k, e[i ^ <span class="number">1</span>].w += k;</span><br><span class="line">            rest -= k;</span><br><span class="line">            <span class="keyword">if</span> (rest == <span class="number">0</span>)</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    cur[u] = i;</span><br><span class="line">    <span class="keyword">return</span> flow - rest;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dinic</span><span class="params">(<span class="type">int</span> s, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line"> </span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">bfs</span>(s, t))</span><br><span class="line">        ans += <span class="built_in">dfs</span>(s, INF, t);</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;n, &amp;m);</span><br><span class="line">    <span class="type">int</span> sum = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;a[i]);</span><br><span class="line">        <span class="keyword">if</span> (a[i] &gt; <span class="number">0</span>)</span><br><span class="line">            sum += a[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> s = <span class="number">2</span> * n + <span class="number">1</span>, t = s + <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (a[i] &gt;= <span class="number">0</span>)</span><br><span class="line">            <span class="built_in">add</span>(s, <span class="built_in">in</span>(i), a[i]), <span class="built_in">add</span>(<span class="built_in">out</span>(i), t, a[i]);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">add</span>(<span class="built_in">in</span>(i), <span class="built_in">out</span>(i), -a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> a, b;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>, &amp;a, &amp;b);</span><br><span class="line">        <span class="built_in">add</span>(<span class="built_in">in</span>(a), <span class="built_in">in</span>(b), INF);</span><br><span class="line">        <span class="built_in">add</span>(<span class="built_in">out</span>(a), <span class="built_in">out</span>(b), INF);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>, sum - <span class="built_in">dinic</span>(s, t));</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Pozhu::<span class="built_in">main</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="B-1"><a href="#B-1" class="headerlink" title="B"></a>B</h2><p>给定整数 $A,B,V,M$ ，其中 $A,B$ 保证互质。另外，还有一个整数 $x$，初始化为 $x=V$。</p>
<p>您可以按任意顺序执行以下四种操作，次数不限。</p>
<ul>
<li>x &lt;- x+A</li>
<li>x &lt;- x-A</li>
<li>x &lt;- x+B</li>
<li>x &lt;- x-B</li>
</ul>
<p>操作过程中， $0 \le x \le M$ 必须在任意时刻成立<br>问 $x$ 可以有多少种不同取值。</p>
<p>乍一眼是类欧题，再看看更像类欧题，但是实际上因为类欧没有考虑过程中可能会出现的越界情况本题至少我目前没有发现类欧解法。</p>
<p>于是看题解，题解使用了强周期引理进行特判 ： </p>
<p>若 $a + b \le m+1$，则答案为 $m+1$ ，<a target="_blank" rel="noopener" href="http://xsy.gdgzez.com.cn/JudgeOnline/viewsolution.php?cid=1920&amp;pid=1">证明</a></p>
<p>剩下的情况就是两条链，一条链是 $+a,-b$ 得到的结果，另一条链是 $-a,+b$ 得到的结果。</p>
<p>可以证明两链没有公共点（无重复情况）</p>
<p>所以答案就是两链边数和加一。</p>
<p>考虑实现发现不好实现，于是直接贴代码 ： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">namespace</span> Pozhu</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line">    ll a, b, v, m;</span><br><span class="line"></span><br><span class="line">    <span class="function">ll <span class="title">solve</span><span class="params">(ll , ll, ll, ll, ll, ll )</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        cin &gt;&gt; a &gt;&gt; b &gt;&gt; v &gt;&gt; m;</span><br><span class="line">        <span class="keyword">if</span> (a &gt; b)</span><br><span class="line">            <span class="built_in">swap</span>(a,b);</span><br><span class="line">        <span class="keyword">if</span> (a + b &lt;= m + <span class="number">1</span>)</span><br><span class="line">            cout &lt;&lt; m + <span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            cout &lt;&lt; <span class="built_in">solve</span>(a, b, v, m, <span class="number">1</span>, <span class="number">1</span>) + <span class="built_in">solve</span>(a, b, m - v, m, <span class="number">1</span>, <span class="number">1</span>) + <span class="number">1</span> &lt;&lt; endl;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function">ll <span class="title">solve</span><span class="params">(ll a, ll b, ll v, ll m, ll x, ll y)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (v &gt;= a)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">solve</span>(a, b, v % a, m, x, y) + v / a * y;</span><br><span class="line">        <span class="keyword">if</span> (b + v &gt; m)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">solve</span>(b % a, a, m - b + b % a - v, m - b + b % a, y, x + b / a * y);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> T;</span><br><span class="line">    <span class="keyword">for</span> (std ::cin &gt;&gt; T; T; T--)</span><br><span class="line">        Pozhu ::<span class="built_in">main</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="C-1"><a href="#C-1" class="headerlink" title="C"></a>C</h2><p>给一个长度为 $N$ 的数列 $A_{1..N}$ 和整数 $X$</p>
<p>求有多少个 $\{1,2,\dots,n\}$ 的子集 $S$ 使 $ \forall i,j\in S,A_i\,\text{xor}\,A_j\le X$ 对 $998244353$ 取模</p>
<p>经典异或题，经典 $01 trie$ 。<br>$f(u,v)$ 表示从 $u$ 的子树和 $v$ 的子树中选一些数，两两异或不大于 $X$ 的方案数<br>答案是 $f(1,1)$<br>如果 $X$ 当前位是 $0$ ，那么  $f(u,v)=f(lsu,lsv)+f(rsu,rsv)−1$ ，减 $1$ 是减掉出现两次的空集，如果 $u\neq v$，也就是更高位出现了 $1$ ，如果现在只在一颗子树中选相当于撤回了更高位的 $1$ ，就不需要考虑这一位了，补上对应的方案<br>如果 $X$ 当前位是 $1$ ，如果 $u=v，f(u,u)=f(lsu,rsu)$ ，如果 $u\neq v$，发现 $f(lsu,rsv)$ 与 $f(rsu,lsv)$ 相互独立，也就是 $f(u,v)=f(lsu,rsv)×f(rsu,lsv)$</p>
<p>于是贴一下别人代码 ： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**************************************************************</span></span><br><span class="line"><span class="comment">    Problem: 4595</span></span><br><span class="line"><span class="comment">    User: 2022hb07</span></span><br><span class="line"><span class="comment">    Language: C++</span></span><br><span class="line"><span class="comment">    Result: Accepted</span></span><br><span class="line"><span class="comment">    Time:142 ms</span></span><br><span class="line"><span class="comment">    Memory:148100 kb</span></span><br><span class="line"><span class="comment">****************************************************************/</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> p = <span class="number">998244353</span>;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> Maxn 150010</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> ls(i) ch[i][0]</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> rs(i) ch[i][1]</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> int long long</span></span><br><span class="line"><span class="keyword">namespace</span> IOI</span><br><span class="line">&#123;</span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> ONLINE_JUDGE</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> IOSIZE (1 &lt;&lt; 21)</span></span><br><span class="line"><span class="type">char</span> ibuf[IOSIZE], obuf[IOSIZE];</span><br><span class="line"><span class="type">char</span> *p1 = ibuf, *p2 = ibuf, *p3 = obuf;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> getchar() ((p1 == p2) and (p2 = (p1 = ibuf) + fread(ibuf, 1, IOSIZE, stdin), p1 == p2) ? (EOF) : (*p1++))</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> putchar(x) ((p3 == obuf + IOSIZE) &amp;&amp; (fwrite(obuf, p3 - obuf, 1, stdout), p3 = obuf), *p3++ = x)</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> dwd (fwrite(obuf, p3 - obuf, 1, stdout), void())</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span> <span class="comment">// fread in OJ</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> dwd</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> <span class="comment">// stdio in local</span></span></span><br><span class="line"><span class="type">bool</span> ioflag;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">read</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ioflag = <span class="literal">true</span>;</span><br><span class="line">    <span class="type">int</span> s = <span class="number">0</span>, w = <span class="number">1</span>;</span><br><span class="line">    <span class="type">char</span> c = <span class="built_in">getchar</span>();</span><br><span class="line">    <span class="keyword">while</span> (!<span class="built_in">isdigit</span>(c) <span class="keyword">and</span> c != EOF)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (c == <span class="string">&#x27;-&#x27;</span>)</span><br><span class="line">            w = <span class="number">-1</span>;</span><br><span class="line">        c = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (c == EOF)</span><br><span class="line">        <span class="keyword">return</span> ioflag = <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">isdigit</span>(c))</span><br><span class="line">    &#123;</span><br><span class="line">        s = s * <span class="number">10</span> + c - <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        c = <span class="built_in">getchar</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> s * w;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">write</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">static</span> <span class="type">int</span> st[<span class="number">20</span>];</span><br><span class="line">    <span class="type">int</span> top = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">if</span> (x &lt; <span class="number">0</span>)</span><br><span class="line">        <span class="built_in">putchar</span>(<span class="string">&#x27;-&#x27;</span>), x = -x;</span><br><span class="line">    <span class="keyword">if</span> (x == <span class="number">0</span>)</span><br><span class="line">        st[++top] = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">    <span class="keyword">while</span> (x)</span><br><span class="line">    &#123;</span><br><span class="line">        st[++top] = x % <span class="number">10</span> + <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">        x /= <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (top)</span><br><span class="line">        <span class="built_in">putchar</span>(st[top--]);</span><br><span class="line">&#125;</span><br><span class="line">&#125; <span class="comment">// namespace IOI</span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> IOI;</span><br><span class="line"><span class="type">int</span> n, m;</span><br><span class="line"><span class="type">int</span> f[Maxn];</span><br><span class="line"><span class="type">int</span> ch[Maxn * <span class="number">40</span>][<span class="number">2</span>];</span><br><span class="line"><span class="type">int</span> s[Maxn * <span class="number">40</span>], cnt = <span class="number">1</span>;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">ins</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> w = <span class="number">1</span>;</span><br><span class="line">    s[w]++;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">30</span>; i &gt;= <span class="number">0</span>; i--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (!ch[w][x &gt;&gt; i &amp; <span class="number">1</span>])</span><br><span class="line">            ch[w][x &gt;&gt; i &amp; <span class="number">1</span>] = ++cnt;</span><br><span class="line">        w = ch[w][x &gt;&gt; i &amp; <span class="number">1</span>], s[w]++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">int</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y, <span class="type">int</span> k)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (!x <span class="keyword">or</span> !y)</span><br><span class="line">        <span class="keyword">return</span> f[s[x | y]];</span><br><span class="line">    <span class="keyword">if</span> (x == y)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (k &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> f[s[x]];</span><br><span class="line">        <span class="keyword">if</span> (m &gt;&gt; k &amp; <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">dfs</span>(<span class="built_in">ls</span>(x), <span class="built_in">rs</span>(x), k - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="built_in">return</span> (<span class="built_in">dfs</span>(<span class="built_in">ls</span>(x), <span class="built_in">ls</span>(x), k - <span class="number">1</span>) + <span class="built_in">dfs</span>(<span class="built_in">rs</span>(y), <span class="built_in">rs</span>(y), k - <span class="number">1</span>) - <span class="number">1</span> + p) % p;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span> (k &lt; <span class="number">0</span>)</span><br><span class="line">            <span class="keyword">return</span> f[s[x] + s[y]];</span><br><span class="line">        <span class="keyword">if</span> (m &gt;&gt; k &amp; <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">dfs</span>(<span class="built_in">ls</span>(x), <span class="built_in">rs</span>(y), k - <span class="number">1</span>) * <span class="built_in">dfs</span>(<span class="built_in">rs</span>(x), <span class="built_in">ls</span>(y), k - <span class="number">1</span>) % p;</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="type">int</span> res = (<span class="built_in">dfs</span>(<span class="built_in">ls</span>(x), <span class="built_in">ls</span>(y), k - <span class="number">1</span>) + <span class="built_in">dfs</span>(<span class="built_in">rs</span>(x), <span class="built_in">rs</span>(y), k - <span class="number">1</span>) - <span class="number">1</span> + p) % p;</span><br><span class="line">            res = (res + (f[s[<span class="built_in">ls</span>(x)]] - <span class="number">1</span> + p) % p * (f[s[<span class="built_in">rs</span>(x)]] - <span class="number">1</span> + p) % p) % p;</span><br><span class="line">            res = (res + (f[s[<span class="built_in">ls</span>(y)]] - <span class="number">1</span> + p) % p * (f[s[<span class="built_in">rs</span>(y)]] - <span class="number">1</span> + p) % p) % p;</span><br><span class="line">            <span class="keyword">return</span> res;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    n = <span class="built_in">read</span>(), m = <span class="built_in">read</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>, x; i &lt;= n; i++)</span><br><span class="line">        x = <span class="built_in">read</span>(), <span class="built_in">ins</span>(x);</span><br><span class="line">    f[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        f[i] = f[i - <span class="number">1</span>] * <span class="number">2</span> % p;</span><br><span class="line">    <span class="built_in">write</span>((<span class="built_in">dfs</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">30</span>) - <span class="number">1</span> + p) % p);</span><br><span class="line">    <span class="keyword">return</span> dwd;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="9-7"><a href="#9-7" class="headerlink" title="9.7"></a>9.7</h1><p>题面较长所以略去题意简述  </p>
<p>懒得找自己代码所以直接放std（</p>
<h2 id="A-2"><a href="#A-2" class="headerlink" title="A"></a>A</h2><p>简单题，考虑一手枚举是哪只船挡了路，然后计算一下答案即可。</p>
<p>std :<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn = <span class="number">1e5</span> +<span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">edge</span>&#123;</span><br><span class="line">    <span class="type">double</span> v,s,len;</span><br><span class="line">&#125;es[maxn];</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;cruise.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;cruise.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">    <span class="type">int</span> n,test;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;test);</span><br><span class="line">    <span class="keyword">while</span>(test--)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> m = <span class="number">1</span>;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;n);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i &lt;= n + <span class="number">1</span>;i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>,&amp;es[i].len);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i &lt;= n + <span class="number">1</span>;i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>,&amp;es[i].s);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i &lt;= n + <span class="number">1</span>;i++) <span class="built_in">scanf</span>(<span class="string">&quot;%lf&quot;</span>,&amp;es[i].v);</span><br><span class="line">        <span class="type">double</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="type">double</span> lazy = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i &lt;= n + <span class="number">1</span>;i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span>(i != <span class="number">1</span>) lazy += es[i].len;</span><br><span class="line">            <span class="type">double</span> t = (es[i].s + lazy) / es[i].v;</span><br><span class="line">            ans = <span class="built_in">max</span>(t,ans);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%.10f\n&quot;</span>,ans);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h2 id="B-2"><a href="#B-2" class="headerlink" title="B"></a>B</h2><p>欧拉回路相关问题 %%% wx 当场爆切。</p>
<p>每个连通块内奇点两两连边，随便把连通块连起来，然后对整张图随便找个欧拉回路然后把加的虚边去掉剩下的就是路径</p>
<p>std : </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;vector&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;iostream&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL;</span><br><span class="line"><span class="type">const</span> <span class="type">int</span> maxn =<span class="number">1e5</span>+<span class="number">5</span>;</span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">Edge</span>&#123;</span><br><span class="line">    <span class="type">int</span> to,id,next;</span><br><span class="line">    <span class="type">bool</span> f;</span><br><span class="line">&#125;edges[maxn&lt;&lt;<span class="number">4</span>];</span><br><span class="line"><span class="type">int</span> tot,head[maxn],cnt;</span><br><span class="line"><span class="type">bool</span> vis[maxn];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt; res[maxn];</span><br><span class="line"><span class="type">int</span> deg[maxn];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">init</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    tot=<span class="number">0</span>;</span><br><span class="line">    cnt=<span class="number">0</span>;</span><br><span class="line">    <span class="built_in">memset</span>(deg,<span class="number">0</span>,<span class="built_in">sizeof</span>(deg));</span><br><span class="line">    <span class="built_in">memset</span>(vis,<span class="number">0</span>,<span class="built_in">sizeof</span>(vis));</span><br><span class="line">    <span class="built_in">memset</span>(head,<span class="number">-1</span>,<span class="built_in">sizeof</span>(head));</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">AddEdge</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v ,<span class="type">int</span> id)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    edges[tot].f = <span class="number">0</span>;edges[tot].to=v;edges[tot].id = id;edges[tot].next =head[u];</span><br><span class="line">    head[u]=tot++;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vis[u]=<span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//cout&lt;&lt;u&lt;&lt;&quot; in &quot;&lt;&lt;cnt&lt;&lt;endl;</span></span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i=head[u];~i;i=edges[i].next)&#123;</span><br><span class="line">        <span class="type">int</span> v =edges[i].to,id =edges[i].id;</span><br><span class="line">        <span class="keyword">if</span>(!edges[i].f)&#123;</span><br><span class="line">            edges[i].f = edges[i^<span class="number">1</span>].f = <span class="literal">true</span>;       <span class="comment">//将边和反向边标记</span></span><br><span class="line">            <span class="built_in">dfs</span>(v);</span><br><span class="line">            <span class="keyword">if</span>(id) res[cnt].<span class="built_in">push_back</span>(-id);     <span class="comment">//退栈记录边的id</span></span><br><span class="line">            <span class="keyword">else</span> cnt++;                         <span class="comment">//扫到虚边，那么路径加1</span></span><br><span class="line">            <span class="comment">//cout&lt;&lt;u&lt;&lt;&quot; out &quot;&lt;&lt;cnt&lt;&lt;endl;</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Print</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>,cnt<span class="number">-1</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=cnt;++i)&#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;%d&quot;</span>,res[i].<span class="built_in">size</span>());</span><br><span class="line">            <span class="type">int</span> k = res[i].<span class="built_in">size</span>();</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j=<span class="number">0</span>;j&lt;k;++j) <span class="built_in">printf</span>(<span class="string">&quot; %d&quot;</span>,res[i][j]);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">&quot;\n&quot;</span>);</span><br><span class="line">            res[i].<span class="built_in">clear</span>();  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;travelling.in&quot;</span>,<span class="string">&quot;r&quot;</span>,stdin);</span><br><span class="line">    <span class="built_in">freopen</span>(<span class="string">&quot;travelling.out&quot;</span>,<span class="string">&quot;w&quot;</span>,stdout);</span><br><span class="line">    <span class="type">int</span> T,N,M,u,v,tmp;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>, &amp;T);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">while</span>(T--)&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;N,&amp;M);</span><br><span class="line">        <span class="built_in">init</span>();</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=M;++i)&#123;</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">&quot;%d%d&quot;</span>,&amp;u,&amp;v);</span><br><span class="line">            deg[u]++,deg[v]++;</span><br><span class="line">            <span class="built_in">AddEdge</span>(u,v,i);</span><br><span class="line">            <span class="built_in">AddEdge</span>(v,u,-i);</span><br><span class="line">        &#125;</span><br><span class="line">        u=<span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(deg[i]&amp;<span class="number">1</span>)&#123;</span><br><span class="line">                <span class="keyword">if</span>(u)&#123; </span><br><span class="line">                    <span class="built_in">AddEdge</span>(u,i,<span class="number">0</span>);</span><br><span class="line">                    <span class="built_in">AddEdge</span>(i,u,<span class="number">0</span>);</span><br><span class="line">                    u=<span class="number">0</span>;  </span><br><span class="line">                &#125;          <span class="comment">//将奇度数点两两连边</span></span><br><span class="line">                <span class="keyword">else</span> u=i;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!vis[i] &amp;&amp; (deg[i]&amp;<span class="number">1</span>))&#123;   </span><br><span class="line">                cnt++;  </span><br><span class="line">                <span class="built_in">dfs</span>(i);</span><br><span class="line">                cnt--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i=<span class="number">1</span>;i&lt;=N;++i)&#123;</span><br><span class="line">            <span class="keyword">if</span>(!vis[i] &amp;&amp; deg[i])&#123;</span><br><span class="line">                cnt++;</span><br><span class="line">                <span class="built_in">dfs</span>(i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">Print</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="C-2"><a href="#C-2" class="headerlink" title="C"></a>C</h2><p>贪心+分治 罢大概是</p>
<p>状压DP有部分分。</p>
<p>考虑每次处理一个矩形，发现先中间后两边的解法一定能达到最优解，所以每次枚举最后处理哪条边，剩下的递归继续求，搞一个记忆化就能过，挺简单的。</p>
<p>std ： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstdio&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cstring&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;algorithm&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;cmath&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> oo = <span class="number">1000000000</span>;</span><br><span class="line"></span><br><span class="line"><span class="type">char</span> a[<span class="number">10</span>][<span class="number">10</span>];</span><br><span class="line"><span class="type">int</span> f[<span class="number">10</span>][<span class="number">10</span>][<span class="number">10</span>][<span class="number">10</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">calc</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2, <span class="type">int</span> i1, <span class="type">int</span> j1, <span class="type">int</span> i2, <span class="type">int</span> j2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> res = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = i1; i &lt;= i2; ++ i) </span><br><span class="line">		<span class="keyword">for</span> (<span class="type">int</span> j = j1; j &lt;= j2; ++ j) </span><br><span class="line">			<span class="keyword">if</span> (a[i][j] == <span class="string">&#x27;#&#x27;</span>) </span><br><span class="line">				res += <span class="built_in">max</span>(<span class="built_in">max</span>(<span class="built_in">abs</span>(i-x1), <span class="built_in">abs</span>(i-x2)), <span class="built_in">max</span>(<span class="built_in">abs</span>(j-y1), <span class="built_in">abs</span>(j-y2)));</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">dp</span><span class="params">(<span class="type">int</span> x1, <span class="type">int</span> y1, <span class="type">int</span> x2, <span class="type">int</span> y2)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">if</span> (x1 &gt; x2 || y1 &gt; y2) <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">	<span class="type">int</span> &amp;res = f[x1][y1][x2][y2];</span><br><span class="line">	<span class="keyword">if</span> (res &gt; <span class="number">-1</span>) <span class="keyword">return</span> res;</span><br><span class="line">	</span><br><span class="line">	res = <span class="built_in">calc</span>(x1, y1, x2, y2, x1, y1, x1, y2) + <span class="built_in">dp</span>(x1+<span class="number">1</span>, y1, x2, y2);</span><br><span class="line">	res = <span class="built_in">min</span>(res, <span class="built_in">calc</span>(x1, y1, x2, y2, x2, y1, x2, y2) + <span class="built_in">dp</span>(x1, y1, x2<span class="number">-1</span>, y2));</span><br><span class="line">	res = <span class="built_in">min</span>(res, <span class="built_in">calc</span>(x1, y1, x2, y2, x1, y1, x2, y1) + <span class="built_in">dp</span>(x1, y1+<span class="number">1</span>, x2, y2));</span><br><span class="line">	res = <span class="built_in">min</span>(res, <span class="built_in">calc</span>(x1, y1, x2, y2, x1, y2, x2, y2) + <span class="built_in">dp</span>(x1, y1, x2, y2<span class="number">-1</span>));</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">freopen</span>(<span class="string">&quot;station.in&quot;</span>, <span class="string">&quot;r&quot;</span>, stdin);</span><br><span class="line">	<span class="built_in">freopen</span>(<span class="string">&quot;station.out&quot;</span>, <span class="string">&quot;w&quot;</span>, stdout);</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= <span class="number">8</span>; ++ i) </span><br><span class="line">		<span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, a[i] + <span class="number">1</span>);</span><br><span class="line">		</span><br><span class="line">	<span class="built_in">memset</span>(f, <span class="number">-1</span>, <span class="built_in">sizeof</span>(f));</span><br><span class="line">	<span class="built_in">printf</span>(<span class="string">&quot;%d\n&quot;</span>, <span class="built_in">dp</span>(<span class="number">1</span>, <span class="number">1</span>, <span class="number">8</span>, <span class="number">8</span>));</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="9-8"><a href="#9-8" class="headerlink" title="9.8"></a>9.8</h1><h2 id="A-3"><a href="#A-3" class="headerlink" title="A"></a>A</h2><p>给定一个大小为 $n$ 的树，保证 $n$ 为偶数且小于 $5000$。</p>
<p>您需要给树上的点两两配对，对于一组对子 $(u,v)$ ，在树上将 $u\to v$ 的路径染色，定义一个配对方案合法当且仅当所有边都有颜色。</p>
<p>求方案数对 $10^9+7$ 取模。</p>
<p>树形DP，用容斥合并贡献。</p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="http://xsy.gdgzez.com.cn/JudgeOnline/upload/attachment/image/20220712/20220712022941_24253.png" alt=""></p>
<p>code : </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">namespace</span> Pozhu&#123;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 5010</span></span><br><span class="line"><span class="type">const</span> <span class="type">int</span> p = <span class="number">1e9</span>+<span class="number">7</span>;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> n;</span><br><span class="line">ll ans;</span><br><span class="line"><span class="type">int</span> g[N];</span><br><span class="line">vector&lt;<span class="type">int</span>&gt;G[N];</span><br><span class="line"><span class="type">int</span> f[N][N],tmp[N],siz[N];</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> ,<span class="type">int</span> )</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios :: <span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="comment">// for(int j = 1;j&lt;=__cplusplus;j++)</span></span><br><span class="line">    <span class="comment">//     int *i = (int*) malloc(__cplusplus);</span></span><br><span class="line">    g[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>;i&lt;=n;i+=<span class="number">2</span>) g[i] = <span class="number">1ll</span> * g[i - <span class="number">2</span>] * (i<span class="number">-1</span>) % p;</span><br><span class="line">    <span class="type">int</span> u,v;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i&lt;n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        cin &gt;&gt; u &gt;&gt; v;</span><br><span class="line">        G[u].<span class="built_in">emplace_back</span>(v);</span><br><span class="line">        G[v].<span class="built_in">emplace_back</span>(u);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>,<span class="number">0</span>);</span><br><span class="line">    cout &lt;&lt; (p - f[<span class="number">1</span>][<span class="number">0</span>]) % p;</span><br><span class="line">    <span class="keyword">return</span> ;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> fa)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    f[u][<span class="number">1</span>] = <span class="number">1</span>;siz[u] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="keyword">auto</span> v : G[u])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(v == fa) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(v,u);</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i&lt;=siz[u] + siz[v];i++) tmp[i] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i&lt;=siz[u];i++)</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">0</span>;j&lt;=siz[v];j++)</span><br><span class="line">        (tmp[i+j] += <span class="number">1ll</span> * f[u][i] * f[v][j] % p) %= p;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i&lt;=siz[u] + siz[v];i++) f[u][i] = tmp[i];</span><br><span class="line">        siz[u] += siz[v];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>;i&lt;=siz[u];i+=<span class="number">2</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        (f[u][<span class="number">0</span>] += p - <span class="number">1ll</span> * f[u][i] * g[i] % p ) %= p;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Pozhu :: <span class="built_in">main</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="B-3"><a href="#B-3" class="headerlink" title="B"></a>B</h2><p>给你一个字符串 $S$ ，只包含小写字母，每次你可以交换两个相邻的字母，询问最少多少次可以将 $S$  变成回文串。</p>
<p>简单串串题。奇数个数小于2判无解，从前往后扫一遍，每次找到最后的相同字符，标号为倒数的对应位置，单个字符（最后一个和当前相同） 放中间。最后对得到的标号序列求逆序对就是答案，大概这也就是这道题叫 “Papple Sort” 的原因吧 —— 逆序对数即为冒泡排序的交换次数，其实对于最终序列每次交换相邻两项进行排序也就是进行冒泡排序。</p>
<p>代码 ： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">namespace</span> Pozhu</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 200010</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> lowbit(x) (x &amp; -x)</span></span><br><span class="line">    <span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line">    <span class="type">char</span> s[N];</span><br><span class="line">    <span class="type">int</span> db[N];</span><br><span class="line">    <span class="type">int</span> f[N];</span><br><span class="line">    ll ans;</span><br><span class="line">    <span class="type">int</span> len;</span><br><span class="line">    <span class="type">int</span> tott;</span><br><span class="line">    <span class="type">int</span> tot[<span class="number">27</span>];</span><br><span class="line">    <span class="type">bool</span> vis[N];</span><br><span class="line">    vector&lt;<span class="type">int</span>&gt; pos[<span class="number">27</span>];</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span>)</span></span>;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">        len = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; i++)</span><br><span class="line">            tot[s[i] - <span class="string">&#x27;a&#x27;</span>]++, pos[s[i] - <span class="string">&#x27;a&#x27;</span>].<span class="built_in">push_back</span>(i);</span><br><span class="line">        <span class="type">int</span> tmp = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">26</span>; i++)</span><br><span class="line">            <span class="keyword">if</span> (tot[i] &amp; <span class="number">1</span>)</span><br><span class="line">                tmp++;</span><br><span class="line">        <span class="keyword">if</span> (tmp &gt; <span class="number">1</span>)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> top = len &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (vis[i])</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            <span class="type">int</span> tmp = s[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">            <span class="type">int</span> p = *(pos[tmp].<span class="built_in">end</span>() - <span class="number">1</span>);</span><br><span class="line">            pos[tmp].<span class="built_in">erase</span>(pos[tmp].<span class="built_in">end</span>() - <span class="number">1</span>);</span><br><span class="line">            vis[i] = vis[p] = <span class="literal">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (p == i)</span><br><span class="line">            &#123;</span><br><span class="line">                db[i] = top + <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            db[i] = ++tott;</span><br><span class="line">            db[p] = len - tott + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= len; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="built_in">add</span>(db[i]);</span><br><span class="line">            ans += i - <span class="built_in">query</span>(db[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, ans);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (; x; x -= <span class="built_in">lowbit</span>(x))</span><br><span class="line">            ans += f[x];</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (!x)</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        <span class="keyword">for</span> (; x &lt;= len; x += <span class="built_in">lowbit</span>(x))</span><br><span class="line">            f[x]++;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Pozhu ::<span class="built_in">main</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="C-3"><a href="#C-3" class="headerlink" title="C"></a>C</h2><p>我们按以下方式定义一个字符串是否合法：<br>1、空串是合法的。</p>
<p>2、如果 $S$ 是合法的，那么 $aSa,bSb,cSc$ 是合法的。</p>
<p>3、如果 $S$ 和 $T$ 是合法的，那么 $ST$ 是合法的。</p>
<p>4、不能被以上方式定义为合法的字符串都是不合法的。</p>
<p>给定一个只包含 $a,b,c$ 的字符串 $S$ ，求有多少种方案交换两个不同字符后使得交换之后 $S$ 合法。</p>
<p>观察题面可知一个字符串合法当且仅当它可以被拆成若干个长度为偶数的回文串的首尾相接。</p>
<p>但是考虑原题中的交换操作，发现这个信息不好维护</p>
<p>结论是使用栈和hash来维护。</p>
<p>代码 ： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"> </span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">namespace</span> Pozhu</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 100010</span></span><br><span class="line">    <span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line">    <span class="keyword">typedef</span> <span class="type">unsigned</span> <span class="type">long</span> <span class="type">long</span> ull;</span><br><span class="line">    <span class="type">const</span> ull m = <span class="number">31</span>;</span><br><span class="line">    <span class="type">char</span> s[N];</span><br><span class="line">    <span class="type">int</span> a[N];</span><br><span class="line">    ull wx[N];</span><br><span class="line">    <span class="type">int</span> n;</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">hash_stack</span></span><br><span class="line">    &#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt; v;</span><br><span class="line">        vector&lt;ull&gt; has, invhas;</span><br><span class="line">        <span class="built_in">hash_stack</span>() : <span class="built_in">has</span>(&#123;<span class="number">0</span>&#125;), <span class="built_in">invhas</span>(&#123;<span class="number">0</span>&#125;) &#123;&#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">clear</span><span class="params">()</span> </span>&#123; v.<span class="built_in">clear</span>(), has.<span class="built_in">resize</span>(<span class="number">1</span>), invhas.<span class="built_in">resize</span>(<span class="number">1</span>); &#125;</span><br><span class="line">        <span class="function"><span class="type">int</span> <span class="title">getsize</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> v.<span class="built_in">size</span>(); &#125;</span><br><span class="line">        <span class="function"><span class="type">void</span> <span class="title">push</span><span class="params">(<span class="type">int</span> val)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (v.<span class="built_in">empty</span>() || v.<span class="built_in">back</span>() != val)</span><br><span class="line">            &#123;</span><br><span class="line">                ull ls = has.<span class="built_in">back</span>(), rs = invhas.<span class="built_in">back</span>();</span><br><span class="line">                has.<span class="built_in">emplace_back</span>(ls * m + val);</span><br><span class="line">                invhas.<span class="built_in">emplace_back</span>(rs + val * wx[<span class="built_in">getsize</span>()]);</span><br><span class="line">                v.<span class="built_in">emplace_back</span>(val);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                v.<span class="built_in">pop_back</span>(), has.<span class="built_in">pop_back</span>(), invhas.<span class="built_in">pop_back</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="function">ull <span class="title">suf</span><span class="params">(<span class="type">int</span> l)</span></span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="keyword">return</span> has.<span class="built_in">back</span>() - wx[l] * *(has.<span class="built_in">end</span>() - l - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; pre, suf, pre2, suf2;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">divide</span><span class="params">(<span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>)</span></span>;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">&quot;%s&quot;</span>, s + <span class="number">1</span>);</span><br><span class="line">        n = <span class="built_in">strlen</span>(s + <span class="number">1</span>);</span><br><span class="line">        wx[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">            wx[i] = wx[i - <span class="number">1</span>] * m, a[i] = s[i] - <span class="string">&#x27;a&#x27;</span>;</span><br><span class="line">        ll ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; <span class="number">3</span>; i++)</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">0</span>; j &lt; <span class="number">3</span>; j++)</span><br><span class="line">                <span class="keyword">if</span> (i != j)</span><br><span class="line">                    ans += <span class="built_in">divide</span>(<span class="number">1</span>, n, i, j);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld&quot;</span>, ans);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">divide</span><span class="params">(<span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> f, <span class="type">int</span> t)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        map&lt;ull, <span class="type">int</span>&gt; c;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        ll res = <span class="number">0</span>;</span><br><span class="line">        suf2.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = mid; i &gt;= l; i--)</span><br><span class="line">            suf2.<span class="built_in">push</span>(a[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = l; i &lt;= mid; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            suf2.<span class="built_in">push</span>(a[i]);</span><br><span class="line">            <span class="keyword">if</span> (a[i] == f)</span><br><span class="line">            &#123;</span><br><span class="line">                pre.<span class="built_in">push</span>(t);</span><br><span class="line">                <span class="type">int</span> l2 = <span class="number">0</span>, r2 = <span class="built_in">min</span>(pre.<span class="built_in">getsize</span>(), suf2.<span class="built_in">getsize</span>());</span><br><span class="line">                <span class="keyword">while</span> (l2 &lt; r2)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="type">int</span> mid2 = (l2 + r2 + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span> (pre.<span class="built_in">suf</span>(mid2) == suf2.<span class="built_in">suf</span>(mid2))</span><br><span class="line">                        l2 = mid2;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        r2 = mid2 - <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                c[pre.has[pre.<span class="built_in">getsize</span>() - l2] * wx[suf2.<span class="built_in">getsize</span>() - l2] + suf2.invhas[suf2.<span class="built_in">getsize</span>() - l2]]++;</span><br><span class="line">                pre.<span class="built_in">push</span>(t);</span><br><span class="line">            &#125;</span><br><span class="line">            pre.<span class="built_in">push</span>(a[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        res += <span class="built_in">divide</span>(mid + <span class="number">1</span>, r, f, t);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = mid; i &gt;= l; i--)</span><br><span class="line">            pre.<span class="built_in">push</span>(a[i]);</span><br><span class="line">        pre2.<span class="built_in">clear</span>();</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = mid + <span class="number">1</span>; i &lt;= r; i++)</span><br><span class="line">            pre2.<span class="built_in">push</span>(a[i]);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = r; i &gt; mid; i--)</span><br><span class="line">        &#123;</span><br><span class="line">            pre2.<span class="built_in">push</span>(a[i]);</span><br><span class="line">            <span class="keyword">if</span> (a[i] == t)</span><br><span class="line">            &#123;</span><br><span class="line">                suf.<span class="built_in">push</span>(f);</span><br><span class="line">                <span class="type">int</span> l2 = <span class="number">0</span>, r2 = <span class="built_in">min</span>(pre2.<span class="built_in">getsize</span>(), suf.<span class="built_in">getsize</span>());</span><br><span class="line">                <span class="keyword">while</span> (l2 &lt; r2)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="type">int</span> mid2 = (l2 + r2 + <span class="number">1</span>) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">                    <span class="keyword">if</span> (pre2.<span class="built_in">suf</span>(mid2) == suf.<span class="built_in">suf</span>(mid2))</span><br><span class="line">                        l2 = mid2;</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        r2 = mid2 - <span class="number">1</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                res += c[suf.has[suf.<span class="built_in">getsize</span>() - l2] * wx[pre2.<span class="built_in">getsize</span>() - l2] + pre2.invhas[pre2.<span class="built_in">getsize</span>() - l2]];</span><br><span class="line">                suf.<span class="built_in">push</span>(f);</span><br><span class="line">            &#125;</span><br><span class="line">            suf.<span class="built_in">push</span>(a[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        res += <span class="built_in">divide</span>(l, mid, f, t);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = mid + <span class="number">1</span>; i &lt;= r; i++)</span><br><span class="line">            suf.<span class="built_in">push</span>(a[i]);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Pozhu ::<span class="built_in">main</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h1 id="9-9"><a href="#9-9" class="headerlink" title="9.9"></a>9.9</h1><h2 id="A-4"><a href="#A-4" class="headerlink" title="A"></a>A</h2><p>给出 $n$ 和一个长度为 $n$ 的数列 $a_{1 \dots n}$ 。<br>有 $q$ 次询问，每次询问给出 $l_i,r_i$ ，表示询问 $a_{l_i \dots r_i}$ 中所有数的最小公倍数模 $10^9+7$ 的结果。</p>
<p>一些数 $b_1,\dots,b_m$ 的最小公倍数定义为一个最小的正整数 $M$ ，使得 $\forall 1 \le i \le m$，有 $b_i \mid M$ ，也就是 $M$ 为最小的被所有 $b$ 都整除的正整数。</p>
<p>强制在线。</p>
<p>区间查询最小公倍数，观察数据范围为 $1e5$ 显然暴力没有出路</p>
<p>考虑用数据结构维护，但是需要转化以下问题才好维护 ：  </p>
<p>回想最小公倍数的本质，我们发现最小公倍数是对两个（或多个）数唯一分解后对每个素数的指数取 $\max$ ，考虑维护这个 $\max$ ，考虑对 $a$ 分解质因数后最多有一个大于 $\sqrt{a}$ 的素因子，而小于等于 $\sqrt{2\times10^5}$ 的素数只有 $86$ 个。于是这一部分我们考虑维护 $86$ 个$RMQ$ 直接查询答案，再具体的话就是开 $86$ 棵线段树，因为ST表的空间消耗过大。</p>
<p>然后问题转化成求区间内不同的大于$\sqrt{a}$ 的素因子的乘积。</p>
<p>和区间颜色数类似，可以预处理出一个 $pre_i$  表示 $a_i$ 含有的大质数在序列上上一次出现的位置，然后询问就变成了区间中 $pre_i$ 小于等于询问左端点的所有 $a_i$ 中大质数的乘积。</p>
<p>可以利用可持久化线段树维护这一信息 ： 每个位置 $i$ 用一棵线段树维护 $1…i$ 内，$pre_i$ 在一段区间内的大质数乘积。这样时间复杂度为 $O(n \log n+q \log n)$。</p>
<p>我们将两部分的答案进行一个相乘就可以得到最终答案了。</p>
<p>总时间复杂度为 $O(nk+n\log n+qk\log n +q\log 2n)$等，取决于实现方式。</p>
<p>代码 ： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">namespace</span> Pozhu</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 100010</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> M 200000</span></span><br><span class="line"><span class="meta">#<span class="keyword">define</span> K 200010</span></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"> </span><br><span class="line">    <span class="type">int</span> n, m;</span><br><span class="line">    <span class="type">int</span> rt[N], sum[N * <span class="number">400</span>], tot;</span><br><span class="line">    <span class="type">int</span> inv[K], f[K], s[K], x;</span><br><span class="line">    <span class="type">int</span> ans, l, r;</span><br><span class="line">    <span class="type">int</span> ls[N * <span class="number">400</span>], rs[N * <span class="number">400</span>];</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>)</span></span>;</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>, <span class="type">int</span>)</span></span>;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ios ::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">        cin.<span class="built_in">tie</span>(<span class="number">0</span>), cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line"> </span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m;</span><br><span class="line">        inv[<span class="number">1</span>] = <span class="number">1</span>, sum[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">2</span>; i &lt;= M; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            inv[i] = <span class="number">1ll</span> * inv[mod % i] * (mod - mod / i) % mod;</span><br><span class="line">            <span class="keyword">if</span> (!f[i])</span><br><span class="line">                <span class="keyword">for</span> (<span class="type">int</span> k = i; k &lt;= M; k += i)</span><br><span class="line">                    f[k] = i;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            cin &gt;&gt; x;</span><br><span class="line">            rt[i] = rt[i - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">while</span> (f[x])</span><br><span class="line">            &#123;</span><br><span class="line">                <span class="type">int</span> k = f[x], t = <span class="number">1</span>;</span><br><span class="line">                <span class="keyword">while</span> (x % k == <span class="number">0</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    t = t * k;</span><br><span class="line">                    x = x / k;</span><br><span class="line">                    <span class="keyword">if</span> (s[t])</span><br><span class="line">                        rt[i] = <span class="built_in">merge</span>(rt[i], <span class="number">1</span>, n, s[t], inv[k]);</span><br><span class="line">                    s[t] = i;</span><br><span class="line">                &#125;</span><br><span class="line">                rt[i] = <span class="built_in">merge</span>(rt[i], <span class="number">1</span>, n, i, t);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= m; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            cin &gt;&gt; l &gt;&gt; r;</span><br><span class="line">            l = (l + ans) % n + <span class="number">1</span>;</span><br><span class="line">            r = (r + ans) % n + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span> (l &gt; r)</span><br><span class="line">                <span class="built_in">swap</span>(l, r);</span><br><span class="line">            ans = <span class="built_in">query</span>(rt[r], <span class="number">1</span>, n, l);</span><br><span class="line">            cout &lt;&lt; ans &lt;&lt; <span class="string">&#x27;\n&#x27;</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">merge</span><span class="params">(<span class="type">int</span> pre, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x, <span class="type">int</span> num)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt; x || r &lt; x)</span><br><span class="line">            <span class="keyword">return</span> pre;</span><br><span class="line">        <span class="type">int</span> rt = ++tot;</span><br><span class="line">        <span class="keyword">if</span> (l == r)</span><br><span class="line">        &#123;</span><br><span class="line">            sum[rt] = <span class="number">1ll</span> * sum[pre] * num % mod;</span><br><span class="line">            <span class="keyword">return</span> rt;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        ls[rt] = <span class="built_in">merge</span>(ls[pre], l, mid, x, num), rs[rt] = <span class="built_in">merge</span>(rs[pre], mid + <span class="number">1</span>, r, x, num);</span><br><span class="line">        sum[rt] = <span class="number">1ll</span> * sum[ls[rt]] * sum[rs[rt]] % mod;</span><br><span class="line">        <span class="keyword">return</span> rt;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> rt, <span class="type">int</span> l, <span class="type">int</span> r, <span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (l &gt;= x)</span><br><span class="line">            <span class="keyword">return</span> sum[rt];</span><br><span class="line">        <span class="keyword">if</span> (r &lt; x)</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        <span class="type">int</span> mid = (l + r) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1ll</span> * <span class="built_in">query</span>(ls[rt], l, mid, x) * <span class="built_in">query</span>(rs[rt], mid + <span class="number">1</span>, r, x) % mod;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Pozhu ::<span class="built_in">main</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="B-4"><a href="#B-4" class="headerlink" title="B"></a>B</h2><p>有一个序列，初始时为空。</p>
<p>你会不停地往序列末尾添加一个 $[1,m]$ 中的随机整数。在任意时刻，若序列末尾的两个整数相同（记为 $x$ ）且小于 $t$ ，那么它们会立即合并为 $x+1$。如果序列长度为 $n$ 且无法合并，那么结束操作。</p>
<p>你需要求出结束时序列中所有数的和的期望值。对 $10^9+7$ 取模。</p>
<p>期望难题。</p>
<p>考虑枚举第一格的数，那么我们需要知道 <code>f[i][j]</code> 表示长度限制为 <code>i</code> ，结束时第一格为 <code>j</code> 的概率，<code>g[i][j]</code> 表示此时答案的期望。<br>求 <code>f</code> 和 <code>g</code> 时需要知道 <code>x[i][j]</code> 表示长度限制为 <code>i</code>，第一格弄出 <code>j</code> 的概率，以及 <code>u[i][j]</code> 表示长度限制为 <code>i</code>，初始时第一格为 <code>j</code> 的期望答案。<br>具体转移方程可以参考标程。<br>写出转移方程后不难发现将 <code>g[i][j]</code> 改为长度限制为 <code>i</code>，初始时第一格为 <code>j</code>，结束时第一格还是 <code>j</code> 的概率*期望，就可以不用记 <code>f[i][j]</code>，同时转移方程会简化很多，<br>复杂度还会少个 $\log$(模数)。<br>时间复杂度 $O(nm)$</p>
<p>代码 ： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">namespace</span> Pozhu</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 2022</span></span><br><span class="line">    <span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> mod = <span class="number">1e9</span> + <span class="number">7</span>;</span><br><span class="line"> </span><br><span class="line">    ll n, m, t;</span><br><span class="line">    ll inv, lim;</span><br><span class="line">    ll f[N][N], g[N][N], p[N][N], q[N][N], ans[N];</span><br><span class="line"> </span><br><span class="line">    <span class="function">ll <span class="title">ksm</span><span class="params">(ll, ll)</span></span>;</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ios ::<span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">        cin.<span class="built_in">tie</span>(<span class="number">0</span>), cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">        cin &gt;&gt; n &gt;&gt; m &gt;&gt; t;</span><br><span class="line">        lim = <span class="built_in">min</span>(n + m - <span class="number">1</span>, t);</span><br><span class="line">        ll inv = <span class="built_in">ksm</span>(m, mod - <span class="number">2</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i++)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = <span class="number">1</span>; j &lt;= lim; j++)</span><br><span class="line">            &#123;</span><br><span class="line">                p[i][j] = ((j &lt;= m) * inv + p[i][j - <span class="number">1</span>] * p[i - <span class="number">1</span>][j - <span class="number">1</span>]) % mod;</span><br><span class="line">                q[i][j] = (<span class="number">1</span> - (j &lt; lim) * p[i - <span class="number">1</span>][j] + mod) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">for</span> (<span class="type">int</span> j = lim; j &gt;= <span class="number">1</span>; j--)</span><br><span class="line">            &#123;</span><br><span class="line">                g[i][j] = (q[i][j] * j + ans[i - <span class="number">1</span>] - (j &lt; lim) * p[i - <span class="number">1</span>][j] * f[i - <span class="number">1</span>][j] % mod + mod) % mod;</span><br><span class="line">                f[i][j] = (g[i][j] + (j &lt; lim) * (<span class="number">1</span> - q[i][j] + mod) * f[i][j + <span class="number">1</span>]) % mod;</span><br><span class="line">                ans[i] = (ans[i] + p[i][j] * g[i][j] % mod) % mod;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        cout &lt;&lt; ans[n];</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">    <span class="function">ll <span class="title">ksm</span><span class="params">(ll a, ll b)</span></span></span><br><span class="line"><span class="function">    </span>&#123;</span><br><span class="line">        ll ans = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (; b; b &gt;&gt;= <span class="number">1</span>, a = a * a % mod)</span><br><span class="line">            <span class="keyword">if</span> (b &amp; <span class="number">1</span>)</span><br><span class="line">                ans = ans * a % mod;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Pozhu ::<span class="built_in">main</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="C-4"><a href="#C-4" class="headerlink" title="C"></a>C</h2><p>给一颗 $N$ 个结点的以 $1$ 为根的树，每个条边上写了一个字母 $a…v$，一条 Dk 路径是经过的所有字母重新排序可以构成回文串的路径。求每个点的子树中最长的 Dk 路径的长度</p>
<p>这是DSU on Tree 算法的提出者专门为这个算法出的题，属于是这个算法的经典题。所以算法就是这个算法，发现字母数量不是很多就可以状压，合并时就是异或，整条路经的状态就是异或和。</p>
<p>具体如何合并贡献见代码 ： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">namespace</span> Pozhu&#123;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="meta">#<span class="keyword">define</span> N 500010</span></span><br><span class="line"> </span><br><span class="line"><span class="type">int</span> n,cnt;</span><br><span class="line"><span class="type">int</span> dfntot;</span><br><span class="line"><span class="type">int</span> t[<span class="number">1</span> &lt;&lt; <span class="number">22</span>];</span><br><span class="line"><span class="type">int</span> ans[N],head[N];</span><br><span class="line"><span class="type">int</span> to[N],nxt[N],w[N];</span><br><span class="line"><span class="type">int</span> siz[N],hson[N],dfn[N],rk[N],dep[N],val[N];</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> )</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> ,<span class="type">bool</span> )</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_ans</span><span class="params">(<span class="type">int</span> )</span></span>;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> ,<span class="type">int</span> ,<span class="type">int</span> )</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> ,<span class="type">int</span> )</span></span>;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    ios :: <span class="built_in">sync_with_stdio</span>(<span class="literal">false</span>);</span><br><span class="line">    cin.<span class="built_in">tie</span>(<span class="number">0</span>),cout.<span class="built_in">tie</span>(<span class="number">0</span>);</span><br><span class="line">    cin &gt;&gt; n;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> f;<span class="type">char</span> ch;</span><br><span class="line">        cin &gt;&gt; f &gt;&gt; ch;</span><br><span class="line">        <span class="built_in">add</span>(f,i,ch - <span class="string">&#x27;a&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    dep[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="built_in">dfs1</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="built_in">dfs</span>(<span class="number">1</span>,<span class="literal">true</span>);</span><br><span class="line">    <span class="built_in">get_ans</span>(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">1</span>;i&lt;=n;i++)</span><br><span class="line">    cout &lt;&lt; ans[i] &lt;&lt; <span class="string">&#x27; &#x27;</span>;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">query</span><span class="params">(<span class="type">int</span> x,<span class="type">int</span> lca)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">0</span>;</span><br><span class="line">    <span class="type">int</span> tmp = val[x];</span><br><span class="line">    <span class="keyword">if</span>(t[tmp])</span><br><span class="line">        ans = <span class="built_in">max</span>(ans,t[tmp] + dep[x] - <span class="number">2</span> * dep[lca]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> k = <span class="number">0</span>;k &lt; <span class="number">22</span>;k++)</span><br><span class="line">    &#123;</span><br><span class="line">        tmp = val[x] ^ (<span class="number">1</span> &lt;&lt; k);</span><br><span class="line">        <span class="keyword">if</span>(t[tmp])</span><br><span class="line">            ans = <span class="built_in">max</span>(ans,t[tmp] + dep[x] - <span class="number">2</span> * dep[lca]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs</span><span class="params">(<span class="type">int</span> x,<span class="type">bool</span> save)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = head[x];i;i = nxt[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v = to[i];</span><br><span class="line">        <span class="keyword">if</span>(v == hson[x]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="built_in">dfs</span>(v,<span class="literal">false</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(hson[x])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">dfs</span>(hson[x],<span class="literal">true</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    t[val[x]] = <span class="built_in">max</span>(t[val[x]],dep[x]);</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = head[x];i;i = nxt[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v = to[i];</span><br><span class="line">        <span class="keyword">if</span>(v == hson[x]) <span class="keyword">continue</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = dfn[v];j &lt;= dfn[v] + siz[v] - <span class="number">1</span>;j++)</span><br><span class="line">        ans[x] = <span class="built_in">max</span>(ans[x],<span class="built_in">query</span>(rk[j],x));</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = dfn[v];j &lt;= dfn[v] + siz[v] - <span class="number">1</span>;j++)</span><br><span class="line">        t[val[rk[j]]] = <span class="built_in">max</span>(t[val[rk[j]]],dep[rk[j]]);</span><br><span class="line">    &#125;</span><br><span class="line">    ans[x] = <span class="built_in">max</span>(ans[x],<span class="built_in">query</span>(x,x));</span><br><span class="line">    <span class="keyword">if</span>(!save)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = dfn[x];j &lt;= dfn[x] + siz[x] - <span class="number">1</span>;j++)</span><br><span class="line">        t[val[rk[j]]] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">get_ans</span><span class="params">(<span class="type">int</span> x)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = head[x];i;i = nxt[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">get_ans</span>(to[i]);</span><br><span class="line">        ans[x] = <span class="built_in">max</span>(ans[x],ans[to[i]]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">dfs1</span><span class="params">(<span class="type">int</span> u)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    siz[u] = <span class="number">1</span>;</span><br><span class="line">    dfn[u] = ++dfntot;</span><br><span class="line">    rk[dfntot] = u;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = head[u];i;i = nxt[i])</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> v = to[i];</span><br><span class="line">        dep[v] = dep[u] + <span class="number">1</span>;</span><br><span class="line">        val[v] = val[u] ^ (<span class="number">1</span> &lt;&lt; w[i]);</span><br><span class="line">        <span class="built_in">dfs1</span>(v);</span><br><span class="line">        siz[u] += siz[v];</span><br><span class="line">        <span class="keyword">if</span>(siz[v] &gt; siz[hson[u]]) hson[u] = v;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">add</span><span class="params">(<span class="type">int</span> u,<span class="type">int</span> v,<span class="type">int</span> _w)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    to[++cnt] = v;</span><br><span class="line">    nxt[cnt] = head[u];</span><br><span class="line">    head[u] = cnt;</span><br><span class="line">    w[cnt] = _w;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Pozhu :: <span class="built_in">main</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>by Pozhu<br>2022.9.10  </p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://pukui.github.io">Pozhu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://pukui.github.io/2022/09/10/9-5-9-9%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/">http://pukui.github.io/2022/09/10/9-5-9-9%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://pukui.github.io" target="_blank">Pozhu's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%A7%A3%E9%A2%98%E6%8A%A5%E5%91%8A/">解题报告</a></div><div class="post_share"><div class="social-share" data-image="https://s1.328888.xyz/2022/08/10/4eAxp.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/09/13/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E6%80%BB%E7%BB%93/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/08/10/4eSMw.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">莫比乌斯反演总结</div></div></a></div><div class="next-post pull-right"><a href="/2022/09/04/8-31-9-3%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/08/01/FeFJ5.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">8.31-9.3做题总结</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/09/04/8-31-9-3%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="8.31-9.3做题总结"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/08/01/FeFJ5.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-04</div><div class="title">8.31-9.3做题总结</div></div></a></div><div><a href="/2022/09/24/9-14-9-23%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.14-9.23做题总结"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/09/14/cbWjd.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-24</div><div class="title">9.14-9.23做题总结</div></div></a></div><div><a href="/2022/09/14/9-11-9-13%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.11-9.13做题总结"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/08/10/4eQhJ.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-14</div><div class="title">9.11-9.13做题总结</div></div></a></div><div><a href="/2022/09/27/9-25-9-26%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.25-9.26做题总结"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/09/14/cw0uK.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-27</div><div class="title">9.25-9.26做题总结</div></div></a></div><div><a href="/2022/07/24/%E7%8C%AA%E5%9B%BD%E6%9D%80/" title="猪国杀"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.luogu.com.cn/upload/image_hosting/6g5xvjln.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-24</div><div class="title">猪国杀</div></div></a></div><div><a href="/2022/07/29/%E7%90%AA%E9%9C%B2%E8%AF%BA%E7%9A%84%E5%86%B0%E9%9B%AA%E5%B0%8F%E5%B1%8B/" title="琪露诺的冰雪小屋"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.luogu.com.cn/upload/image_hosting/izw7zeb8.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-29</div><div class="title">琪露诺的冰雪小屋</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Giscus</span><span class="switch-btn"></span><span class="second-comment">Valine</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/07/27/Ds1AN.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Pozhu</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pukui"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/pukui" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">图片404可以用F5修复</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#9-5"><span class="toc-number">1.</span> <span class="toc-text">9.5</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#A"><span class="toc-number">1.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#B"><span class="toc-number">1.2.</span> <span class="toc-text">B</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C"><span class="toc-number">1.3.</span> <span class="toc-text">C</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-6"><span class="toc-number">2.</span> <span class="toc-text">9.6</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#A-1"><span class="toc-number">2.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#B-1"><span class="toc-number">2.2.</span> <span class="toc-text">B</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-1"><span class="toc-number">2.3.</span> <span class="toc-text">C</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-7"><span class="toc-number">3.</span> <span class="toc-text">9.7</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#A-2"><span class="toc-number">3.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#B-2"><span class="toc-number">3.2.</span> <span class="toc-text">B</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-2"><span class="toc-number">3.3.</span> <span class="toc-text">C</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-8"><span class="toc-number">4.</span> <span class="toc-text">9.8</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#A-3"><span class="toc-number">4.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#B-3"><span class="toc-number">4.2.</span> <span class="toc-text">B</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-3"><span class="toc-number">4.3.</span> <span class="toc-text">C</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#9-9"><span class="toc-number">5.</span> <span class="toc-text">9.9</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#A-4"><span class="toc-number">5.1.</span> <span class="toc-text">A</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#B-4"><span class="toc-number">5.2.</span> <span class="toc-text">B</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#C-4"><span class="toc-number">5.3.</span> <span class="toc-text">C</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/09/27/9-25-9-26%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.25-9.26做题总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/09/14/cw0uK.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="9.25-9.26做题总结"/></a><div class="content"><a class="title" href="/2022/09/27/9-25-9-26%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.25-9.26做题总结">9.25-9.26做题总结</a><time datetime="2022-09-26T23:53:05.000Z" title="发表于 2022-09-27 07:53:05">2022-09-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/24/9-14-9-23%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.14-9.23做题总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/09/14/cbWjd.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="9.14-9.23做题总结"/></a><div class="content"><a class="title" href="/2022/09/24/9-14-9-23%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.14-9.23做题总结">9.14-9.23做题总结</a><time datetime="2022-09-23T23:46:52.000Z" title="发表于 2022-09-24 07:46:52">2022-09-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/21/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E8%87%AA%E5%8A%A8%E6%9C%BA/" title="有限状态自动机"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/09/14/cbpNo.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="有限状态自动机"/></a><div class="content"><a class="title" href="/2022/09/21/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E8%87%AA%E5%8A%A8%E6%9C%BA/" title="有限状态自动机">有限状态自动机</a><time datetime="2022-09-21T01:55:14.000Z" title="发表于 2022-09-21 09:55:14">2022-09-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/15/%E6%95%B0%E5%AD%A6%E6%9D%82%E9%A1%B9/" title="数学杂项"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/09/14/cwytP.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数学杂项"/></a><div class="content"><a class="title" href="/2022/09/15/%E6%95%B0%E5%AD%A6%E6%9D%82%E9%A1%B9/" title="数学杂项">数学杂项</a><time datetime="2022-09-15T14:11:24.000Z" title="发表于 2022-09-15 22:11:24">2022-09-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/14/9-11-9-13%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.11-9.13做题总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/08/10/4eQhJ.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="9.11-9.13做题总结"/></a><div class="content"><a class="title" href="/2022/09/14/9-11-9-13%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.11-9.13做题总结">9.11-9.13做题总结</a><time datetime="2022-09-14T06:42:11.000Z" title="发表于 2022-09-14 14:42:11">2022-09-14</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By Pozhu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadGiscus () {
  let nowTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light'

  const config = Object.assign({
    src: 'https://giscus.app/client.js',
    'data-repo': 'pukui/comment',
    'data-repo-id': 'R_kgDOIBC3iw',
    'data-category-id': 'DIC_kwDOIBC3i84CRme7',
    'data-mapping': 'pathname',
    'data-theme': nowTheme,
    'data-reactions-enabled': '1',
    crossorigin: 'anonymous',
    async: true
  },null)

  let ele = document.createElement('script')
  for (let key in config) {
    ele.setAttribute(key, config[key])
  }
  document.getElementById('giscus-wrap').insertAdjacentElement('afterbegin',ele)
}

function changeGiscusTheme () {
  const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light'

  function sendMessage(message) {
    const iframe = document.querySelector('iframe.giscus-frame');
    if (!iframe) return;
    iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
  }

  sendMessage({
    setConfig: {
      theme: theme
    }
  });
}

if ('Giscus' === 'Giscus' || !false) {
  if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
  else loadGiscus()
} else {
  function loadOtherComment () {
    loadGiscus()
  }
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'FT8G3pBXmRbzp9WigXTv6Myu-MdYXbMMI',
      appKey: 'pzv72ZU5yq0jHCmG9wbBuL1l',
      avatar: 'monsterid',
      serverURLs: 'https://FT8G3pBX.api.lncldglobal.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Giscus' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script src="//code.tidio.co/d8owaeytaz6ydoshtoescuj9qseqxpnf.js" async="async"></script><script>function onTidioChatApiReady() {
  window.tidioChatApi.hide();
  window.tidioChatApi.on("close", function() {
    window.tidioChatApi.hide();
  });
}
if (window.tidioChatApi) {
  window.tidioChatApi.on("ready", onTidioChatApiReady);
} else {
  document.addEventListener("tidioChat-ready", onTidioChatApiReady);
}

var chatBtnFn = () => {
  document.getElementById("chat_btn").addEventListener("click", function(){
    window.tidioChatApi.show();
    window.tidioChatApi.open();
  });
}
chatBtnFn()
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>