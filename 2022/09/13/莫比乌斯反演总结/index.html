<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>莫比乌斯反演总结 | Pozhu's blog</title><meta name="keywords" content="数学,数论,莫比乌斯反演"><meta name="author" content="Pozhu"><meta name="copyright" content="Pozhu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="前言被各路数学题吊打之后决定苦练推式子能力。 这篇文章打算先整一点莫反的基础知识然后由易到难开始上题和写题解。 大概就是这样。 这里推荐 An_Account — 莫比乌斯反演-让我们从基础开始 ，其中的例题和本文例题有重复，本文的优势在于例题更多，难度更大以及给出了原题链接。 基本知识莫比乌斯反演 ( $M\ddot{o}bius\;Inversion$ ) 。   OI中数学题的常考知识点。">
<meta property="og:type" content="article">
<meta property="og:title" content="莫比乌斯反演总结">
<meta property="og:url" content="http://pukui.github.io/2022/09/13/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E6%80%BB%E7%BB%93/index.html">
<meta property="og:site_name" content="Pozhu&#39;s blog">
<meta property="og:description" content="前言被各路数学题吊打之后决定苦练推式子能力。 这篇文章打算先整一点莫反的基础知识然后由易到难开始上题和写题解。 大概就是这样。 这里推荐 An_Account — 莫比乌斯反演-让我们从基础开始 ，其中的例题和本文例题有重复，本文的优势在于例题更多，难度更大以及给出了原题链接。 基本知识莫比乌斯反演 ( $M\ddot{o}bius\;Inversion$ ) 。   OI中数学题的常考知识点。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s2.loli.net/2022/12/06/i2ZEzRqn8OxmpjX.jpg">
<meta property="article:published_time" content="2022-09-13T08:24:48.000Z">
<meta property="article:modified_time" content="2022-11-14T12:28:36.000Z">
<meta property="article:author" content="Pozhu">
<meta property="article:tag" content="数学">
<meta property="article:tag" content="数论">
<meta property="article:tag" content="莫比乌斯反演">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s2.loli.net/2022/12/06/i2ZEzRqn8OxmpjX.jpg"><link rel="shortcut icon" href="https://s2.loli.net/2022/12/06/4pTdWZbXUxASsov.png"><link rel="canonical" href="http://pukui.github.io/2022/09/13/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E6%80%BB%E7%BB%93/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '莫比乌斯反演总结',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-11-14 20:28:36'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/06/1TaJK5kxjyFdfDA.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">46</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s2.loli.net/2022/12/06/i2ZEzRqn8OxmpjX.jpg')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Pozhu's blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">莫比乌斯反演总结</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2022-09-13T08:24:48.000Z" title="发表于 2022-09-13 16:24:48">2022-09-13</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%95%B0%E5%AD%A6/">数学</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.6k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>28分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="莫比乌斯反演总结"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>被各路数学题吊打之后决定苦练推式子能力。</p>
<p>这篇文章打算先整一点莫反的基础知识然后由易到难开始上题和写题解。</p>
<p>大概就是这样。</p>
<p>这里推荐 <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/blog/An-Amazing-Blog/mu-bi-wu-si-fan-yan-ji-ge-ji-miao-di-dong-xi">An_Account — 莫比乌斯反演-让我们从基础开始</a> ，其中的例题和本文例题有重复，本文的优势在于例题更多，难度更大以及给出了原题链接。</p>
<h1 id="基本知识"><a href="#基本知识" class="headerlink" title="基本知识"></a>基本知识</h1><p>莫比乌斯反演 ( $M\ddot{o}bius\;Inversion$ ) 。  </p>
<p>OI中数学题的常考知识点。</p>
<p>墙裂推荐 ： <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/blog/luo1gu1zui1bang1/mei-hao-di-xi-ri">WeLikeStudying 的博客
</a></p>
<h2 id="莫比乌斯函数"><a href="#莫比乌斯函数" class="headerlink" title="莫比乌斯函数"></a>莫比乌斯函数</h2><p>显然写过总结 ： <a target="_blank" rel="noopener" href="https://www.pozhu.cf/2022/07/24/%E6%95%B0%E8%AE%BA%E5%87%BD%E6%95%B0%E6%80%BB%E7%BB%93/">数论函数总结</a></p>
<h2 id="狄利克雷卷积"><a href="#狄利克雷卷积" class="headerlink" title="狄利克雷卷积"></a>狄利克雷卷积</h2><p>狄利克雷卷积 ( $Dirichlet\;convolution$ )</p>
<p>推荐文章（参考文章）: <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/137619492">算法学习笔记(35): 狄利克雷卷积</a>，文章中给出了一些常用卷积的证明</p>
<p>再放一篇找到的文章留着看 ： <a target="_blank" rel="noopener" href="https://www.cnblogs.com/tttkf/p/15952812.html">浅析狄利克雷卷积</a></p>
<p>以及自己之前写的一部分理论知识（已经直接copy过来了<a target="_blank" rel="noopener" href="https://www.pozhu.cf/2022/07/24/%E6%95%B0%E8%AE%BA%E7%AE%97%E6%B3%95%E3%80%81%E5%AE%9A%E7%90%86%E5%92%8C%E5%B8%B8%E7%94%A8%E5%8F%98%E6%8D%A2/">数论算法、定理和常用变换</a></p>
<h3 id="定义-："><a href="#定义-：" class="headerlink" title="定义 ："></a>定义 ：</h3><p>对于两个数论函数 $f(x),g(x)$ ，定义他们的卷积为</p>
<script type="math/tex; mode=display">
(f*g)(n) = \sum_{d \mid n} f(d) \cdot g(\frac{n}{d})</script><h3 id="性质："><a href="#性质：" class="headerlink" title="性质："></a>性质：</h3><ol>
<li>交换律: $ f \ast g = g \ast f $  </li>
<li>结合律: $ ( f \ast g ) \ast h = f \ast ( g \ast h )$   </li>
<li>分配律: $ f \ast ( g + h ) = f \ast g + f \ast h $  </li>
<li>单位元: $ \varepsilon $ 表示 $[x=1]$ ，满足对任意函数  有 $\varepsilon * f = f$  </li>
<li>对积性函数: 若 $f$ 为积性， $g$ 为积性，则 $f*g$ 也为积性  </li>
<li>对积性函数: 若 $f$ 为积性， $f*g$ 也为积性，则 $g$ 为积性  </li>
</ol>
<h3 id="常用卷积"><a href="#常用卷积" class="headerlink" title="常用卷积"></a>常用卷积</h3><p><del>（先放结论，以后慢慢补证明）</del></p>
<p>防止文章头重脚轻，证明放最后。</p>
<script type="math/tex; mode=display">
f*1 = \sum_{d \mid n} f(d)</script><script type="math/tex; mode=display">
id_k*1 = \sigma_k</script><script type="math/tex; mode=display">
\varphi * 1 = id</script><script type="math/tex; mode=display">
\mu * 1 = \varepsilon</script><script type="math/tex; mode=display">
id * \mu = \varphi</script><!-- $$
\mu * d = 1
$$ -->
<script type="math/tex; mode=display">
1 * 1 = \tau</script><p>若 $F = 1*f$ 则有 ： </p>
<script type="math/tex; mode=display">
f = \mu * F</script><h1 id="基本套路"><a href="#基本套路" class="headerlink" title="基本套路"></a>基本套路</h1><h2 id="一、莫比乌斯反演"><a href="#一、莫比乌斯反演" class="headerlink" title="一、莫比乌斯反演"></a>一、莫比乌斯反演</h2><p>例如求</p>
<script type="math/tex; mode=display">
\sum_{i = 1}^n\sum_{j = 1}^m[\gcd(i,j) = 1]</script><p>（<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3455">P3455 [POI2007]ZAP-Queries</a>几乎就是原题）</p>
<p>过程就是 ： </p>
<script type="math/tex; mode=display">
\begin{split}
&\;\;\;\;\sum_{i = 1}^n\sum_{j = 1}^m[\gcd(i,j) = 1]\\
&= \sum_{i = 1}^n\sum_{j = 1}^m\varepsilon(\gcd(i,j))\\
&= \sum_{i = 1}^n\sum_{j = 1}^m\sum_{d \mid \gcd(i,j)} \mu(d) \\
&=\sum_{d = 1}^{min(n,m)}\mu(d)\sum_{i = 1}^{\lfloor \frac{n}{d} \rfloor}\sum_{j = 1}^{\lfloor \frac{m}{d} \rfloor} 1\\
&= \sum_{d=1}^{\min(n,m)}\mu(d)\lfloor \frac{n}{d} \rfloor \lfloor \frac{m}{d} \rfloor
\end{split}</script><p>然后就可以预处理 $\mu$ 整除分块来做了</p>
<h2 id="二、欧拉反演"><a href="#二、欧拉反演" class="headerlink" title="二、欧拉反演"></a>二、欧拉反演</h2><p>再比如求 ： </p>
<p>（原题也有，就是 <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2398">P2398 GCD SUM</a>）</p>
<script type="math/tex; mode=display">
\sum_{i = 1}^n \sum_{j = 1}^n \gcd(i,j)</script><p>过程就是 ： </p>
<script type="math/tex; mode=display">
\begin{split}
&\sum_{i = 1}^n \sum_{j = 1}^n \gcd(i,j)\\
=&\sum_{i = 1}^n\sum_{j = 1}^nid(\gcd(i,j))\\
=&\sum_{i = 1}^n\sum_{j = 1}^n\sum_{d \mid \gcd(i,j)} \varphi(d)\\
=& \sum_{d = 1}^n\varphi(d)\sum_{i = 1}^{\lfloor \frac{n}{d} \rfloor}\sum_{j = 1}^{\lfloor \frac{n}{d} \rfloor} 1\\
=& \sum_{d = 1}^n\varphi(d)\lfloor \frac{n}{d}\rfloor^2
\end{split}</script><p>然后预处理出 $\varphi$ 的前缀和进行一个整除分块即可。</p>
<p>实际上以上两个例题恰好就是莫比乌斯反演的两个基本套路（莫比乌斯反演和欧拉反演） ： </p>
<ul>
<li><p>莫比乌斯反演 ： 遇到 <strong>互质</strong> 就凑成莫比乌斯函数</p>
</li>
<li><p>欧拉反演 ： 遇到 $\gcd$ 就凑成欧拉函数</p>
</li>
</ul>
<p>利用的式子可以在上边的 “常用卷积” 当中轻松找到，这里不再赘述</p>
<h1 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h1><p>（为避免拖沓冗长，正常情况下本文题目只给出式子结果，不再放代码）</p>
<h2 id="简单的最大公约数"><a href="#简单的最大公约数" class="headerlink" title="简单的最大公约数"></a>简单的最大公约数</h2><p><a target="_blank" rel="noopener" href="https://loj.ac/p/6491">#6491. 「XXOI 2018」简单的最大公约数</a><br><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/AT5310">AT5310 [ABC162E] Sum of gcd of Tuples (Hard)</a>  </p>
<p>求 : </p>
<script type="math/tex; mode=display">
\sum_{i_1 = 1}^m\sum_{i-2 = 1}^m \cdots \sum_{i_n = 1}^m \gcd(i_1,i_2,\cdots,i_n)</script><p>其中 $1 \le n,m \le 10^{11}$,答案对 $2^{64}$ 取模。</p>
<p>属于是对上边套路的基本应用，遇到 $\gcd$ 就凑成欧拉函数所以我们显然有 ： </p>
<script type="math/tex; mode=display">
\begin{split}
&\sum_{i_1 = 1}^m\sum_{i_2 = 1}^m \cdots \sum_{i_n = 1}^m \gcd(i_1,i_2,\cdots,i_n)\\
=& \sum_{i_1 = 1}^m\sum_{i_2 = 1}^m \cdots \sum_{i_n = 1}^m \sum_{d \mid \gcd(i_1,i_2,\cdots,i_n)} \varphi(d)\\
=& \sum_{d = 1}^m \varphi(d)\sum_{i_1 = 1}^{\lfloor \frac{m}{d} \rfloor}\sum_{i_2 = 1}^{\lfloor \frac{m}{d} \rfloor} \cdots \sum_{i_n = 1}^{\lfloor \frac{m}{d} \rfloor} 1\\
=& \sum_{d = 1}^m \varphi(d)\lfloor \frac{m}{d} \rfloor ^ n
\end{split}</script><p>于是发现这个式子可以用整除分块，其中乘 $\varphi(d)$ 的部分看数据范围显然是杜教筛可求，然后就做完了。</p>
<p>对于AtCoder上的那道重题由于数据范围只有 $1e5$ 所以甚至不用写杜教筛（不过写了的话也会快很多）。</p>
<p>式子不难推，最大的难度可能在杜教筛上（</p>
<h2 id="Problem-b"><a href="#Problem-b" class="headerlink" title="Problem b"></a>Problem b</h2><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2522">P2522 [HAOI2011]Problem b</a><br><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3455">P3455 [POI2007]ZAP-Queries</a><br><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4450">P4450 双亲数</a>  </p>
<p>求 ： </p>
<script type="math/tex; mode=display">
\sum_{x = a}^b \sum_{y = c}^d [\gcd(x,y) = k]</script><p>$n$ 组询问，其中 $1 \le n,k,a,b,c,d \le 5 \times 10^4$ 。</p>
<p>观察问题显然可以直接想到容斥。</p>
<p>设 ： </p>
<script type="math/tex; mode=display">
f(n,m) = \sum_{i = 1}^n \sum_{j = 1}^m [\gcd(i,j) = k]</script><p>于是原问题转化为 ： </p>
<script type="math/tex; mode=display">
f(b,d) - f(a-1,d) - f(b,c-1) + f(a-1,c-1)</script><p>注意这里容斥时 $a,c$ 要减去 $1$</p>
<p>那么可以考虑化简 $f$ ： </p>
<p>以下不妨假设 $n \le m$</p>
<script type="math/tex; mode=display">
\begin{split}
f(n,m) &= \sum_{i = 1}^n \sum_{j = 1}^m [\gcd(i,j) = k]\\
&= \sum_{i = 1}^{\lfloor \frac{n}{k} \rfloor} \sum_{j = 1}^{\lfloor \frac{m}{k} \rfloor} [ \gcd(i,j) = 1 ]\\
&= \sum_{i = 1}^{\lfloor \frac{n}{k} \rfloor} \sum_{j = 1}^{\lfloor \frac{m}{k} \rfloor} \varepsilon(\gcd(i,j))\\
&= \sum_{i = 1}^{\lfloor \frac{n}{k} \rfloor} \sum_{j = 1}^{\lfloor \frac{m}{k} \rfloor} \sum_{g \mid \gcd(i,j)} \mu(g) \\
&= \sum_{g=1}^{\frac{n}{k}} \mu(g) \sum_{i=1}^{\lfloor \frac{n}{g\cdot k} \rfloor}\sum_{j=1}^{\lfloor \frac{m}{g\cdot k} \rfloor}1\\
&= \sum_{g = 1}^{\frac{n}{k}}\mu(g) * \lfloor \frac{n}{gk} \rfloor \lfloor \frac{m}{gk} \rfloor
\end{split}</script><p>然后就可以使用简单的数论分块求解了（</p>
<p>时间复杂度是 $\Theta(N + T\sqrt{n})$</p>
<h2 id="YY的GCD"><a href="#YY的GCD" class="headerlink" title="YY的GCD"></a>YY的GCD</h2><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2257">P2257 YY的GCD</a><br><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/SP4491">PGCD - Primes in GCD Table</a><br><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2568">P2568 GCD</a>  </p>
<p>本来没打算写，但是发现难度升的有点快就加上这题缓和下。</p>
<p>求 ： </p>
<script type="math/tex; mode=display">
\sum_{i=1}^n \sum_{j=1}^m [\gcd(i,j) \in prime]</script><p>首先发现直接求不好求，考虑枚举质数统计贡献。<br>于是得到（下文使用 $P$ 表示素数集合） ： </p>
<script type="math/tex; mode=display">
\sum_{k \in P} \sum_{i = 1}^n \sum_{j = 1}^m [\gcd(i,j) = k]</script><p>后边的部分一看就大有可为 ： </p>
<script type="math/tex; mode=display">
\begin{split}
&\sum_{k \in P} \sum_{i = 1}^n \sum_{j = 1}^m [\gcd(i,j) = k]\\
=&\sum_{k \in P}\sum_{i = 1}^{\lfloor \frac{n}{k} \rfloor} \sum_{j = 1}^{\lfloor \frac{m}{k} \rfloor} [\gcd(i,j) = 1] \\ 
=&\sum_{k \in P}\sum_{i = 1}^{\lfloor \frac{n}{k} \rfloor} \sum_{j = 1}^{\lfloor \frac{m}{k} \rfloor} \sum_{d \mid \gcd(i,j)} \mu(d) \\ 
=&\sum_{k \in P} \sum_{d = 1}^{\lfloor \frac{n}{k} \rfloor} \mu(d) \lfloor \frac{n}{kd} \rfloor\lfloor \frac{m}{kd} \rfloor\\ 
\end{split}</script><p>到这里的复杂度容易发现大概是 $O(T\frac{n\sqrt{n}}{\ln n})$ 级别，即使进行简单的优化也不能通过本题。</p>
<p>于是考虑经典换枚举项 ： </p>
<p>设 $T = kd$，我们枚举 $T$，得到 ： </p>
<script type="math/tex; mode=display">
\sum_{T = 1}^n \lfloor \frac{n}{T} \rfloor \lfloor \frac{m}{T} \rfloor \sum_{k \mid T,k \in P} \mu(\frac{T}{k})</script><p>发现后半部分取值与 $n,m$ 无关。</p>
<p>于是考虑预处理后半部分的前缀和，前半部分每次询问进行整除分块。</p>
<p>后半部分预处理可以直接枚举质数的倍数，仿照埃氏筛的复杂度证明，是 $O(n \log \log n)$ 的，当然还有线性筛和预处理前缀和的 $O(n)$。</p>
<p>对于每次询问只需要进行一次整除分块，这一部分的复杂度是 $O(T \sqrt{n})$。</p>
<p>于是总的复杂度大概是 $O(n \log \log n + T \sqrt{n})$ 或 $\Theta(n + n \log \log n + T \sqrt{n})$。</p>
<p>可以通过本题。</p>
<h2 id="Crash的数字表格"><a href="#Crash的数字表格" class="headerlink" title="Crash的数字表格"></a>Crash的数字表格</h2><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1829">P1829 [国家集训队]Crash的数字表格 / JZPTAB</a></p>
<p>求 ：  </p>
<script type="math/tex; mode=display">
\sum_{i = 1}^n \sum_{j = 1}^m \text{lcm}(i,j)</script><p>思路比较通畅，所以直接写下去 :  </p>
<p>（不妨设 $n \le m$ ）</p>
<script type="math/tex; mode=display">
\begin{split}
\sum_{i = 1}^n \sum_{j = 1}^m \text{lcm}(i,j) &= \sum_{i = 1}^n \sum_{j = 1}^m \frac{i \cdot j}{\gcd(i,j)} \\
&= \sum_{g = 1}^n \sum_{i = 1}^{ \left \lfloor \frac{n}{g} \right \rfloor }\sum_{j = 1}^{ \left \lfloor \frac{m}{g} \right \rfloor } i \cdot j \cdot g [\gcd(i,j) = 1] \\
&= \sum_{g = 1}^n g \sum_{i = 1}^{ \left \lfloor \frac{n}{g} \right \rfloor } i \sum_{j = 1}^{ \left \lfloor \frac{m}{g} \right \rfloor } j \sum_{d \mid \gcd(i,j)} \mu(d) \\  
&= \sum_{g = 1}^n g \sum_{d = 1}^{ \left \lfloor \frac{n}{g} \right \rfloor } \mu(d) d^2 \sum_{i = 1}^{ \left \lfloor \frac{n}{gd} \right \rfloor } i \sum_{j = 1}^{ \left \lfloor \frac{m}{gd} \right \rfloor } j
\end{split}</script><p>最后两个和式可以用等差数列求和公式 $\Theta(1)$ 求解，前边线性筛 $\mu$ 之后数论分块，</p>
<p>笔者写完了下面的三道例题之后回来写的这题，所以觉得有点水。 </p>
<p>但是考虑到上边的例题都是类板子所以给解释下。</p>
<p>感觉这题作为莫反初入门之后的练手题还是不错的，难度并不很大也能体现出一些最基本的想法。</p>
<p>题解里设了很多额外的函数，但我觉得这是不必要甚至多余的。明明像这样本就可以一步到位，但是额外增设函数会使读者心生畏惧，也使自己推式子的条理性有所下降，影响了思维的连贯性。</p>
<p>首先是第一步到第二步枚举，然后把 $\gcd$ 作为枚举项，所以枚举的 $i,j$ 变成 $\gcd$ 的多少倍，有了枚举上界的变化，同时保证是 $\gcd$ 所以要求 $i \bot j$ 。</p>
<p>第二步到第三步同样枚举  $\gcd(i,j)$ ,但要注意由于 $i,j$ 的性质发生变化这里的 $\gcd(i,j)$ 并不在所有条件下都和前文 $g$ 相等，在上一段的基础上这应该是容易理解的。  </p>
<p>最后一步同理将枚举项提前，就可以从枚举因数变成枚举倍数，从而去掉求和下标中整除形式的条件。</p>
<h2 id="约数个数和"><a href="#约数个数和" class="headerlink" title="约数个数和"></a>约数个数和</h2><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3327">P3327 [SDOI2015]约数个数和</a></p>
<p>求 ：  </p>
<script type="math/tex; mode=display">
\sum_{i = 1}^n \sum_{j = 1}^m \tau(ij)</script><p>其中 $\tau(ij)$ 表示 $i*j$ 的约数个数。</p>
<p>一个重要的公式是 ：  </p>
<script type="math/tex; mode=display">
\tau(ij) = \sum_{x \mid i}\sum_{y \mid j}[\gcd(x,y) = 1]</script><p>有了这个式子之后这道题就做完一半了。</p>
<p>式子的证明我放在了 <a target="_blank" rel="noopener" href="https://www.pozhu.cf/2022/07/24/%E6%95%B0%E8%AE%BA%E5%87%BD%E6%95%B0%E6%80%BB%E7%BB%93/">数论函数总结</a> 中 $\tau$ 性质的部分。</p>
<p>考虑有了这个之后我们怎么做 ： </p>
<script type="math/tex; mode=display">
\begin{split}
&\sum_{i = 1}^n \sum_{j = 1}^m \tau(ij)\\
=& \sum_{i = 1}^n \sum_{j = 1}^m \sum_{x \mid i}\sum_{y \mid j}[\gcd(x,y) = 1]\\
=& \sum_{x = 1}^{n}\sum_{y = 1}^{m} [\gcd(x,y) = 1] \left \lfloor \frac{n}{x} \right \rfloor \left \lfloor \frac{m}{y} \right \rfloor \\
=& \sum_{i = 1}^{n}\sum_{j = 1}^{m} [\gcd(i,j) = 1] \left \lfloor \frac{n}{i} \right \rfloor \left \lfloor \frac{m}{j} \right \rfloor \\
\end{split}</script><p>到这里我们终于看到了熟悉的 $\varepsilon(\gcd(i,j))$ ，于是直接进行莫反 ： </p>
<p>现在流行的写法大概是用莫比乌斯函数直接换 $\gcd$<br><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/paste/vx32c045">像这样</a>   :  </p>
<p>不妨假设 $n \le m$ :</p>
<script type="math/tex; mode=display">
\begin{split}
&\sum_{i = 1}^{n}\sum_{j = 1}^{m} [\gcd(i,j) = 1] \left \lfloor \frac{n}{i} \right \rfloor \left \lfloor \frac{m}{j} \right \rfloor \\
=& \sum_{i = 1}^{n}\sum_{j = 1}^{m}\left( \sum_{g \mid \gcd(i,j)} \mu(g) \right) \left \lfloor \frac{n}{i} \right \rfloor \left \lfloor \frac{m}{j} \right \rfloor \\
=& \sum_{g = 1}^{n} \mu(g) \sum_{i = 1}^{\lfloor \frac{n}{g} \rfloor} \left \lfloor \frac{n}{ig} \right \rfloor \sum_{j = 1}^{\lfloor \frac{m}{g} \rfloor} \left \lfloor \frac{m}{jg} \right \rfloor
\end{split}</script><p>在这之后显然上个整除分块就可以结束了。  </p>
<p><del>然后显然链接中的式子要比我写在这里的更加清晰，奆佬真是太有耐心啦</del></p>
<p>(原题题解中很多都采用了不流行的写法，而且那种写法并不很好理解)</p>
<p>对于大多数题解中的反演公式中的疑点，奆佬给出了<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/paste/3yr8cc6x">证明</a>。</p>
<p>本文暂不涉及那种设函数的写法，因为它至少在本题可以被以上过程更简明地表出。</p>
<h2 id="简单的数学题"><a href="#简单的数学题" class="headerlink" title="简单的数学题"></a>简单的数学题</h2><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3768">P3768 简单的数学题</a></p>
<p>求 ： </p>
<script type="math/tex; mode=display">
\left ( \sum_{i = 1}^n \sum_{j = 1}^n i \cdot j \cdot \gcd(i,j) \right) \bmod p</script><p>$n \le 10^{10} ,5 \times 10^8 \le p \le 1.1 \times 10^9$ 且 $p$ 为质数。</p>
<p>数据范围要求亚线性解法，所以杜教筛预定（</p>
<p>先写一部分谁都能推出来的式子 ： </p>
<script type="math/tex; mode=display">
\begin{split}
& \sum_{i = 1}^n \sum_{j = 1}^n i \cdot j \cdot \gcd(i,j)\\  
=& \sum_{g = 1}^n\sum_{i = 1}^n\sum_{j = 1}^n i \cdot j \cdot [\gcd(i,j) = g]\\  
=& \sum_{g = 1}^n g \sum_{i = 1}^{\left \lfloor \frac{n}{g} \right \rfloor}\sum_{j = 1}^{\left \lfloor \frac{n}{g} \right \rfloor} i \cdot j \cdot g^2[\gcd(i,j) = 1]\\  
=& \sum_{g = 1}^n g^3  \sum_{d \mid g} \mu(d)\\  
=& \sum_{d = 1}^n \mu(d) \sum_{g = 1}^{\left \lfloor \frac{n}{d} \right \rfloor} g^3 d^2 \sum_{i = 1}^{\left \lfloor \frac{n}{gd} \right \rfloor} i \sum_{j = 1}^{\left \lfloor \frac{n}{gd} \right \rfloor} j
\end{split}</script><p>到这里的复杂度显然不能解决问题。</p>
<p>考虑转化，发现后边两项可以 $O(1)$ 求，而且写起来公式需要打很长，所以我们设 $F(x) = \sum_{i = 1}^x i = \frac{x(x+1)}{2}$ ，这样就可以<del>少打很多字</del>看起来比较直观。  </p>
<p>后边的内容不看题解比较难想到。</p>
<p>设 $T = gd$ ，则原式化为 ： </p>
<script type="math/tex; mode=display">
\begin{split}
& \sum_{d = 1}^n \mu(d) \sum_{g = 1}^{\left \lfloor \frac{n}{d} \right \rfloor} g^3 d^2 \sum_{i = 1}^{\left \lfloor \frac{n}{gd} \right \rfloor} i \sum_{j = 1}^{\left \lfloor \frac{n}{gd} \right \rfloor} j\\  
=& \sum_{d = 1}^n \mu(d)  \sum_{g = 1}^{\left \lfloor \frac{n}{d} \right \rfloor} g^3 d^2 F^2 \left (\left \lfloor \frac{n}{gd} \right \rfloor \right)\\  
=& \sum_{T = 1}^n F^2 \left (\left \lfloor \frac{n}{T} \right \rfloor \right) \sum_{g \mid T} g T^2 \mu \left (\frac{T}{g} \right )\\ 
=& \sum_{T = 1}^n T^2 F^2 \left (\left \lfloor \frac{n}{T} \right \rfloor \right)  \sum_{g \mid T} \mu \left (\frac{T}{g} \right ) id(g) \\  
=& \sum_{T = 1}^n F^2 \left (\left \lfloor \frac{n}{T} \right \rfloor \right) T^2 \varphi(T) \\ 
\end{split}</script><p>到这里仍然有 $O(n)$ 的复杂度，但是发现不能采用最普通的杜教筛处理 $\varphi$ 前缀和的方法来解决，我们需要求解的是 $T^2\varphi(T)$ 的前缀和。</p>
<p>如果我们对于杜教筛的了解不仅限于能过板子的话，这里的问题就变得容易解决了很多。</p>
<p>现在我们有函数 $f(n) = n^2 \varphi(n)$ ，我们需要找到一个函数 $g$ ,使得 $\sum_{i = 1}^n f*g(i)$ 和 $\sum_{i = 1}^n g(i)$ 能够快速求出。</p>
<p>然后发现只要设 $g(n) = n^2$ 就能直接解决问题，这真是太棒了。</p>
<p>具体一点的话就是设了这个 $g$ 之后发现显然 $g$ 的前缀和非常好求，然后考虑 $f * g$ ： </p>
<script type="math/tex; mode=display">
\begin{split}
f * g(n) &= \sum_{d \mid n} f(d) g(\frac{n}{d})\\
&= \sum_{d \mid n} d^2 \varphi(d) \frac{n^2}{d^2}\\
&= n^2\sum_{d \mid n} \varphi(d)\\
&= n^3
\end{split}</script><p>然后bdfs一下得到了公式 ： </p>
<script type="math/tex; mode=display">
\sum_{i = 1}^n i^3 = \left ( \frac{n(n+1)}{2} \right )^2</script><p>所以写个整除分块，这道题做完了。</p>
<h2 id="数表"><a href="#数表" class="headerlink" title="数表"></a>数表</h2><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3312">P3312 [SDOI2014]数表</a>  </p>
<p>求 ： </p>
<script type="math/tex; mode=display">
\sum_{i=1}^n \sum_{j=1}^m \sigma(\gcd(i \cdot j))[\sigma(\gcd(i \cdot j)) \le a]</script><p><del>即将退役的菜鸡在NOIp之前竟然在更新莫反，真是离谱。</del></p>
<p>首先考虑去掉 $ \le a$ 的限制应该怎么做 ： </p>
<script type="math/tex; mode=display">
\begin{split}
&\sum_{i = 1}^n \sum_{j = 1}^m \sigma(\gcd(i,j))\\
=& \sum_{d=1}^n \sigma(d) \sum_{i=1}^{\lfloor \frac{n}{d} \rfloor}\sum_{j=1}^{\lfloor \frac{m}{d} \rfloor} [\gcd(i,j) = 1] \\
=& \sum_{d=1}^n \sigma(d) \sum_{i=1}^{\lfloor \frac{n}{d} \rfloor}\sum_{j=1}^{\lfloor \frac{m}{d} \rfloor} \sum_{g \mid (i,j)} \mu(g) \\
=& \sum_{d=1}^n \sigma(d) \sum_{g = 1}^{\lfloor \frac{n}{d} \rfloor} \mu(g) \lfloor \frac{n}{gd} \rfloor \lfloor \frac{m}{gd} \rfloor\\
\end{split}</script><p>设 $T = gd$ ，于是有 ： </p>
<script type="math/tex; mode=display">
\begin{split}
&\sum_{T = 1}^n \lfloor \frac{n}{T} \rfloor \lfloor \frac{m}{T} \rfloor \sum_{d \mid T} \sigma(d) \mu(\frac{n}{d})\\
=& \sum_{T = 1}^n \lfloor \frac{n}{T} \rfloor \lfloor \frac{m}{T} \rfloor T
\end{split}</script><p>那么在去掉这个限制时我们已经做完了。</p>
<p>虽然最后一步转化对本题不是必须的，但作为去掉限制的部分，这是一个简化。我在题解区没有看到这一步，于是我把它写在这里。</p>
<p>后边要用到的是倒数第二个式子，即</p>
<script type="math/tex; mode=display">
\sum_{T = 1}^n \lfloor \frac{n}{T} \rfloor \lfloor \frac{m}{T} \rfloor \sum_{d \mid T} \sigma(d) \mu(\frac{n}{d})</script><p>考虑 $a$ 的限制在这个式子中实际上是加在 $d$ 的身上，而不同询问之间 有很多重复的贡献，我们考虑能否离线询问，然后按照某个顺序排序，使得每次我们只需要在询问前加入多余的贡献，然后进行查询。</p>
<p>事实是可行的，容易发现对于不同的 $a$，上式中只有第二个求和号之后的贡献会发生变化。</p>
<p>于是我们考虑每次更新第二个求和部分的贡献，为了方便维护，这个贡献应该是单调不减的。</p>
<p>具体而言，我们预处理每个数的 $\sigma$ 值，并以此为关键字排序。在每个询问之前把上个询问到这个询问之间多出来的部分的数加入贡献。</p>
<p>考虑怎么统计这个贡献。</p>
<p>题目要求我们对于每个询问的复杂度做到 $O(\sqrt{n})$ 级别，于是我们只能进行一次整除分块。那么在这次整除分块中，我们应当能够 $O(1)$ 地得到第二个和式部分的前缀和。</p>
<p>考虑我们逐个数字加入贡献，而查询的是前缀和，单点修改区间查询，恰好对应了我们熟悉的<strong>树状数组</strong>。</p>
<p>那么实现的思路明确起来 ： 开一个树状数组记录对于每个 $T$，第二项和式的值，每次单点修改就对于它的所有倍数加上这个点值。</p>
<p>最终做法的复杂度是 $O(n \log^2n + q \sqrt{n} \log n)$，可以通过本题。</p>
<p>那么这道题就做完了。这似乎是我们第一次将莫反和数据结构结合起来。</p>
<p>调代码很痛苦，原因是把值域最大值开成了 $a$ 的最大值（丢人）。</p>
<p>不过调完之后1A了，证明隔壁数论函数那篇里线性处理约数和的部分没有写错。</p>
<h2 id="于神之怒加强版"><a href="#于神之怒加强版" class="headerlink" title="于神之怒加强版"></a>于神之怒加强版</h2><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P4449">P4449 于神之怒加强版</a>  </p>
<p>求 ：  </p>
<script type="math/tex; mode=display">
\sum_{i = 1}^n \sum_{j = 1}^m \gcd(i,j)^k</script><p>如果去掉 $k$ 次方的条件，那么我们已经可以随便秒杀这题了。</p>
<p>但是它确实是 $k$ 次方，所以我们不得不动一下脑子了。</p>
<p>首先先按照一点套路枚举 $\gcd$ 推出以下几步 ： </p>
<p>（也按照套路假设 $n \le m$ ）</p>
<script type="math/tex; mode=display">
\begin{split}
\sum_{i = 1}^n \sum_{j = 1}^m \gcd(i,j)^k &= \sum_{g = 1}^n g^k \sum_{i = 1}^{\left \lfloor \frac{n}{g} \right \rfloor} \sum_{j = 1}^{\left \lfloor \frac{m}{g} \right \rfloor} \left [\gcd(i,j) = 1 \right ] \\ 
&= \sum_{g = 1}^n g^k \sum_{i = 1}^{\left \lfloor \frac{n}{g} \right \rfloor} \sum_{j = 1}^{\left \lfloor \frac{m}{g} \right \rfloor} \sum_{d \mid \gcd(i,j)} \mu(d) \\
&= \sum_{g = 1}^n g^k \sum_{d = 1}^{\left \lfloor \frac{n}{g} \right \rfloor} \mu(d) \left \lfloor \frac{n}{gd} \right  \rfloor\left \lfloor \frac{m}{gd} \right \rfloor
\end{split}</script><p>到这里都是相对而言容易得到的，唯一要注意的地方大概就是第二行最后一个求和中 $d \mid (\gcd(i,j))$ 这一部分不要写错，因为提出 $g$ 之后 $\gcd(i,j)$ 的意义发生了变化，它的值也不再一定等于 $g$ 。</p>
<p>之后设 $T = gd$ 并枚举 $T$ ，这是处理这种形式的和式的一种常用手段。</p>
<p>然后就可以得到如下式子 ： </p>
<script type="math/tex; mode=display">
\begin{split}
&\sum_{T = 1}^n \sum_{g \mid T} g^k \mu \left ( \frac{T}{g} \right ) \left \lfloor \frac{n}{T} \right \rfloor \left \lfloor \frac{m}{T} \right \rfloor \\
=& \sum_{T = 1}^n \left \lfloor \frac{n}{T} \right \rfloor \left \lfloor \frac{m}{T} \right \rfloor \sum_{g \mid T} g^k \mu \left ( \frac{T}{g} \right )
\end{split}</script><p>后边的和式显然就是 $id_k <em> \mu$ ，我们已知 $id_1 </em> \mu = \varphi$ ，但是这个 $k$ 依然使我们感到棘手。</p>
<p>但是我们想到狄利克雷卷积对积性函数的性质 ： 两个积性函数的狄利克雷卷积仍然是积性函数。</p>
<p>我们又想到欧拉筛几乎可以线性筛出所有积性函数。</p>
<p>于是我们只需要筛出 $id_k * \mu$ 就完全解决了这道题。</p>
<p>设 $f(n) = (id_k * \mu)(n) = \sum_{g \mid n} g^k \mu \left ( \frac{n}{g} \right )$</p>
<p>那么对于任何一个数 $n$ ，我们都可以把它唯一分解为质数幂的乘积之后乘起来，这个过程可以隐含在欧拉筛中而不必线性写出。</p>
<p>那么我们的问题就转化为如何求 $f$ 在质数幂处的取值。</p>
<p>对于一个 $n = p^x$ ，其中 $p$ 为质数，我们可以得到 ： </p>
<script type="math/tex; mode=display">
f(p^x) = \sum_{d \mid p^x} d^k \mu \left (  \frac{p^x}{d} \right )</script><p>考虑到 $d$ 的取值恰好是 $p$ 的 $1 \sim k$ 次幂，以上和式的被加数只在两种情况下值不为 $0$ :  </p>
<ol>
<li>$d = p^x, \frac{n}{d} = 1$ ,此时值为 $p^{xk}$</li>
<li>$d = p^{x - 1}, \frac{n}{d} = p$ ,此时值为 $-p^{xk - k}$  </li>
</ol>
<p>其余情况的 $\frac{n}{d}$ 都含有平方因子， $\mu$ 值为 $0$</p>
<p>所以我们得到了 $f(p^x) = p^{xk} - p^{xk - k}(x \ge 1)$ </p>
<p>然后考虑 $f(p^{x + 1}) = p^{xk + k} - p^{xk}$  </p>
<p>结合一下就发现了 ：  $f(p^x) = f(p^{x - 1}) * p^k$ 但是只对 $x &gt; 1$ 成立，因为 $f(1) = 1$ 不满足上边的公式。</p>
<p>然后我们就有了质数幂位置的点值，我们在筛法中把它扩展到全体整数上，由以上过程可以得到这个式子 ：  </p>
<script type="math/tex; mode=display">
f(i * p) = 
\begin{cases}
f(i) * p^k & i \bmod p = 0\\
f(i) * (p^k - 1) & i \bmod p \neq 0
\end{cases}</script><p>解释一下就是第一种情况是没有增加新的质因子，使用 $f(p^x) = f(p^{x - 1}) * p^k$</p>
<p>第二种情况就是一个新的质因子，使用 $f(p^x) = p^{xk} - p^{xk - k}(x \ge 1)$ 代入 $x = 1$ 得到 $f(p) = p^k - 1$</p>
<p>然后可以进行欧拉筛，我们解决了最后一个问题，这道题做完了。</p>
<p>我们这里第一次解决了被加数是幂形式的问题。</p>
<p>从某篇题解里找来了这个做法的复杂度是 $O(n + tot \times \log k + T \times \sqrt{n})$ 其中 $tot$ 是质数的个数。</p>
<h2 id="数字表格"><a href="#数字表格" class="headerlink" title="数字表格"></a>数字表格</h2><p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3704">P3704 [SDOI2017]数字表格</a>  </p>
<p>求 ：  </p>
<script type="math/tex; mode=display">
\prod_{i = 1}^n \prod_{j = 1}^m f_{\gcd(i,j)}</script><p>其中 $f_i$ 表示斐波那契数列的第 $i$ 项。</p>
<script type="math/tex; mode=display">
f_0 = 0,f_1 = 1</script><script type="math/tex; mode=display">
f_n = f_{n - 1} + f_{n - 2},n \ge 2</script><p>我们在这里第一次见到连乘形式的问题。</p>
<p>似乎很多对加法运算成立的方法不再适用。不过没关系，我们依然可以枚举 $\gcd$</p>
<script type="math/tex; mode=display">
\begin{split}
\prod_{i = 1}^n \prod_{j = 1}^m f_{\gcd(i,j)} &= \prod_{i = 1}^n \prod_{j = 1}^m \prod_{g = 1}^g f_{g} [\gcd(i,j) = g] \\
&= \prod_{g = 1}^n f_g ^ {\sum_{i = 1}^{\left \lfloor \frac{n}{g} \right \rfloor}\sum_{j = 1}^{\left \lfloor \frac{m}{g} \right \rfloor} [\gcd(i,j) = 1] }
\end{split}</script><p>容易发现这个提前 $g$ 的思路是统计每个 $g$ 被从乘了多少次，所以把前边变成和式扔到指数上。</p>
<p>然后发现这个指数我们非常熟悉 ： </p>
<script type="math/tex; mode=display">
\begin{split}
&\sum_{i = 1}^{\left \lfloor \frac{n}{g} \right \rfloor}\sum_{j = 1}^{\left \lfloor \frac{m}{g} \right \rfloor} [\gcd(i,j) = 1] \\
=& \sum_{d = 1} ^ {\left \lfloor \frac{n}{g} \right \rfloor} \left \lfloor \frac{n}{gd} \right \rfloor \left \lfloor \frac{m}{gd} \right \rfloor
\end{split}</script><p>这两步之间的过程都是老套路了，不再赘述。</p>
<p>此时原式变成 ：  </p>
<script type="math/tex; mode=display">
\prod_{g = 1}^n f_g ^ {\sum_{d = 1} ^ {\left \lfloor \frac{n}{g} \right \rfloor} \left \lfloor \frac{n}{gd} \right \rfloor \left \lfloor \frac{m}{gd} \right \rfloor}</script><p>其实化到这里直接进行整除分块可以通过本题，但是正解还应当继续，于是我们继续。</p>
<p>考虑枚举 $T = gd$ ： </p>
<script type="math/tex; mode=display">
\prod_{T = 1}^n \prod_{d \mid T} f_d ^{\mu(\frac{T}{d}) \left \lfloor \frac{n}{T} \right \rfloor \left \lfloor \frac{m}{T} \right \rfloor }</script><p>然后因为指数上的乘法等于次方嵌套:  </p>
<script type="math/tex; mode=display">
\prod_{T = 1}^n \prod_{d \mid T} \left ( f_d ^{\mu(\frac{T}{d}) } \right ) ^ { \left \lfloor \frac{n}{T}  \right \rfloor \left \lfloor \frac{m}{T} \right \rfloor }</script><p>发现 $\left \lfloor \frac{n}{T}  \right \rfloor \left \lfloor \frac{m}{T} \right \rfloor $ 与 $d$ 无关。</p>
<p>根据同指数乘法的运算法则我们得到 ：  </p>
<script type="math/tex; mode=display">
\prod_{T = 1}^n \left ( \prod_{d \mid T} f_d ^{\mu(\frac{T}{d}) } \right ) ^ { \left \lfloor \frac{n}{T}  \right \rfloor \left \lfloor \frac{m}{T} \right \rfloor }</script><p>内层括号内的式子不好再化简，所以直接暴力算，时间大概是 $O(n \log n)$ ，实际上这题有更优的做法，<del>但是这里空白太小写不下</del>。</p>
<h1 id="补充"><a href="#补充" class="headerlink" title="补充"></a>补充</h1><h2 id="对常用卷积的证明"><a href="#对常用卷积的证明" class="headerlink" title="对常用卷积的证明"></a>对常用卷积的证明</h2><p>参考内容 ： <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/137619492">算法学习笔记(35): 狄利克雷卷积</a>、<a target="_blank" rel="noopener" href="https://www.cnblogs.com/tttkf/p/15952812.html">浅析狄利克雷卷积 </a></p>
<h3 id="一"><a href="#一" class="headerlink" title="一"></a>一</h3><script type="math/tex; mode=display">
f*1 = \sum_{d \mid n} f(d)</script><p>定义。</p>
<h3 id="二"><a href="#二" class="headerlink" title="二"></a>二</h3><script type="math/tex; mode=display">
id_k*1 = \sigma_k</script><p>证 ： </p>
<script type="math/tex; mode=display">
\begin{split}
id_k * 1 &= \sum_{d \mid n} id_k(d) \\
&= \sum_{d \mid n} d^k \\
&= \sigma_k
\end{split}</script><h3 id="三"><a href="#三" class="headerlink" title="三"></a>三</h3><script type="math/tex; mode=display">
\varphi * 1 = id</script><p>证 ： </p>
<script type="math/tex; mode=display">
(\varphi * 1)(n) = \sum_{d \mid n} \varphi(d)</script><p>当 $p$ 为质数时，有 ： </p>
<script type="math/tex; mode=display">
\begin{split}
\sum_{p^m \mid n} \varphi(p^m) &= \varphi(1) + \sum_{i = 1}^m \varphi(p^i) \\ 
&= 1 + \sum_{i = 1}^m(p^i - p^{i - 1}) \\
&= p^m
\end{split}</script><p>其中第一步到第二步的变化是因为 $p$ 是质数，$p^m$ 的所有因子就是 $p$ 的 $0 \sim m$ 次幂，单独考虑 $0$ 次幂方便后边转化。</p>
<p>第二步到第三步的变化用到了欧拉函数的性质，在<a href="/2022/07/24/%E6%95%B0%E8%AE%BA%E5%87%BD%E6%95%B0%E6%80%BB%E7%BB%93/">数论函数总结</a>中欧拉函数的性质第二条给出了证明。</p>
<p>现在令 $n$ 为正整数，那么它可以被唯一分解为 $\prod p^m$ 。</p>
<p>由于 $\varphi * 1$ 是积性函数，有 ： </p>
<script type="math/tex; mode=display">
\begin{split}
(\varphi * 1)(n) &= (\varphi * 1)(\prod p^m) \\
&= \prod(\varphi * 1)(p^m) \\
&= \prod p^m\\
&= n
\end{split}</script><p>得证。</p>
<h3 id="四"><a href="#四" class="headerlink" title="四"></a>四</h3><script type="math/tex; mode=display">
\mu * 1 = \varepsilon</script><p>证明 ： </p>
<script type="math/tex; mode=display">
(\mu * 1)(n) = \sum_{d \mid n} \mu(d)</script><p>当 $n = 1$ 时，结论平凡。</p>
<script type="math/tex; mode=display">
(\mu * 1)(1) = \mu(1) = 1</script><p>对于 $n \neq 1$，则我们对 $n$ 唯一分解 ： </p>
<script type="math/tex; mode=display">
n = \prod_{i = 1}^{k}p_i^{a_i}</script><p>于是 $n$ 的约数 $d$ 可以表达成 $d = \prod_{i = 1}^{b}p_i^{c_i}$ 的形式。</p>
<p>根据莫比乌斯函数的定义式，容易发现只有满足所有 $c_i \le 1$ 的项才有贡献。</p>
<p>对于有 $k$ 个 $c_i = 1$，贡献为 $(-1)^k$</p>
<p>于是 $d$ 的贡献就是 ：  </p>
<script type="math/tex; mode=display">
\sum_{k = 0}^{b} C_{b}^k (-1)^k</script><p>得到一层组合数偶数项减去奇数项的值，由于每层组合数奇数项等于偶数项，我们得到 $d$ 的贡献为 $0$。</p>
<p>于是 $n$ 的任意约数贡献都为 $0$。</p>
<p>得到 $(\mu * 1)(n) = 0 \space (n \neq 1)$</p>
<p>于是 ： </p>
<script type="math/tex; mode=display">
(\mu * 1)(n) = \varepsilon(n) =
\begin{cases}
1 & n = 1\\
0 & n \neq 1
\end{cases}</script><p>得证。</p>
<h3 id="五"><a href="#五" class="headerlink" title="五"></a>五</h3><script type="math/tex; mode=display">
id * \mu = \varphi</script><p>由 $\varphi * 1 = id$ 及式七结论可得。</p>
<h3 id="六"><a href="#六" class="headerlink" title="六"></a>六</h3><!-- $$
\mu * d = 1
$$ -->
<script type="math/tex; mode=display">
1 * 1 = \tau</script><script type="math/tex; mode=display">
(1 * 1)(n) = \sum_{d \mid n} 1</script><p>容易发现取值就是 $n$ 的因子个数。</p>
<h3 id="七"><a href="#七" class="headerlink" title="七"></a>七</h3><p>若 $F = 1*f$ 则有 ： </p>
<script type="math/tex; mode=display">
f = \mu * F</script><p>证明 ： </p>
<script type="math/tex; mode=display">
\begin{split}
&F = 1 * f\\
&F * \mu = 1 * \mu * f\\
&F * \mu = \varepsilon * f\\
&f = \mu * F
\end{split}</script><p>从这里可以得到莫比乌斯函数作为狄利克雷卷积的逆元性质。</p>
<script type="math/tex; mode=display">
Q.E.D</script></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://pukui.github.io">Pozhu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://pukui.github.io/2022/09/13/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E6%80%BB%E7%BB%93/">http://pukui.github.io/2022/09/13/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E6%80%BB%E7%BB%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://pukui.github.io" target="_blank">Pozhu's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E5%AD%A6/">数学</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E8%AE%BA/">数论</a><a class="post-meta__tags" href="/tags/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94/">莫比乌斯反演</a></div><div class="post_share"><div class="social-share" data-image="https://s2.loli.net/2022/12/06/i2ZEzRqn8OxmpjX.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/09/14/%E6%96%B0%E7%9A%84%E6%97%A5%E7%BB%93/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/06/i2ZEzRqn8OxmpjX.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">新的日结</div></div></a></div><div class="next-post pull-right"><a href="/2022/09/10/pictures/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/06/i2ZEzRqn8OxmpjX.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">pictures</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/08/17/%E5%A4%A7%E5%87%AF%E7%9A%84%E7%96%91%E6%83%91%EF%BC%88%E4%B9%B0%E7%9A%84%E5%88%B0%E7%9A%84%E6%95%B0%E7%9B%AE%EF%BC%89/" title="大凯的疑惑（买的到的数目）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/06/i2ZEzRqn8OxmpjX.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-17</div><div class="title">大凯的疑惑（买的到的数目）</div></div></a></div><div><a href="/2022/07/24/%E6%95%B0%E8%AE%BA%E5%87%BD%E6%95%B0%E6%80%BB%E7%BB%93/" title="数论函数总结"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.luogu.com.cn/upload/image_hosting/senri1n5.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-24</div><div class="title">数论函数总结</div></div></a></div><div><a href="/2022/07/25/%E6%95%B0%E8%AE%BA%E6%9D%82%E8%B0%88/" title="数论杂谈"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.luogu.com.cn/upload/image_hosting/je7i52ig.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-25</div><div class="title">数论杂谈</div></div></a></div><div><a href="/2022/07/24/%E6%95%B0%E8%AE%BA%E7%AE%97%E6%B3%95%E3%80%81%E5%AE%9A%E7%90%86%E5%92%8C%E5%B8%B8%E7%94%A8%E5%8F%98%E6%8D%A2/" title="数论算法、定理和常用变换"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/06/i2ZEzRqn8OxmpjX.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-24</div><div class="title">数论算法、定理和常用变换</div></div></a></div><div><a href="/2022/08/15/%E6%95%B0%E8%AE%BA%E8%AE%B2%E8%AF%BE%C2%B7%E6%98%93/" title="数论讲课·易"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/06/i2ZEzRqn8OxmpjX.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-15</div><div class="title">数论讲课·易</div></div></a></div><div><a href="/2022/07/25/%E7%AD%9B%E6%B3%95%EF%BC%8C%E4%BA%9A%E7%BA%BF%E6%80%A7%E4%B8%8E%E7%BA%BF%E6%80%A7/" title="筛法，亚线性与线性"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.luogu.com.cn/upload/image_hosting/tmwhb4q3.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-25</div><div class="title">筛法，亚线性与线性</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Giscus</span><span class="switch-btn"></span><span class="second-comment">Valine</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/06/1TaJK5kxjyFdfDA.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Pozhu</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">46</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">10</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pukui"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/pukui" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">图床修了懒得放图</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E7%9F%A5%E8%AF%86"><span class="toc-number">2.</span> <span class="toc-text">基本知识</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%87%BD%E6%95%B0"><span class="toc-number">2.1.</span> <span class="toc-text">莫比乌斯函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%8B%84%E5%88%A9%E5%85%8B%E9%9B%B7%E5%8D%B7%E7%A7%AF"><span class="toc-number">2.2.</span> <span class="toc-text">狄利克雷卷积</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89-%EF%BC%9A"><span class="toc-number">2.2.1.</span> <span class="toc-text">定义 ：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8%EF%BC%9A"><span class="toc-number">2.2.2.</span> <span class="toc-text">性质：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E5%8D%B7%E7%A7%AF"><span class="toc-number">2.2.3.</span> <span class="toc-text">常用卷积</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E5%A5%97%E8%B7%AF"><span class="toc-number">3.</span> <span class="toc-text">基本套路</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94"><span class="toc-number">3.1.</span> <span class="toc-text">一、莫比乌斯反演</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%AC%A7%E6%8B%89%E5%8F%8D%E6%BC%94"><span class="toc-number">3.2.</span> <span class="toc-text">二、欧拉反演</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BA%94%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">应用</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0"><span class="toc-number">4.1.</span> <span class="toc-text">简单的最大公约数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Problem-b"><span class="toc-number">4.2.</span> <span class="toc-text">Problem b</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#YY%E7%9A%84GCD"><span class="toc-number">4.3.</span> <span class="toc-text">YY的GCD</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Crash%E7%9A%84%E6%95%B0%E5%AD%97%E8%A1%A8%E6%A0%BC"><span class="toc-number">4.4.</span> <span class="toc-text">Crash的数字表格</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BA%A6%E6%95%B0%E4%B8%AA%E6%95%B0%E5%92%8C"><span class="toc-number">4.5.</span> <span class="toc-text">约数个数和</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%AE%80%E5%8D%95%E7%9A%84%E6%95%B0%E5%AD%A6%E9%A2%98"><span class="toc-number">4.6.</span> <span class="toc-text">简单的数学题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E8%A1%A8"><span class="toc-number">4.7.</span> <span class="toc-text">数表</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8E%E7%A5%9E%E4%B9%8B%E6%80%92%E5%8A%A0%E5%BC%BA%E7%89%88"><span class="toc-number">4.8.</span> <span class="toc-text">于神之怒加强版</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E5%AD%97%E8%A1%A8%E6%A0%BC"><span class="toc-number">4.9.</span> <span class="toc-text">数字表格</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E8%A1%A5%E5%85%85"><span class="toc-number">5.</span> <span class="toc-text">补充</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E5%B8%B8%E7%94%A8%E5%8D%B7%E7%A7%AF%E7%9A%84%E8%AF%81%E6%98%8E"><span class="toc-number">5.1.</span> <span class="toc-text">对常用卷积的证明</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80"><span class="toc-number">5.1.1.</span> <span class="toc-text">一</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C"><span class="toc-number">5.1.2.</span> <span class="toc-text">二</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89"><span class="toc-number">5.1.3.</span> <span class="toc-text">三</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B"><span class="toc-number">5.1.4.</span> <span class="toc-text">四</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94"><span class="toc-number">5.1.5.</span> <span class="toc-text">五</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AD"><span class="toc-number">5.1.6.</span> <span class="toc-text">六</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%83"><span class="toc-number">5.1.7.</span> <span class="toc-text">七</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/12/22/CF1182F/" title="CF1182F"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/06/i2ZEzRqn8OxmpjX.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="CF1182F"/></a><div class="content"><a class="title" href="/2022/12/22/CF1182F/" title="CF1182F">CF1182F</a><time datetime="2022-12-22T13:10:29.000Z" title="发表于 2022-12-22 21:10:29">2022-12-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/07/%E6%9D%82%E9%A2%98%E9%80%89%E8%AE%B2/" title="杂题选讲"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/06/i2ZEzRqn8OxmpjX.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="杂题选讲"/></a><div class="content"><a class="title" href="/2022/12/07/%E6%9D%82%E9%A2%98%E9%80%89%E8%AE%B2/" title="杂题选讲">杂题选讲</a><time datetime="2022-12-07T12:29:43.000Z" title="发表于 2022-12-07 20:29:43">2022-12-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/07/%E6%95%B0%E5%AD%A6%E5%8D%9A%E5%AE%A2%E9%98%85%E8%AF%BB%E7%B4%A2%E5%BC%95/" title="数学博客阅读索引"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/06/i2ZEzRqn8OxmpjX.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数学博客阅读索引"/></a><div class="content"><a class="title" href="/2022/12/07/%E6%95%B0%E5%AD%A6%E5%8D%9A%E5%AE%A2%E9%98%85%E8%AF%BB%E7%B4%A2%E5%BC%95/" title="数学博客阅读索引">数学博客阅读索引</a><time datetime="2022-12-07T12:28:03.000Z" title="发表于 2022-12-07 20:28:03">2022-12-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/12/07/%E7%BE%A4%E8%AE%BA%E5%9F%BA%E7%A1%80/" title="群论基础"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/06/i2ZEzRqn8OxmpjX.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="群论基础"/></a><div class="content"><a class="title" href="/2022/12/07/%E7%BE%A4%E8%AE%BA%E5%9F%BA%E7%A1%80/" title="群论基础">群论基础</a><time datetime="2022-12-07T12:26:02.000Z" title="发表于 2022-12-07 20:26:02">2022-12-07</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/11/07/DP%E5%8F%8A%E4%BC%98%E5%8C%96%E9%A2%98%E8%AE%B0/" title="DP及优化题记"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s2.loli.net/2022/12/06/i2ZEzRqn8OxmpjX.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="DP及优化题记"/></a><div class="content"><a class="title" href="/2022/11/07/DP%E5%8F%8A%E4%BC%98%E5%8C%96%E9%A2%98%E8%AE%B0/" title="DP及优化题记">DP及优化题记</a><time datetime="2022-11-07T12:09:46.000Z" title="发表于 2022-11-07 20:09:46">2022-11-07</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2023 By Pozhu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadGiscus () {
  let nowTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light'

  const config = Object.assign({
    src: 'https://giscus.app/client.js',
    'data-repo': 'pukui/comment',
    'data-repo-id': 'R_kgDOIBC3iw',
    'data-category-id': 'DIC_kwDOIBC3i84CRme7',
    'data-mapping': 'pathname',
    'data-theme': nowTheme,
    'data-reactions-enabled': '1',
    crossorigin: 'anonymous',
    async: true
  },null)

  let ele = document.createElement('script')
  for (let key in config) {
    ele.setAttribute(key, config[key])
  }
  document.getElementById('giscus-wrap').insertAdjacentElement('afterbegin',ele)
}

function changeGiscusTheme () {
  const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light'

  function sendMessage(message) {
    const iframe = document.querySelector('iframe.giscus-frame');
    if (!iframe) return;
    iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
  }

  sendMessage({
    setConfig: {
      theme: theme
    }
  });
}

if ('Giscus' === 'Giscus' || !false) {
  if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
  else loadGiscus()
} else {
  function loadOtherComment () {
    loadGiscus()
  }
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'FT8G3pBXmRbzp9WigXTv6Myu-MdYXbMMI',
      appKey: 'pzv72ZU5yq0jHCmG9wbBuL1l',
      avatar: 'monsterid',
      serverURLs: 'https://FT8G3pBX.api.lncldglobal.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Giscus' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script src="//code.tidio.co/d8owaeytaz6ydoshtoescuj9qseqxpnf.js" async="async"></script><script>function onTidioChatApiReady() {
  window.tidioChatApi.hide();
  window.tidioChatApi.on("close", function() {
    window.tidioChatApi.hide();
  });
}
if (window.tidioChatApi) {
  window.tidioChatApi.on("ready", onTidioChatApiReady);
} else {
  document.addEventListener("tidioChat-ready", onTidioChatApiReady);
}

var chatBtnFn = () => {
  document.getElementById("chat_btn").addEventListener("click", function(){
    window.tidioChatApi.show();
    window.tidioChatApi.open();
  });
}
chatBtnFn()
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>