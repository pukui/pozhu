<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"><title>数论讲课·易 | Pozhu's blog</title><meta name="keywords" content="数学,数论"><meta name="author" content="Pozhu"><meta name="copyright" content="Pozhu"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="内容摘要 ：本文主要包含以下数论基础知识点 ：    整除 、gcd 、lcm 、exgcd 、同余、同余方程 快速幂、费马小定理、逆元   埃式筛法、线性筛   欧拉函数、卢卡斯定理  感谢zh_dou学长的博客赞助（大概这篇文就是数论·易+oi-wiki罢   注 ： 本文已经年久失修，由于本文内容已经分散在其他文章中进行了更新，这里给出链接 ：   Part1,2 : 数论杂谈   Part">
<meta property="og:type" content="article">
<meta property="og:title" content="数论讲课·易">
<meta property="og:url" content="http://pukui.github.io/2022/08/15/%E6%95%B0%E8%AE%BA%E8%AE%B2%E8%AF%BE%C2%B7%E6%98%93/index.html">
<meta property="og:site_name" content="Pozhu&#39;s blog">
<meta property="og:description" content="内容摘要 ：本文主要包含以下数论基础知识点 ：    整除 、gcd 、lcm 、exgcd 、同余、同余方程 快速幂、费马小定理、逆元   埃式筛法、线性筛   欧拉函数、卢卡斯定理  感谢zh_dou学长的博客赞助（大概这篇文就是数论·易+oi-wiki罢   注 ： 本文已经年久失修，由于本文内容已经分散在其他文章中进行了更新，这里给出链接 ：   Part1,2 : 数论杂谈   Part">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://s1.328888.xyz/2022/08/10/4eqQn.webp">
<meta property="article:published_time" content="2022-08-15T14:09:03.000Z">
<meta property="article:modified_time" content="2022-09-27T07:16:13.792Z">
<meta property="article:author" content="Pozhu">
<meta property="article:tag" content="数学">
<meta property="article:tag" content="数论">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://s1.328888.xyz/2022/08/10/4eqQn.webp"><link rel="shortcut icon" href="https://s1.328888.xyz/2022/09/09/91KLp.png"><link rel="canonical" href="http://pukui.github.io/2022/08/15/%E6%95%B0%E8%AE%BA%E8%AE%B2%E8%AF%BE%C2%B7%E6%98%93/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: '数论讲课·易',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2022-09-27 15:16:13'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
    const detectApple = () => {
      if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
        document.documentElement.classList.add('apple')
      }
    }
    detectApple()
    })(window)</script><meta name="generator" content="Hexo 6.2.0"></head><body><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/07/27/Ds1AN.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://s1.328888.xyz/2022/08/10/4eqQn.webp')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">Pozhu's blog</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 时间轴</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> 友链</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">数论讲课·易</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="fa-fw post-meta-icon far fa-calendar-alt"></i><span class="post-meta-label">发表于</span><time datetime="2022-08-15T14:09:03.000Z" title="发表于 2022-08-15 22:09:03">2022-08-15</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E8%AF%BE%E4%BB%B6/">课件</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">6.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>25分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="数论讲课·易"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="内容摘要-："><a href="#内容摘要-：" class="headerlink" title="内容摘要 ："></a>内容摘要 ：</h1><p>本文主要包含以下数论基础知识点 ：  </p>
<ul>
<li>整除 、gcd 、lcm 、exgcd 、同余、同余方程</li>
<li>快速幂、费马小定理、逆元  </li>
<li>埃式筛法、线性筛  </li>
<li>欧拉函数、卢卡斯定理</li>
</ul>
<p>感谢zh_dou学长的博客赞助（大概这篇文就是数论·易+oi-wiki罢  </p>
<p>注 ： 本文已经年久失修，由于本文内容已经分散在其他文章中进行了更新，这里给出链接 ：  </p>
<p>Part1,2 : <a target="_blank" rel="noopener" href="https://www.pozhu.cf/2022/07/25/%E6%95%B0%E8%AE%BA%E6%9D%82%E8%B0%88/">数论杂谈</a>  </p>
<p>Part3 : <a target="_blank" rel="noopener" href="https://www.pozhu.cf/2022/07/25/%E7%AD%9B%E6%B3%95%EF%BC%8C%E4%BA%9A%E7%BA%BF%E6%80%A7%E4%B8%8E%E7%BA%BF%E6%80%A7/">筛法，亚线性和线性</a>  </p>
<p>Part4 : <a target="_blank" rel="noopener" href="https://www.pozhu.cf/2022/07/24/%E6%95%B0%E8%AE%BA%E5%87%BD%E6%95%B0%E6%80%BB%E7%BB%93/">数论函数总结</a> 和 <a target="_blank" rel="noopener" href="https://www.pozhu.cf/2022/07/24/%E6%95%B0%E8%AE%BA%E7%AE%97%E6%B3%95%E3%80%81%E5%AE%9A%E7%90%86%E5%92%8C%E5%B8%B8%E7%94%A8%E5%8F%98%E6%8D%A2/">数论算法、定理和常用变换</a>  </p>
<p>以上文章内容中对与本文重合的部分可能会有修改和补充。  </p>
<p>但仍保留本文（因为如果啥时候得讲课可以把这个课件修一修拿来用）  </p>
<h1 id="Part-1"><a href="#Part-1" class="headerlink" title="Part 1"></a>Part 1</h1><h2 id="让我们从整除开始，这样对吧"><a href="#让我们从整除开始，这样对吧" class="headerlink" title="让我们从整除开始，这样对吧"></a>让我们从整除开始，这样对吧</h2><h3 id="定义："><a href="#定义：" class="headerlink" title="定义："></a>定义：</h3><p>设 $a,b\in Z,a \neq 0$。如果 $ \exists q \in Z$，使得 $b=aq$ ，那么就说 $b$ 可被 $a$ 整除，记作 $a \mid b$ ，且称 $b$ 是 $a$ 的倍， $a$ 是 $b$ 的约数（因数）。  </p>
<p>$b$ 不被 $a$ 整除记作 $a \nmid b$ 。  </p>
<p>任何正整数都是 $0$ 的约数。  </p>
<p>找了找整除的定义，大概是能否整除的判断随着定义的范围而变化，下边的整除大多定义在整数域（或许有的在非负整数域罢）。  </p>
<h3 id="性质："><a href="#性质：" class="headerlink" title="性质："></a>性质：</h3><ul>
<li>$a \mid b \Longleftrightarrow -a \mid b \Longleftrightarrow a \mid -b \Longleftrightarrow |a| \mid |b|$  </li>
<li>$a \mid b \space \wedge b \mid c \Longrightarrow a \mid c$</li>
<li>$a \mid b \space \wedge a \mid c \Longleftrightarrow \forall x,y \in Z ,a \mid (xb+yc)$</li>
<li>$a \mid b \wedge b \mid a \Longrightarrow b = \pm a$</li>
<li>设 $m \neq 0$ ，那么 $a \mid b \Longleftrightarrow ma \mid mb$</li>
<li>设 $b \neq 0$ ，那么 $a \mid b \Longleftrightarrow |a| \le |b|$   </li>
<li>设 $a \neq b,b = qa + c$ ，那么 $a \mid b \Longleftrightarrow a \mid c$</li>
</ul>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/nefu929831238/p/6024861.html#:~:text=%E6%95%B4%E9%99%A4%E8%A7%84%E5%88%99%E7%AC%AC%E4%B8%80%E6%9D%A1%EF%BC%881%EF%BC%89%EF%BC%9A%E4%BB%BB%E4%BD%95%E6%95%B0%E9%83%BD%E8%83%BD%E8%A2%AB1%E6%95%B4%E9%99%A4%E3%80%82,%E6%95%B4%E9%99%A4%E8%A7%84%E5%88%99%E7%AC%AC%E4%BA%8C%E6%9D%A1%EF%BC%882%EF%BC%89%EF%BC%9A%E4%B8%AA%E4%BD%8D%E4%B8%8A%E6%98%AF2%E3%80%814%E3%80%816%E3%80%818%E3%80%810%E7%9A%84%E6%95%B0%E9%83%BD%E8%83%BD%E8%A2%AB2%E6%95%B4%E9%99%A4%E3%80%82%20%E6%95%B4%E9%99%A4%E8%A7%84%E5%88%99%E7%AC%AC%E4%B8%89%E6%9D%A1%EF%BC%883%EF%BC%89%EF%BC%9A%E6%AF%8F%E4%B8%80%E4%BD%8D%E4%B8%8A%E6%95%B0%E5%AD%97%E4%B9%8B%E5%92%8C%E8%83%BD%E8%A2%AB3%E6%95%B4%E9%99%A4%EF%BC%8C%E9%82%A3%E4%B9%88%E8%BF%99%E4%B8%AA%E6%95%B0%E5%B0%B1%E8%83%BD%E8%A2%AB3%E6%95%B4%E9%99%A4%E3%80%82">关于判断能否整除</a><br>上边这个对 OI 没什么用所以不打算讲（  </p>
<p>0 是所有非零整数的倍数。对于任意非零整数，其约数只有有限个。  </p>
<p>严格地说，没有任何数能被 $-1$ 整除——《具体数学》  </p>
<p>显然约数（显然因数） ： 对于整数 $b \neq 0$，$\pm 1,\pm b$ 是 $b$ 的显然约数，当 $b = \pm 1$ 时， $b$ 只有两个显然约数。</p>
<p>对于整数 $b \neq 0$ ,$b$ 的其他约数称为真约数（真因数、非显然约数、非显然因数）。</p>
<p>约数的性质 ：  </p>
<ul>
<li>设整数 $b \neq 0$ .当 $d$ 遍历 $b$ 的全体约数的时候，$\frac{b}{d} $ 也遍历 $b$ 的全体约数。</li>
<li>设整数 $b &gt; 0$，则当$d$ 遍历 $b$ 的全体约数的时候，$\frac{b}{d} $ 也遍历 $b$ 的全体正约数。</li>
</ul>
<h2 id="质数（素数）"><a href="#质数（素数）" class="headerlink" title="质数（素数）"></a>质数（素数）</h2><blockquote>
<p>质数是指在大于1的自然数中，除了1和它本身以外不再有其他因数的自然数。  </p>
</blockquote>
<p>$0$ 和 $1$ 既不是质数也不是合数。</p>
<h3 id="性质"><a href="#性质" class="headerlink" title="性质"></a>性质</h3><p>素数有无穷个  </p>
<p>证明 ：  </p>
<p>（经典反证法） 假设只有 $n$ 个质数，他们构成一个质数集合 $P$ ，设 $N = \prod_{i=1}^n P_i$ ，那么 $N+1$ 是素数或合数  </p>
<p>如果是 ，那么 $N+1$ 大于素数集合中的任意一个数，所以它不在假设的集合中。  </p>
<p>如果不是，则它可以分解为有限个质数幂的乘积。因为 $N \bot N+1$ ，所以假设的质数集合中的任意一个质数都不能整除 $N+1$ ，那么在集合外一定还存在其他素数。  </p>
<p>两种情况都与假设矛盾，于是不存在有限个质数组成质数集合。即质数有无穷个</p>
<h3 id="素数数目的计算"><a href="#素数数目的计算" class="headerlink" title="素数数目的计算"></a>素数数目的计算</h3><h4 id="素数定理"><a href="#素数定理" class="headerlink" title="素数定理"></a>素数定理</h4><blockquote>
<p>素数定理（prime number theorem）是素数分布理论的中心定理，是关于素数个数问题的一个命题： 设 $x \ge 1$ ，以 $\pi(x)$ 表示不超过x的素数的个数，当 $x\rightarrow \infty$ 时， $π(x) \sim Li(x)$ 或 $π(x) \sim x/ln(x)$ 。（ $Li(x)$ 为对数积分）  </p>
</blockquote>
<script type="math/tex; mode=display">
\pi(x) = Li(x) + O(xe^{-c\sqrt{\ln x}}) \; (x \rightarrow \infty)</script><p>其中 $Li(x) = \int_{2}^{x} \frac{dt}{\ln t}$ ， $O(xe^{-c\sqrt{\ln x}})$<br>是误差估计  </p>
<p>素数定理可以给出第 $n$ 个素数 $p(n)$ 的渐进估计 ： $p(n) \sim \frac{n}{\ln n}$。  </p>
<p>它也给出从整数中抽到素数的概率。从不大于 $n$ 的自然数中随机选一个，他是素数的概率大约是 $\frac{1}{\ln n}$ 。</p>
<p>证明： 看了一眼初等证明，然后放弃了（  </p>
<ol>
<li>在一个大于 $1$ 的数 $a$ 和它的 $2$ 倍之间（即 $(a,2a]$ ），必存在至少一个素数</li>
<li>存在任意长度的素数等差数列  </li>
<li>一个偶数可以写成两个合数之和，其中每一个合数最多只有 $9$ 个质因数。</li>
<li>一个偶数必定可以写成一个质数加上一个合成数，其中合数的因子个数有上界。</li>
<li>一个偶数必定可以写成一个质数加上一个最多由 $5$ 个因子所组成的合成数。后来，有人简称这一结果为 $(1+5)$  </li>
<li>一个充分大偶数必定可以写成一个素数加上一个最多由 $2$ 个质因子所组成的合成数。</li>
</ol>
<h2 id="gcd与lcm"><a href="#gcd与lcm" class="headerlink" title="gcd与lcm"></a>gcd与lcm</h2><h3 id="互质"><a href="#互质" class="headerlink" title="互质"></a>互质</h3><blockquote>
<p>互质是公约数只有1的两个整数，叫做互质整数。公约数只有1的两个自然数，叫做互质自然数，后者是前者的特殊情形。<br>（摘自百度百科）  </p>
</blockquote>
<p>互质,若 $N$ 个整数的最大公因数是 $1$ ，则称这 $N$ 个整数互质。显然 $N$ 个数互质和这 $N$ 个数两两互质是不同的条件，并且后者比前者更强。  </p>
<p>$1$ 和任何数都成倍数关系，但和任何数都互质  </p>
<p><strong>1和-1与所有整数互素，而且它们是唯一与0互素的整数。</strong>  </p>
<p>通过有理数的表示方式 $x = \frac{p}{q} ,p \bot q $ 也可以看出 $0$ 与 $\pm 1$ 互质，否则 $0$ 不是有理数。</p>
<p>显然除 $1$ 之外，一个数和它本身不互质  </p>
<h3 id="最大公约数（gcd）"><a href="#最大公约数（gcd）" class="headerlink" title="最大公约数（gcd）"></a>最大公约数（gcd）</h3><p>Greatest Common Divisor (gcd)</p>
<p>一组数的公约数就是指同时是这组数中每一个数的约数的数. $\pm 1$ 是任意一组整数的公约数.</p>
<p>最大公约数就是最大的公约数.</p>
<p>定义 $gcd(0,0) = 0$  </p>
<h4 id="性质-："><a href="#性质-：" class="headerlink" title="性质 ："></a>性质 ：</h4><ul>
<li>$gcd(a,b) = gcd(a,a-b) = gcd(b,a-b)$(更相减损)</li>
<li>$gcd(2a,2b) = 2gcd(a,b)$</li>
</ul>
<p>例题是<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/UVA11426">UVA11426</a></p>
<p>那就推一下这个例题的式子罢 ： </p>
<script type="math/tex; mode=display">
\begin{split}
\sum_{i=1}^n \sum_{j = i+1}^n &= \sum_{j = 2}^n \sum_{i = 1}^{j-1}gcd(i,j)\\
&= \sum_{d=1}^n d \times \sum_{j=2}^n \sum_{i = 1}^{j-1}[gcd(i,j) = d] \\
&= \sum_{d=1}^n d \times \sum_{j=2}^{\lfloor \frac{n}{d} \rfloor} \sum_{i=1}^{j-1}[i \bot j]\\
&= \sum_{d=1}^n d \times \sum_{j=2}^{\lfloor \frac{n}{d} \rfloor}\varphi(j)\\
\end{split}</script><p>到这里第一步已经成功了，都是经典操作也没什么难度。考虑进一步优化：<br>设 $S(x) = \sum_{j=2}^x \varphi(j) ,f(x) = \sum_{j = 1}^x j $.</p>
<p>显然原式变成 ： </p>
<script type="math/tex; mode=display">
\sum_{d=1}^n d \times S({\lfloor \frac{n}{d} \rfloor})</script><p>因为 $ \lfloor \frac{n}{d} \rfloor $ 被重复计算多次，显然考虑数论分块。  </p>
<p>于是原式化为 ： </p>
<script type="math/tex; mode=display">
\sum(f(r) - f(l-1)) \times S(\lfloor \frac{n}{l} \rfloor)</script><p>预处理 $f(x),S(x)$ 的值，最终对于 $T$ 次询问总的时间复杂度是 $O(n + T \sqrt{n} )$ ,可以通过本题。</p>
<h3 id="欧几里得算法"><a href="#欧几里得算法" class="headerlink" title="欧几里得算法"></a>欧几里得算法</h3><p>求gcd用的，大家应该都会写 ：  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> b ? <span class="built_in">gcd</span>(b,a % b) : a;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这是经典的辗转相除，我还找到了经过归纳得出的非递归写法 ： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">gcd</span><span class="params">(<span class="type">int</span> x, <span class="type">int</span> y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">while</span>(y ^= x ^= y ^= x %= y);</span><br><span class="line">    <span class="keyword">return</span> x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>看起来很怪，但是应该是对的（尽管我没有对拍过）  </p>
<p>当然也可以直接使用 <code>__gcd()</code>来得到GNU的支援（  </p>
<p>证明的话我打算放在<a href="http://pukui.github.io/2022/07/24/%E6%95%B0%E8%AE%BA%E7%AE%97%E6%B3%95%E3%80%81%E5%AE%9A%E7%90%86%E5%92%8C%E5%B8%B8%E7%94%A8%E5%8F%98%E6%8D%A2/">数论算法、定理和常用变换</a>里头，这里就不展开说了，有兴趣的可以自己看看  </p>
<h3 id="裴蜀定理"><a href="#裴蜀定理" class="headerlink" title="裴蜀定理"></a>裴蜀定理</h3><p>（又称贝祖定理）  </p>
<p>对于任意不全为零的整数$a,b$ 都 $\exists x,y \in Z$ ，使得 $ ax+by = gcd(x,y)$。<br>对于不定方程 $ax + by = m$ ，其有解的充要条件是 $gcd(a,b) \mid m$</p>
<p>证明同上（   </p>
<h4 id="应用-："><a href="#应用-：" class="headerlink" title="应用 ："></a>应用 ：</h4><p>zh_dou : 用来做题  </p>
<blockquote>
<p>可以用来证明奇奇怪怪的东西和推式子<br>信息上对于这东西常见的套路是枚举gcd​​​<br>如： 给你T组数据，求 $\sum_{i = 1}^n \sum_{j = 1}^m gcd(i,j)$<br>其中有一步是标准的枚举gcd（经典枚举gcd）  </p>
<script type="math/tex; mode=display">
\begin{split}
 & \sum_{i = 1}^n \sum_{j = 1}^m gcd(i,j)\\
 = & \sum_{i = 1}^n \sum_{j = 1}^m \sum_{d \mid i,j} d [gcd( \frac{i}{d} , \frac{j}{d}) = 1]
\end{split}</script></blockquote>
<h4 id="一些推论-："><a href="#一些推论-：" class="headerlink" title="一些推论 ："></a>一些推论 ：</h4><p>一、$a$,$b$可以组成所有 $gcd(a,b)$ 的倍数(其实是定理的直接结论，等式的基本性质)</p>
<p>二、 $a\bot b \Longleftrightarrow \exists x,y \in Z, ax+by=1$  </p>
<p>三、我们考察不定方程 $ax+by = n$ ,其中 $a \bot b$<br>若这个方程有一组解使得 $x \ge 0,y \ge 0$ ，那么称 $n$ 可以被 $a,b$ 表示。</p>
<p>那么 ： </p>
<p>对于互质的 $a,b$ ,记 $C = ab-a-b$ 。由 $a$ 与 $b$ 互质， $C$ 必然为奇数。则有结论 ：<br><strong>对任意的整数 $n$ ，$n$ 与 $C-n$ 中有且仅有一个可以被表示</strong>  </p>
<p>(就是zerc前两天没证出来的对称性，事实是这玩意不光是对的，而且还是裴蜀定理的推论) </p>
<p>所以对称性总结一下就是 ： </p>
<p>可表示的数与不可表示的数在区间 $[0,C]$ 对称（关于 $C$ 的一半对称）。 $0$ 可被表示， $C$ 不可被表示；负数不可被表示，大于 $C$ 的数可被表示。</p>
<p>证明 ：  </p>
<p>由于 $a \bot b$ ，原方程有整数解（ $gcd(a,b) = 1,ax + by = n \times gcd(a,b)$ ） 。<br>设一组特解为 $x= x_0,y = y_0$<br>则通解为： </p>
<script type="math/tex; mode=display">
\left\{\begin{matrix}
x = x_0 + bt \\
y = y_0 - at
\end{matrix}\right.</script><p>其中 $t \in Z$ 。不难发现我们可以通过调整 $t$ 的取值使得 $y \in [0,a-1]$ ，这只需要在 $y_0$ 上加减若干个 $a$ 。此时我们的 $y$ 已经满足条件了。  </p>
<p>第一步 ： 首先我们证明大于 $C$ 的数都可以被表示。当 $n$ 大于 $C$ 时：  </p>
<script type="math/tex; mode=display">
ax = n-by > ab-a-b-by \ge ab-a-b-b(a-1) = -a</script><p>也就是说: </p>
<script type="math/tex; mode=display">
ax > -a,x > -1</script><p>因为 $x$ 为整数,所以得到 $x$ 为非负整数， $n$ 可以被表示。  </p>
<p>第二步 ： 证明 $C$ 不可被表示，进而 $n$ 与 $C-n$ 不可能都被表示。<br>考虑反证法。</p>
<p>设 $C$ 可以被表示，也就是说 $ax+by = ab-a-b$ 有非负整数解 $x,y$ 。则 ：  </p>
<script type="math/tex; mode=display">
ab = a(x+1) + b(y+1)</script><p>要使等式成立，显然有 ： </p>
<script type="math/tex; mode=display">
a \le y+1,b \le x+1</script><p>(实际上大概连等号都挂不上罢)<br>而 $a \bot b$ ，且等号右边可以合并同类项，所以我们有 ：  </p>
<script type="math/tex; mode=display">
a \mid (y + 1),b \mid (x + 1)</script><p>显然上式化为 ： </p>
<script type="math/tex; mode=display">
ab = a(x + 1) + b(y + 1) \ge ab + ab = 2ab</script><p>而 $ab$ 显然不为0，矛盾。因此证得 $C$ 不可能被表示。   </p>
<p>此时若 $n$ 与 $C-n$ 都能被表示，则 $n$ 也能被表示，矛盾。因此我们得到 $n$ 与 $c - n$不可能都被表示。</p>
<p>所以第二步完成了</p>
<p>第三步 ： 证明如果 $n$ 不可以被表示，则 $C-n$ 一定能被表示 (即 $n$ 和 $C-n$ 一定有一个能被表示)</p>
<p>由上可知 ： 若 $n$ 不可能被表示，因为我们已经保证了有合法的 $y$ ，那么此时一定有 $x &lt; 0$ 。所以： </p>
<script type="math/tex; mode=display">
C - n = ab-a-b-ax-by = a(-x-1) + b(a-1-y)</script><p>所以 $-X-1$ 和 $a-1-y$ 均为非负，则 $C-n$ 可以被表示。</p>
<p>所以我们证明了对称性</p>
<p>然后那道考试题的等价题目就是<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/U238921">U238921</a><br>虽然这是一道魔改后的题目卡掉了原来的正解。<br>但是新的正解也不难的说（我一下午就看懂了    </p>
<h3 id="最小公倍数-lcm"><a href="#最小公倍数-lcm" class="headerlink" title="最小公倍数(lcm):"></a>最小公倍数(lcm):</h3><p>zh_dou : lcm  这东西在数论推柿子里因没有什么性质而遭到嫌弃  </p>
<p>对于只有两个数的时候　：　</p>
<script type="math/tex; mode=display">
lcm(i,j) = \frac{i * j}{gcd(i,j)}</script><p>但是对于多个数不成立,显然多个数的gcd很可能会丢失一些重复出现的因子。<br>例题是： <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1891">P1891</a></p>
<h2 id="扩展欧几里得算法-exgcd"><a href="#扩展欧几里得算法-exgcd" class="headerlink" title="扩展欧几里得算法(exgcd)"></a>扩展欧几里得算法(exgcd)</h2><h3 id="推导"><a href="#推导" class="headerlink" title="推导"></a>推导</h3><p>由裴蜀定理我们已知 ： $ax + by = gcd(a,b)$ 一定存在整数解。</p>
<p>使用 exgcd 可以得到上述方程的一组特解。  </p>
<p>考虑解这个方程，显然当 $b = 0$ 时我们有 : $x = 1,y \in Z$。</p>
<p>当 $b \neq 0$ 时，我们设：   </p>
<script type="math/tex; mode=display">
\begin{split}
&gcd(a,b) = ax_1 + by_1\\
&gcd(b,a \space mod \space b)  = bx_2 + (a \space mod \space b)y_2 = bx_2 + (a - \lfloor \frac{a}{b} \rfloor)y_2\\
\end{split}</script><p>两式左边相等，那么拆开括号就有 ：  </p>
<script type="math/tex; mode=display">
ax_1 + by_1 = ay_2 + b(x_2 - \lfloor \frac{a}{b} \rfloor y_2)</script><p>两边对应系数得 ： </p>
<script type="math/tex; mode=display">
x_1 = y_2,y_1 = x_2 - \lfloor \frac{a}{b} \rfloor y_2</script><p>成功了！  </p>
<p>于是我们就可以像求gcd一样递归求解了  </p>
<h3 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h3><p>按照这个式子写的代码长这样 ：  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">exgcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)</span><br><span class="line">    &#123;</span><br><span class="line">        x = <span class="number">1</span>;y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="type">int</span> d = <span class="built_in">exgcd</span>(b,a % b,x,y);</span><br><span class="line">    <span class="type">int</span> t = x;x = y;</span><br><span class="line">    y = t - a/b * y;</span><br><span class="line">    <span class="keyword">return</span> d;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>函数的返回值就是顺便求了一下gcd。</p>
<p>或者这样写 ：  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">exgcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)</span><br><span class="line">    &#123;</span><br><span class="line">       x = <span class="number">1</span>;y = <span class="number">0</span>;</span><br><span class="line">       <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">exgcd</span>(b,a%b,y,x);</span><br><span class="line">    y -= a/b*x;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>本质上是完全等价的，而且这个板子更好记一些</p>
<p>之后令 $g = gcd(a,b)$<br>则 $ lcm(a,b) = a * b / g$<br>又 $ ax + lcm(a,b) + by - lcm(a,b) = c$<br>所以就有 ： </p>
<script type="math/tex; mode=display">
a(x + b/g) + b(y - a/g) = c</script><h3 id="例题"><a href="#例题" class="headerlink" title="例题"></a>例题</h3><p>一个很强的板子是 <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5656">P5656</a> 。  </p>
<p>题意就是 ：  </p>
<p>$T(T \le 2e5)$组数据，每组给出 $a,b,c \in [1,10^9]$ ,询问使得  $ax+by = c$ 成立的解。  </p>
<p>若有正整数解，输出： </p>
<ul>
<li>正整数解的个数  </li>
<li>正整数解中最小的 $x$ 和最大的 $y$   </li>
<li>正整数解中最大的 $x$ 和最小的 $y$ </li>
</ul>
<p>否则，若有整数解，输出 ：  </p>
<ul>
<li>所有整数解中 $x$ 的最小正整数值， $y$ 的最小正整数值</li>
</ul>
<p>否则，输出 $-1$ </p>
<p>大概说一下这个题罢，虽然大概所有人都应该会写exgcd，但是能完整解决这道题的我觉得不多（  </p>
<script type="math/tex; mode=display">
ax + by = c</script><p>显然，$gcd(a,b) \mid (ax+by)$<br>故 $gcd(a,b) \nmid c$ 时无解  </p>
<p>然后我们就可以由exgcd求出一组整数 $x_0,y_0$ ，使得： </p>
<script type="math/tex; mode=display">
ax_0 + by_0 = gcd(a,b)</script><p>等号两边同除 $gcd(a,b)$ 后同乘 $c$ ，就是 ：  </p>
<script type="math/tex; mode=display">
a \frac{x_0c}{gcd(a,b)}+ b \frac{y_0c}{gcd(a,b)} = c</script><p>于是我们找到了原方程的一组整数特解 $x_1,y_1$ ： </p>
<script type="math/tex; mode=display">
x_1 = \frac{x_0c}{gcd(a,b)},y_1 = \frac{y_0c}{gcd(a,b)}</script><p>接下来考虑构造通解 ：  </p>
<p>对于 $\forall d \in Q $ ，必然有 ：  </p>
<script type="math/tex; mode=display">
a(x_1 + db) + b(y_1 - da) = c</script><p>所以对于整数通解只需要保证 $da,db \in Z$ 。  </p>
<p>设 $d$ 取到最小的可能的正值（实数）时 $d_x = db,d_y = da$ 那么任意解中这两个变量与 $x_1,y_1$ 的偏差一定分别是 $d_x$ 与 $d_y$ 的倍数。</p>
<p>那么显然最小时 $d_x = \frac{b}{gcd(a,b)} , d_y = \frac{a}{gcd(a,b)} $，在 $d = \frac{1}{gcd(a,b)} $ 时取到。</p>
<p>所以通解就是 ：  </p>
<script type="math/tex; mode=display">
x = x_1 + sd_x,y = y_1 - sd_y</script><p>其中 $s \in Z$  </p>
<p>而且 $x$ 与 $y$  取值的变化呈负相关。</p>
<p>显然而重要的 ： $s$ 越大， $x$ 越大， $y$ 越小，反之亦然。</p>
<p>考虑是否有正整数解的判定 ： </p>
<p>限制 $x &gt; 0$ ，则 $x_1 + sd_x &gt; 0 ,s &gt; -\frac{x_1}{d_x}$<br>限制 $y &gt; 0$ ，则 $y_1 - sd_y &gt; 0 ,s &lt; \frac{y_1}{d_y}$</p>
<p>所以若要有正整数解，则要满足 ：  </p>
<script type="math/tex; mode=display">
-\frac{x_1}{d_x} < s < \frac{y_1}{d_y}</script><p>当这个不等式无解时即无正整数解， $s$ 位于左端点时即为 $x$ 的最小正整数值， $s$ 位于右端点时即为 $y$ 的最小正整数值。</p>
<p>有解时即为有正整数解，正整数解个数就是在这个范围内的 $s$ 的个数，容易求得。</p>
<p>$x$ 的最大值和 $y$ 的最小值都是在 $s$ 的右端点取到，$x$ 的最小值和 $y$ 的最大值都是在 $s$ 的左端点取到。  </p>
<p>然后这道题就做完了。</p>
<p>代码的话就长这样 ：  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">namespace</span> Pozhu&#123;</span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> ll;</span><br><span class="line"><span class="type">int</span> T;</span><br><span class="line"><span class="type">int</span> a,b,c;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">work</span><span class="params">()</span></span>;</span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll ,ll )</span></span>;</span><br><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll ,ll ,ll&amp; ,ll&amp; )</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d&quot;</span>,&amp;T);</span><br><span class="line">    <span class="keyword">while</span>(T--) <span class="built_in">work</span>();</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">inline</span> <span class="type">void</span> <span class="title">work</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">&quot;%d%d%d&quot;</span>,&amp;a,&amp;b,&amp;c);</span><br><span class="line">    <span class="keyword">if</span>(c % <span class="built_in">gcd</span>(a,b))&#123;</span><br><span class="line">        <span class="built_in">puts</span>(<span class="string">&quot;-1&quot;</span>);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    ll x,y;</span><br><span class="line">    ll d = <span class="built_in">exgcd</span>(a,b,x,y);</span><br><span class="line">    x *= c / d;</span><br><span class="line">    y *= c / d;</span><br><span class="line">    ll p = b/d ,q = a/d ,k;</span><br><span class="line">    <span class="keyword">if</span>(x &lt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        k = <span class="built_in">ceil</span>((<span class="number">1.0</span> - x) / p);</span><br><span class="line">        x += p * k;</span><br><span class="line">        y -= q * k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        k = (x - <span class="number">1</span>) / p;</span><br><span class="line">        x -= p * k;</span><br><span class="line">        y += q * k;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(y &gt; <span class="number">0</span>)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,(y - <span class="number">1</span>) / q + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,x);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,(y - <span class="number">1</span>) % q + <span class="number">1</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,x + (y - <span class="number">1</span>) / q * p);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,y);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld &quot;</span>,x);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;%lld\n&quot;</span>,y + q * (ll) <span class="built_in">ceil</span>((<span class="number">1.0</span> - y) / q));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">exgcd</span><span class="params">(ll a,ll b,ll &amp;x,ll &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b)&#123;</span><br><span class="line">        x = <span class="number">1</span>;y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span> a;</span><br><span class="line">    &#125;</span><br><span class="line">    ll g = <span class="built_in">exgcd</span>(b,a % b,x,y);</span><br><span class="line">    ll t = x;</span><br><span class="line">    x = y;</span><br><span class="line">    y = t - (a/b) * y;</span><br><span class="line">    <span class="keyword">return</span> g;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function">ll <span class="title">gcd</span><span class="params">(ll a,ll b)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">return</span> !b ? a : <span class="built_in">gcd</span>(b,a % b);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">signed</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    Pozhu :: <span class="built_in">main</span>();</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>exgcd就到这里</p>
<h2 id="同余理论"><a href="#同余理论" class="headerlink" title="同余理论"></a>同余理论</h2><p>对于两整数 $a,b$ ，若 $a \space mod \space p = b \space mod \space p$ ,则称 $a$ 与 $b$ 在模 $p$ 意义下同余  </p>
<p>用符号表示就是熟悉的 $a \equiv b \space(\space mod \space p \space )$</p>
<h3 id="性质-1"><a href="#性质-1" class="headerlink" title="性质"></a>性质</h3><p>对称性 ： $a \equiv b \space(\space mod \space p) \Longrightarrow b \equiv a \space(\space mod \space p \space )$<br>可乘性 ： $a \equiv b \space(\space mod \space p) , c \equiv d \space(\space mod \space p \space ) \Longrightarrow ac \equiv bd \space(\space mod \space p \space )$</p>
<h3 id="应用"><a href="#应用" class="headerlink" title="应用"></a>应用</h3><p>应用较少，主要在定理的证明和表达中使用。  </p>
<h3 id="求解线性同余方程"><a href="#求解线性同余方程" class="headerlink" title="求解线性同余方程"></a>求解线性同余方程</h3><p>线性同余方程是指形如 $ax \equiv b \space(\space mod \space p)$ 的方程，因为未知数的指数为 $1$ ，所以我们称之为一次同余方程或线性同余方程</p>
<p>解线性同余方程的方法是 ： 把同余式  $a x\equiv b \space(\space mod \space p \space )$ 转化成 $ax + kp = b$ ，然后使用exgcd求解<br>对于同余式 $a \equiv 1 \space(\space mod \space p \space )$ 的一个解是 $a$ 在模 $p$ 意义下的逆元。逆元稍后解释。</p>
<p>对于线性同余方程组的解法则需用到 中国剩余定理(CRT) 和 扩展中国剩余定理(exCRT) ，详见<a href="http://pukui.github.io/2022/07/24/%E6%95%B0%E8%AE%BA%E7%AE%97%E6%B3%95%E3%80%81%E5%AE%9A%E7%90%86%E5%92%8C%E5%B8%B8%E7%94%A8%E5%8F%98%E6%8D%A2/">数论算法、定理和常用变换</a></p>
<p>板子题是<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P1082">P1082</a>  </p>
<p>非常简单，直接放下代码罢</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span><span class="string">&lt;bits/stdc++.h&gt;</span></span></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> std;</span><br><span class="line"><span class="type">long</span> <span class="type">long</span> a,b,x,y;</span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">exgcd</span><span class="params">(<span class="type">long</span> <span class="type">long</span> a,<span class="type">long</span> <span class="type">long</span> b)</span></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(b == <span class="number">0</span>)  &#123;x = <span class="number">1</span>,y = <span class="number">0</span>;<span class="keyword">return</span>;&#125;</span><br><span class="line">    <span class="built_in">exgcd</span> (b,a % b);</span><br><span class="line">    <span class="type">long</span> <span class="type">long</span> m = x;</span><br><span class="line">    x = y;</span><br><span class="line">    y = m - (a / b) * y;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    cin&gt;&gt;a&gt;&gt;b;</span><br><span class="line">    <span class="built_in">exgcd</span>(a,b);</span><br><span class="line">    x = (x % b + b) % b;</span><br><span class="line">    cout&lt;&lt;x;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>（早期马蜂，看起来可能挺离谱的）</p>
<h3 id="求解高次同余方程"><a href="#求解高次同余方程" class="headerlink" title="求解高次同余方程"></a>求解高次同余方程</h3><p>求解高次同余方程有 $a^x\equiv b \space(\space mod \space p)$ 和 $x^a\equiv b \space(\space mod \space p\space )$ 两类问题。</p>
<p>前者可以使用 Baby Step,Giant Step (BSGS)算法解决，后者我不知道（（（  </p>
<p>所以照例详见<a href="http://pukui.github.io/2022/07/24/%E6%95%B0%E8%AE%BA%E7%AE%97%E6%B3%95%E3%80%81%E5%AE%9A%E7%90%86%E5%92%8C%E5%B8%B8%E7%94%A8%E5%8F%98%E6%8D%A2/">数论算法、定理和常用变换</a></p>
<p>于是 Part1 结束了！</p>
<hr>
<h1 id="Part-2"><a href="#Part-2" class="headerlink" title="Part 2"></a>Part 2</h1><p>这就是关于逆元的部分。<br>本来想扔一个<a href="http://pukui.github.io/2022/07/25/%E6%95%B0%E8%AE%BA%E6%9D%82%E8%B0%88/">数论杂谈</a>的链接走人，但是觉得不太妥当。所以就把那里边的内容添点东西粘贴过来（  </p>
<h2 id="快速幂"><a href="#快速幂" class="headerlink" title="快速幂"></a>快速幂</h2><p>作为逆元的前置知识排到这里罢。</p>
<p>快速幂就是对幂运算的二进制优化，使得计算  $x^k$ 的时间复杂度由 $O(k)$ 降为 $O(log \space k)$  </p>
<p>具体做法就是对指数进行二进制拆分，把幂次转换成二进制正次幂乘积的形式，举一个zh_dou博客里的例子就是 ： </p>
<script type="math/tex; mode=display">
105_{(10)} = 1101001_{(2)}</script><p>所以 </p>
<script type="math/tex; mode=display">
x^{105} = x^{2^6+2^5+2^3+2^0} = x^{2^6} x^{2^5} x^{2^3} x^{2^0}</script><p>代码实现非常短，应该都有肌肉记忆了（: </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">ksm</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="type">int</span> ans = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(;b;b&gt;&gt;=<span class="number">1</span>,a = a * a % p) <span class="keyword">if</span>(b &amp; <span class="number">1</span>) ans = ans * a % p;</span><br><span class="line">    <span class="keyword">return</span> ans;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="费马小定理"><a href="#费马小定理" class="headerlink" title="费马小定理"></a>费马小定理</h2><p>若 $p$ 为素数， $gcd(a,p) = 1$ ， 则 $a^{p-1} \equiv 1 \space (\space mod \space p)$。<br>另一个等价的形式是 ：<br>对于任意整数 $a$ ，有 $a^p \equiv a \space (\space mod \space p \space )$。  </p>
<h3 id="证明-："><a href="#证明-：" class="headerlink" title="证明 ："></a>证明 ：</h3><p>设一个质数 $p$ ，我们取一个不为 $p$ 倍数的数 $a$。<br>构造一个序列 ： $A = {1,2,3,\cdots,p-1}$，显然这个序列有这样一个性质 ： </p>
<script type="math/tex; mode=display">
\prod_{i=1}^nA_i \equiv \prod_{i = 1}^n (A_i \times a )\space (\space mod \space p\space )</script><p>对性质的证明 ：  </p>
<script type="math/tex; mode=display">
\because (A_i,p) = 1</script><script type="math/tex; mode=display">
\therefore (A_i \times a,p) = 1</script><p>又因为每个 $(A_i \times a )\space (\space mod \space p\space ) $ 都不同，且 $(A_i \times a )\space (\space mod \space p\space ) &lt; p $于是每一个 $A_i \times a $ 都对应了一个 $A_i$<br>所以 $(A_i \times a )\space (\space mod \space p\space ) $ 的取值取遍了 $[1,p-1]$<br>设 $f = (p-1)!$ ，则 $f \equiv a \times A_1 \times a \times A_2 \times \cdots \times a \times A_{p-1} (\space mod \space p\space )$</p>
<script type="math/tex; mode=display">
a^{p-1} \times f \equiv f (\space mod \space p\space )</script><p>所以  </p>
<script type="math/tex; mode=display">
a^{p-1} \equiv 1 (\space mod \space p\space )</script><p>故得证。我认为这个证明方法是最简单的一种。</p>
<h2 id="乘法逆元"><a href="#乘法逆元" class="headerlink" title="乘法逆元"></a>乘法逆元</h2><p>若 $a * x \equiv 1 (\space mod \space p\space )$<br>则x是a在模b意义下的逆元<br>大概是四种：    </p>
<h3 id="一、费马小定理-："><a href="#一、费马小定理-：" class="headerlink" title="一、费马小定理 ："></a>一、费马小定理 ：</h3><blockquote>
<p>若 $p \in prime,a\in N^*,a \perp p$ ，则有</p>
<script type="math/tex; mode=display">
a^{p-1} \equiv 1 (\ mod \ p)</script><p>所以显然 $a^{p-2}$ 即为所求。代码不放了，ksm板子应该都会</p>
</blockquote>
<h3 id="二、扩展欧几里得算法（exgcd）："><a href="#二、扩展欧几里得算法（exgcd）：" class="headerlink" title="二、扩展欧几里得算法（exgcd）："></a>二、扩展欧几里得算法（exgcd）：</h3><p>这个方法在单次查找中表现优异，要求少速度快。只要求 $a \perp p$ ，不要求 $p$ 是质数。（扩欧<del>不鸽的话</del>会写在<a href="https://pukui.github.io/2022/07/24/%E6%95%B0%E8%AE%BA%E5%AE%9A%E7%90%86%E5%92%8C%E5%B8%B8%E7%94%A8%E5%8F%98%E6%8D%A2/">数论算法、定理和常用变换</a>中）。代码也很好写:  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">exgcd</span><span class="params">(<span class="type">int</span> a,<span class="type">int</span> b,<span class="type">int</span> &amp;x,<span class="type">int</span> &amp;y)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(!b) &#123;</span><br><span class="line">        x = <span class="number">1</span>,y = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">exgcd</span>(b,a%b,y,x);</span><br><span class="line">    y -= a/b * x;</span><br><span class="line">&#125;</span><br><span class="line">x = (x % p + p) % p;</span><br></pre></td></tr></table></figure>
<p>这样求得的 $x$ 就是要求的逆元。</p>
<h3 id="三、线性求逆元-："><a href="#三、线性求逆元-：" class="headerlink" title="三、线性求逆元 ："></a>三、线性求逆元 ：</h3><p>适用于求多个连续数字的逆元，经典例题是 <a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P3811">P3811</a><br>先放下代码 ：<br><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">inv[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    inv[i] = (p - p/i) * inv[p % i] % p;</span><br></pre></td></tr></table></figure><br>然后我们就有了 $1~n$ 范围内的数模 $p$ 的逆元。<br>证明的话……<del>为什么不直接背过呢</del><br>我们已知 $1^{-1} \equiv 1 (mod \space p)$<br>然后设 $p = k * i + r,(i &lt; r &lt; i &lt; p) ,(1&lt;r&lt;i&lt;p)$ ，即 $k$ 是 $p/i$ 的商， $r$ 是余数。<br>再将这个式子放到模 $p$ 意义下就会得到 ：  </p>
<script type="math/tex; mode=display">
k \times i + r \equiv 0 \space ( \space mod \space p \space )</script><p>然后乘上 $i^{-1}r^{-1}$ 就会得到 ： </p>
<script type="math/tex; mode=display">
k \times r^{-1} + i^{-1} \equiv 0 \space ( \space mod \space p \space )</script><script type="math/tex; mode=display">
i^{-1} \equiv -k \times r^{-1} \space ( \space mod \space p \space )</script><script type="math/tex; mode=display">
i^{-1} \equiv - \lfloor \frac{p}{i}  \rfloor \times ( \space  p \space mod \space i \space )^{-1} \space ( \space mod \space p \space )</script><p>于是我们就可以从前面推出当前的逆元了。  </p>
<p>所以第二部分结束力  </p>
<h3 id="四、线性求任意-n-个数的逆元"><a href="#四、线性求任意-n-个数的逆元" class="headerlink" title="四、线性求任意 $n$ 个数的逆元"></a>四、线性求任意 $n$ 个数的逆元</h3><p>求给定数组 $a_i$ 中每一个元素的逆元：  </p>
<p>首先计算这 $n$ 个数的前缀积数组 $S$ ,然后对 $S_n$ 进行一个单独的求逆元，得到逆元为 $Sv_n$ ，也就是这 $n$ 个数逆元的乘积。</p>
<p>然后进行一个倒推，每次用 $Sv_i$乘上 $a_i$ ，就可以得到 $Sv_{i-1}$ （因为 $i$ 和 $i^{-1}$ 消掉了）</p>
<p>然后我们就得到了逆元的前缀积数组 $Sv$ </p>
<p>对于每次询问，我们只需要用 $S_{i-1} * Sv_i$ 就可以得到 $a_i$ 的逆元  </p>
<hr>
<h1 id="Part-3"><a href="#Part-3" class="headerlink" title="Part 3"></a>Part 3</h1><p>这里是基础筛法的部分。<br><del>所以我扔下一个链接走了<a href="http://pukui.github.io/2022/07/25/%E7%AD%9B%E6%B3%95%EF%BC%8C%E4%BA%9A%E7%BA%BF%E6%80%A7%E4%B8%8E%E7%BA%BF%E6%80%A7/">筛法，亚线性与线性</a></del><br>所以我又把旧博客CV过来了（连自己都抄是吧）  </p>
<h2 id="埃氏筛-埃拉托斯特尼筛法"><a href="#埃氏筛-埃拉托斯特尼筛法" class="headerlink" title="埃氏筛(埃拉托斯特尼筛法)"></a>埃氏筛(埃拉托斯特尼筛法)</h2><p>埃氏筛的思想简单易懂 ： 从小到大考虑范围内的每一个数，然后把质数的所有倍数都标记成合数，那么最后没有被标记的数就是质数了，下面给出代码 ： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//n为枚举上界，vis[i] == 1表示i为合数，p[]为质数数组，tot为质数个数，下同。</span></span><br><span class="line"><span class="function"><span class="type">void</span> <span class="title">Eratosthenes</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    vis[<span class="number">0</span>] = vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i])&#123;</span><br><span class="line">            p[++tot] = i;</span><br><span class="line">            <span class="keyword">if</span>(i * i &lt;= n)</span><br><span class="line">            <span class="keyword">for</span>(<span class="type">int</span> j = i*i;j&lt;=n;j+=i) vis[j] = <span class="number">0</span>;</span><br><span class="line">            <span class="comment">//小优化，2~i-1的倍数之前已经筛过了，直接从i的倍数开始可以加快速度</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>带有优化的埃氏筛的时间复杂度为 $O(n loglog n)$   </p>
<h2 id="欧拉筛"><a href="#欧拉筛" class="headerlink" title="欧拉筛"></a>欧拉筛</h2><p>欧拉筛是质数的线性筛法，也经常用来预处理 $\varphi$ 和 $\mu$ 的值<br>欧拉筛的特点是每个数只被自己的最小质因子筛去，因此是线性算法(所以欧拉筛在筛出合数的同时可以求出每个合数的最小质因子)。<br>下面给出欧拉筛处理 $\varphi$ 和 $\mu$ 的代码(代码中未取模) ：  </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">euler</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    mu[<span class="number">1</span>] = phi[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    vis[<span class="number">0</span>] = vis[<span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">if</span>(!vis[i]) &#123;p[++tot] = i;mu[i] = <span class="number">-1</span>;phi[i] = i<span class="number">-1</span>;&#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>;j&lt;=tot &amp;&amp; i * p[j]&lt;=n;j++)</span><br><span class="line">        &#123;</span><br><span class="line">            vis[i * p[j]] = <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">if</span>(i % p[j] == <span class="number">0</span>) &#123;</span><br><span class="line">                phi[i * p[j]] = phi[i] * p[j];</span><br><span class="line">                mu[i * p[j]] = <span class="number">0</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            mu[i * p[j]] = -mu[i];</span><br><span class="line">            phi[i * p[j]] = phi[i] * (p[j]<span class="number">-1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>欧拉筛预处理 $\varphi$ 和 $\mu$ 的过程完全依赖于他们的性质，他们的性质在文章<a href="http://pukui.github.io/2022/07/24/%E6%95%B0%E8%AE%BA%E5%87%BD%E6%95%B0%E6%80%BB%E7%BB%93/">数论函数总结</a>中有过提及。</p>
<p>第三部分就是这么短命。</p>
<hr>
<h1 id="Part-4"><a href="#Part-4" class="headerlink" title="Part 4"></a>Part 4</h1><p>这里有一些数论函数和基础定理。</p>
<p>所以我当然要扔链接：<br><a href="http://pukui.github.io/2022/07/24/%E6%95%B0%E8%AE%BA%E5%87%BD%E6%95%B0%E6%80%BB%E7%BB%93/">数论函数总结</a><br><a href="http://pukui.github.io/2022/07/24/%E6%95%B0%E8%AE%BA%E7%AE%97%E6%B3%95%E3%80%81%E5%AE%9A%E7%90%86%E5%92%8C%E5%B8%B8%E7%94%A8%E5%8F%98%E6%8D%A2/">数论算法、定理和常用变换</a></p>
<h2 id="数论函数"><a href="#数论函数" class="headerlink" title="数论函数"></a>数论函数</h2><h3 id="一、欧拉函数-varphi-n"><a href="#一、欧拉函数-varphi-n" class="headerlink" title="一、欧拉函数$\varphi(n)$"></a>一、欧拉函数$\varphi(n)$</h3><p>1.定义 ： 小于$x$的正整数中与x互质的数的个数，即 ：  </p>
<script type="math/tex; mode=display">
\varphi(n)  \sum_{i<n}[i \perp x]</script><p>（任何数都与1互质）<br>其中约定$\varphi(1) = 1$  </p>
<p>2.性质 ：  </p>
<ol>
<li>对于质数 $p$ ，$\varphi(p) = p-1$<br>显然，除了质数本身的数都与他互质  </li>
<li>对于 $x = p^k,k \in N_{+}$ ,有 $\varphi(x) = (p-1) \times p^{k-1}$<br>证明 ： 所有 $p$ 的倍数都与 $x$ 不互质，其他所有数都与 $x$ 互质，$1\sim x$ 中 $p$ 的倍数恰好有 $p^{k-1}$ 个（包括 $x$ ），所以 $\varphi(x) = p^k - p^{k-1} = (p-1) \times p^{k-1}$  </li>
<li>欧拉函数是积性函数，即对于互质的两数 $p$ ， $q$ ，有 $\varphi(p \times q) = \varphi(p) \times \varphi(q)$<br>证明略  </li>
<li>对于数 $x$ 分解质因数的结果是 $x = \prod_{i = 1}^{n} p_i^{k_i}$ ，有 $\varphi(x) = x \prod_{i = 1}^{n} (1 - \frac{1}{p_i} )$<br>证明 ： 利用前几条定理代入即得  </li>
<li>若 $p \mid x \ \&amp;\&amp;\ p\in prime$ ，有 $ \varphi(p \times x) = p \times \varphi(x) $<br>证明 ： 使用性质4，连乘内容不变，前面 $x$ 变成 $p \times x$ 即得  </li>
<li>若 $p \nmid x \ \&amp;\&amp;\ p \in prime $，有 $\varphi(p \times x) = (p-1) \times \varphi(x) $<br>证明 ： p与x互质，由积性函数得到  </li>
<li>$\varphi * 1 = id$ </li>
</ol>
<p>3.求法 ：<br>对于单个欧拉函数求解可利用性质4分解质因数后求解<br>线性求欧拉函数则需要改一改欧拉筛，利用性质5、6求解 ：<br>筛去合数时，已知质数 $i$ 为其约数，判断 $p[j]$ 是否为 $i$ 的约数，由性质5、6求解。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span>(<span class="type">int</span> i = <span class="number">2</span>;i&lt;=n;i++)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span>(!vis[i]) phi[i] = i<span class="number">-1</span>,p[++tot] = i;  </span><br><span class="line">    <span class="keyword">for</span>(<span class="type">int</span> j = <span class="number">1</span>;j&lt;=tot &amp;&amp; i * p[j] &lt;= n;j++)</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="type">int</span> nx = i * p[j];</span><br><span class="line">        vis[nx] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span>(i % p[j]) phi[nx] = phi[i] * (p[j] - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            phi[nx] = phi[i] * p[j];</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>4.应用 ：<br>扩展欧拉定理 ： </p>
<script type="math/tex; mode=display">
a^{b} \equiv\left\{\begin{array}{ll}
a^{b \bmod \varphi(p)} & a \perp p \\
a^{b} & a \not \perp p, b<\varphi(p) \quad(\bmod p) \\
a^{b \bmod \varphi(p)+\varphi(p)} & a \not \perp p, b \geq \varphi(p)
\end{array}\right.</script><p>证明……<a target="_blank" rel="noopener" href="https://blog.csdn.net/synapse7/article/details/19610361">这个</a><br>可以降幂用，比方说luogu上头那道<a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P2480">古代猪文</a>  </p>
<hr>
<h3 id="二、莫比乌斯函数-mu-n"><a href="#二、莫比乌斯函数-mu-n" class="headerlink" title="二、莫比乌斯函数$\mu(n)$"></a>二、莫比乌斯函数$\mu(n)$</h3><p>1.定义 ：  </p>
<script type="math/tex; mode=display">
\mu(n)=\left\{\begin{array}{c}
&1, &n=1 \\
&(-1)^{k}, &n=p_{1} \cdot p_{2} \cdot \ldots \cdot p_{k} \\
&0, &\text { otherwise }
\end{array}\right.</script><p>2.性质 ：   </p>
<ol>
<li>积性函数  </li>
<li>与欧拉函数 ： <script type="math/tex; mode=display">
\sum_{d \mid n}\frac{\mu(d)}{d} = \frac{\varphi(n)}{n}</script>证明：令  </li>
<li>与组合数 ： <script type="math/tex; mode=display">
\sum_{d \mid n} \mu(d)=\sum_{i=0}^{k}\left(\begin{array}{l}
k \\
i
\end{array}\right) \cdot(-1)^{i}=\left\{\begin{array}{l}
1, n=1 \\
0, n>1
\end{array}\right.</script></li>
<li>$\mu * 1 = \varepsilon $<script type="math/tex; mode=display">
\sum_{d\mid n}\mu(d) = \left\{\begin{array}{c}
&1&(n=1)  \\
&0&(n=0)
\end{array}\right.</script></li>
<li>$id * \mu = \varphi $</li>
<li>无穷级数（没见用过） ： <script type="math/tex; mode=display">
\sum_{n = 1}^{\infty} \frac{\mu(n)}{n} = 0\\
\sum_{n = 1}^{\infty} \frac{\mu(n) \cdot ln(n)}{n} = -1\\
\sum_{n = 1}^{\infty} \frac{\mu(n) \cdot x^n}{1-x^n} = x\\</script></li>
</ol>
<h3 id="三、幂函数-id-k-n"><a href="#三、幂函数-id-k-n" class="headerlink" title="三、幂函数$id^k(n)$"></a>三、幂函数$id^k(n)$</h3><p>1.定义 ： </p>
<script type="math/tex; mode=display">
id_k(n) = n^k</script><p>特别地，当 $k = 1$ 时，<script type="math/tex">id(n) = n</script>被称为单位函数（也称恒等函数），当$k = 0$时，函数变为<script type="math/tex">1(n) = 1</script>，是常数函数  </p>
<p>2.性质 ：  </p>
<ol>
<li>完全积性</li>
</ol>
<h3 id="四、因子个数函数-tau-n"><a href="#四、因子个数函数-tau-n" class="headerlink" title="四、因子个数函数$ \tau(n) $"></a>四、因子个数函数$ \tau(n) $</h3><p>1.定义 ： 因子个数函数$\tau$定义为正整数$n$的所有正因子个数</p>
<script type="math/tex; mode=display">
\tau(n) = \sum_{d \mid n}1</script><p>或</p>
<script type="math/tex; mode=display">
\tau(n) = \sum_{i=1}^{n}[d\mid n]</script><h3 id="五、除数函数-sigma-n"><a href="#五、除数函数-sigma-n" class="headerlink" title="五、除数函数$\sigma(n)$"></a>五、除数函数$\sigma(n)$</h3><p>1.定义 ： </p>
<script type="math/tex; mode=display">
\sigma_k(n) = \sum_{d\mid n}d^k</script><p>其中$k = 0$时通常简记作$d(n)$或$\tau(n)$，即因子个数函数，$k = 1$时通常简记作$\sigma(n)$</p>
<h3 id="六、单位函数-varepsilon-n"><a href="#六、单位函数-varepsilon-n" class="headerlink" title="六、单位函数$\varepsilon(n)$"></a>六、单位函数$\varepsilon(n)$</h3><p>1.定义 ： </p>
<script type="math/tex; mode=display">
\varepsilon(n) = [n = 1]</script><p>2.性质 ：<br>完全积性</p>
<p>数论函数我目前就整理了这些，欢迎补充。</p>
<h2 id="基础定理"><a href="#基础定理" class="headerlink" title="基础定理"></a>基础定理</h2><h3 id="卢卡斯定理"><a href="#卢卡斯定理" class="headerlink" title="卢卡斯定理"></a>卢卡斯定理</h3><p>用于解决大组合数取模问题的定理，要求模数必须为素数。  </p>
<p>内容如下 ：  </p>
<script type="math/tex; mode=display">
\binom{n}{m} (\; mod \; p\; ) = \binom{n/p}{m/p} \times \binom{n \; mod \;p}{m \; mod \; p} \; (\; mod\; p\; )</script><h4 id="实现"><a href="#实现" class="headerlink" title="实现"></a>实现</h4><p>代码通常这样写 ： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function">ll <span class="title">lucas</span><span class="params">(ll n,ll m,ll p)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span>(m == <span class="number">0</span>) <span class="keyword">return</span> <span class="number">1ll</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">C</span>(n % p,m % p,p) * <span class="built_in">lucas</span>(n / p,m / p,p) % p;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>其中 $C$ 是求组合数的函数，它的实现方式由题目数据范围而定。  </p>
<p>时间复杂度是 $O(f(p)+g(n)log \; n)$ ，其中 $f(n)$ 是预处理组合数的复杂度, $g(n)$ 是单次求组合数的复杂度。</p>
<h4 id="证明"><a href="#证明" class="headerlink" title="证明"></a>证明</h4><p>不打算讲证明，所以还是放到专门的文章里罢</p>
<p>我滴任务，完成啦！  </p>
<p>所以按照进度是讲完了，但是还可以再说一点大家都会的东西 ：   </p>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/U238921">某考试题等价题目</a>   </p>
<p><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/problem/P5171">上边这个题的前置</a>  </p>
<p><a target="_blank" rel="noopener" href="https://www.pozhu.cf/2022/08/11/%E9%B8%BD%E5%AD%90%E7%9A%84%E5%92%95%E5%92%95%E5%88%97%E8%A1%A8/">上边这个题的题解</a></p>
<p><a href="http://pukui.github.io/2022/07/24/%E6%95%B0%E8%AE%BA%E7%AE%97%E6%B3%95%E3%80%81%E5%AE%9A%E7%90%86%E5%92%8C%E5%B8%B8%E7%94%A8%E5%8F%98%E6%8D%A2/">一些知识点</a>  </p>
<p><a target="_blank" rel="noopener" href="https://www.pozhu.cf/">没人听</a></p>
<h1 id="参考资料-："><a href="#参考资料-：" class="headerlink" title="参考资料 ："></a>参考资料 ：</h1><p><a target="_blank" rel="noopener" href="https://oiwiki.org/">oi-wiki</a><br><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/blog/luo1gu1zui1bang1/tai-kai-di-ni-huo">WeLikeStudying’s blog</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/zh-dou/p/13264732.html">zh_dou’s blog</a><br><a target="_blank" rel="noopener" href="https://www.cnblogs.com/suxxsfe/p/12527185.html">suxxsfe’s blog</a><br><a target="_blank" rel="noopener" href="https://www.luogu.com.cn/blog/dengyaotriangle/solution-p5656">P5656官方题解</a><br>还有挂的链接的文章里的链接（ </p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="http://pukui.github.io">Pozhu</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="http://pukui.github.io/2022/08/15/%E6%95%B0%E8%AE%BA%E8%AE%B2%E8%AF%BE%C2%B7%E6%98%93/">http://pukui.github.io/2022/08/15/%E6%95%B0%E8%AE%BA%E8%AE%B2%E8%AF%BE%C2%B7%E6%98%93/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://pukui.github.io" target="_blank">Pozhu's blog</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E6%95%B0%E5%AD%A6/">数学</a><a class="post-meta__tags" href="/tags/%E6%95%B0%E8%AE%BA/">数论</a></div><div class="post_share"><div class="social-share" data-image="https://s1.328888.xyz/2022/08/10/4eqQn.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2022/08/17/%E5%A4%A7%E5%87%AF%E7%9A%84%E7%96%91%E6%83%91%EF%BC%88%E4%B9%B0%E7%9A%84%E5%88%B0%E7%9A%84%E6%95%B0%E7%9B%AE%EF%BC%89/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/08/10/4eHjg.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">大凯的疑惑（买的到的数目）</div></div></a></div><div class="next-post pull-right"><a href="/2022/08/12/%E9%B8%AD%E6%A3%8B/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/08/10/4etC7.webp" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">鸭棋</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2022/08/17/%E5%A4%A7%E5%87%AF%E7%9A%84%E7%96%91%E6%83%91%EF%BC%88%E4%B9%B0%E7%9A%84%E5%88%B0%E7%9A%84%E6%95%B0%E7%9B%AE%EF%BC%89/" title="大凯的疑惑（买的到的数目）"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/08/10/4eHjg.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-08-17</div><div class="title">大凯的疑惑（买的到的数目）</div></div></a></div><div><a href="/2022/07/24/%E6%95%B0%E8%AE%BA%E5%87%BD%E6%95%B0%E6%80%BB%E7%BB%93/" title="数论函数总结"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.luogu.com.cn/upload/image_hosting/senri1n5.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-24</div><div class="title">数论函数总结</div></div></a></div><div><a href="/2022/07/25/%E6%95%B0%E8%AE%BA%E6%9D%82%E8%B0%88/" title="数论杂谈"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.luogu.com.cn/upload/image_hosting/je7i52ig.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-25</div><div class="title">数论杂谈</div></div></a></div><div><a href="/2022/07/25/%E7%AD%9B%E6%B3%95%EF%BC%8C%E4%BA%9A%E7%BA%BF%E6%80%A7%E4%B8%8E%E7%BA%BF%E6%80%A7/" title="筛法，亚线性与线性"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.luogu.com.cn/upload/image_hosting/tmwhb4q3.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-25</div><div class="title">筛法，亚线性与线性</div></div></a></div><div><a href="/2022/07/24/%E7%B1%BB%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" title="类欧几里得算法学习笔记"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://cdn.luogu.com.cn/upload/image_hosting/eb9798hz.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-07-24</div><div class="title">类欧几里得算法学习笔记</div></div></a></div><div><a href="/2022/09/13/%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%8F%8D%E6%BC%94%E6%80%BB%E7%BB%93/" title="莫比乌斯反演总结"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/08/10/4eSMw.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2022-09-13</div><div class="title">莫比乌斯反演总结</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div id="comment-switch"><span class="first-comment">Giscus</span><span class="switch-btn"></span><span class="second-comment">Valine</span></div></div><div class="comment-wrap"><div><div id="giscus-wrap"></div></div><div><div class="vcomment" id="vcomment"></div></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/07/27/Ds1AN.png" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">Pozhu</div><div class="author-info__description"></div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">29</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">18</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">8</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/pukui"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/pukui" target="_blank" title="Github"><i class="fab fa-github"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">图片404可以用F5修复</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%86%85%E5%AE%B9%E6%91%98%E8%A6%81-%EF%BC%9A"><span class="toc-number">1.</span> <span class="toc-text">内容摘要 ：</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Part-1"><span class="toc-number">2.</span> <span class="toc-text">Part 1</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%AE%A9%E6%88%91%E4%BB%AC%E4%BB%8E%E6%95%B4%E9%99%A4%E5%BC%80%E5%A7%8B%EF%BC%8C%E8%BF%99%E6%A0%B7%E5%AF%B9%E5%90%A7"><span class="toc-number">2.1.</span> <span class="toc-text">让我们从整除开始，这样对吧</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%EF%BC%9A"><span class="toc-number">2.1.1.</span> <span class="toc-text">定义：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8%EF%BC%9A"><span class="toc-number">2.1.2.</span> <span class="toc-text">性质：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%A8%E6%95%B0%EF%BC%88%E7%B4%A0%E6%95%B0%EF%BC%89"><span class="toc-number">2.2.</span> <span class="toc-text">质数（素数）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8"><span class="toc-number">2.2.1.</span> <span class="toc-text">性质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B4%A0%E6%95%B0%E6%95%B0%E7%9B%AE%E7%9A%84%E8%AE%A1%E7%AE%97"><span class="toc-number">2.2.2.</span> <span class="toc-text">素数数目的计算</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B4%A0%E6%95%B0%E5%AE%9A%E7%90%86"><span class="toc-number">2.2.2.1.</span> <span class="toc-text">素数定理</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gcd%E4%B8%8Elcm"><span class="toc-number">2.3.</span> <span class="toc-text">gcd与lcm</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%92%E8%B4%A8"><span class="toc-number">2.3.1.</span> <span class="toc-text">互质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%A4%A7%E5%85%AC%E7%BA%A6%E6%95%B0%EF%BC%88gcd%EF%BC%89"><span class="toc-number">2.3.2.</span> <span class="toc-text">最大公约数（gcd）</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8-%EF%BC%9A"><span class="toc-number">2.3.2.1.</span> <span class="toc-text">性质 ：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95"><span class="toc-number">2.3.3.</span> <span class="toc-text">欧几里得算法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A3%B4%E8%9C%80%E5%AE%9A%E7%90%86"><span class="toc-number">2.3.4.</span> <span class="toc-text">裴蜀定理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%94%E7%94%A8-%EF%BC%9A"><span class="toc-number">2.3.4.1.</span> <span class="toc-text">应用 ：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E6%8E%A8%E8%AE%BA-%EF%BC%9A"><span class="toc-number">2.3.4.2.</span> <span class="toc-text">一些推论 ：</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%80%E5%B0%8F%E5%85%AC%E5%80%8D%E6%95%B0-lcm"><span class="toc-number">2.3.5.</span> <span class="toc-text">最小公倍数(lcm):</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95-exgcd"><span class="toc-number">2.4.</span> <span class="toc-text">扩展欧几里得算法(exgcd)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%8E%A8%E5%AF%BC"><span class="toc-number">2.4.1.</span> <span class="toc-text">推导</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%9E%E7%8E%B0"><span class="toc-number">2.4.2.</span> <span class="toc-text">代码实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%8B%E9%A2%98"><span class="toc-number">2.4.3.</span> <span class="toc-text">例题</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%90%8C%E4%BD%99%E7%90%86%E8%AE%BA"><span class="toc-number">2.5.</span> <span class="toc-text">同余理论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%A7%E8%B4%A8-1"><span class="toc-number">2.5.1.</span> <span class="toc-text">性质</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%94%E7%94%A8"><span class="toc-number">2.5.2.</span> <span class="toc-text">应用</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E8%A7%A3%E7%BA%BF%E6%80%A7%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B"><span class="toc-number">2.5.3.</span> <span class="toc-text">求解线性同余方程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B1%82%E8%A7%A3%E9%AB%98%E6%AC%A1%E5%90%8C%E4%BD%99%E6%96%B9%E7%A8%8B"><span class="toc-number">2.5.4.</span> <span class="toc-text">求解高次同余方程</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Part-2"><span class="toc-number">3.</span> <span class="toc-text">Part 2</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BF%AB%E9%80%9F%E5%B9%82"><span class="toc-number">3.1.</span> <span class="toc-text">快速幂</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B4%B9%E9%A9%AC%E5%B0%8F%E5%AE%9A%E7%90%86"><span class="toc-number">3.2.</span> <span class="toc-text">费马小定理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%81%E6%98%8E-%EF%BC%9A"><span class="toc-number">3.2.1.</span> <span class="toc-text">证明 ：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B9%98%E6%B3%95%E9%80%86%E5%85%83"><span class="toc-number">3.3.</span> <span class="toc-text">乘法逆元</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E8%B4%B9%E9%A9%AC%E5%B0%8F%E5%AE%9A%E7%90%86-%EF%BC%9A"><span class="toc-number">3.3.1.</span> <span class="toc-text">一、费马小定理 ：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E6%89%A9%E5%B1%95%E6%AC%A7%E5%87%A0%E9%87%8C%E5%BE%97%E7%AE%97%E6%B3%95%EF%BC%88exgcd%EF%BC%89%EF%BC%9A"><span class="toc-number">3.3.2.</span> <span class="toc-text">二、扩展欧几里得算法（exgcd）：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E7%BA%BF%E6%80%A7%E6%B1%82%E9%80%86%E5%85%83-%EF%BC%9A"><span class="toc-number">3.3.3.</span> <span class="toc-text">三、线性求逆元 ：</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E7%BA%BF%E6%80%A7%E6%B1%82%E4%BB%BB%E6%84%8F-n-%E4%B8%AA%E6%95%B0%E7%9A%84%E9%80%86%E5%85%83"><span class="toc-number">3.3.4.</span> <span class="toc-text">四、线性求任意 $n$ 个数的逆元</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Part-3"><span class="toc-number">4.</span> <span class="toc-text">Part 3</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%83%E6%B0%8F%E7%AD%9B-%E5%9F%83%E6%8B%89%E6%89%98%E6%96%AF%E7%89%B9%E5%B0%BC%E7%AD%9B%E6%B3%95"><span class="toc-number">4.1.</span> <span class="toc-text">埃氏筛(埃拉托斯特尼筛法)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AC%A7%E6%8B%89%E7%AD%9B"><span class="toc-number">4.2.</span> <span class="toc-text">欧拉筛</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Part-4"><span class="toc-number">5.</span> <span class="toc-text">Part 4</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E8%AE%BA%E5%87%BD%E6%95%B0"><span class="toc-number">5.1.</span> <span class="toc-text">数论函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E6%AC%A7%E6%8B%89%E5%87%BD%E6%95%B0-varphi-n"><span class="toc-number">5.1.1.</span> <span class="toc-text">一、欧拉函数$\varphi(n)$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E8%8E%AB%E6%AF%94%E4%B9%8C%E6%96%AF%E5%87%BD%E6%95%B0-mu-n"><span class="toc-number">5.1.2.</span> <span class="toc-text">二、莫比乌斯函数$\mu(n)$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%B9%82%E5%87%BD%E6%95%B0-id-k-n"><span class="toc-number">5.1.3.</span> <span class="toc-text">三、幂函数$id^k(n)$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%9B%A0%E5%AD%90%E4%B8%AA%E6%95%B0%E5%87%BD%E6%95%B0-tau-n"><span class="toc-number">5.1.4.</span> <span class="toc-text">四、因子个数函数$ \tau(n) $</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E9%99%A4%E6%95%B0%E5%87%BD%E6%95%B0-sigma-n"><span class="toc-number">5.1.5.</span> <span class="toc-text">五、除数函数$\sigma(n)$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%AD%E3%80%81%E5%8D%95%E4%BD%8D%E5%87%BD%E6%95%B0-varepsilon-n"><span class="toc-number">5.1.6.</span> <span class="toc-text">六、单位函数$\varepsilon(n)$</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E5%AE%9A%E7%90%86"><span class="toc-number">5.2.</span> <span class="toc-text">基础定理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%A2%E5%8D%A1%E6%96%AF%E5%AE%9A%E7%90%86"><span class="toc-number">5.2.1.</span> <span class="toc-text">卢卡斯定理</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9E%E7%8E%B0"><span class="toc-number">5.2.1.1.</span> <span class="toc-text">实现</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%81%E6%98%8E"><span class="toc-number">5.2.1.2.</span> <span class="toc-text">证明</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99-%EF%BC%9A"><span class="toc-number">6.</span> <span class="toc-text">参考资料 ：</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2022/09/27/9-25-9-26%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.25-9.26做题总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/09/14/cw0uK.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="9.25-9.26做题总结"/></a><div class="content"><a class="title" href="/2022/09/27/9-25-9-26%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.25-9.26做题总结">9.25-9.26做题总结</a><time datetime="2022-09-26T23:53:05.000Z" title="发表于 2022-09-27 07:53:05">2022-09-27</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/24/9-14-9-23%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.14-9.23做题总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/09/14/cbWjd.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="9.14-9.23做题总结"/></a><div class="content"><a class="title" href="/2022/09/24/9-14-9-23%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.14-9.23做题总结">9.14-9.23做题总结</a><time datetime="2022-09-23T23:46:52.000Z" title="发表于 2022-09-24 07:46:52">2022-09-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/21/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E8%87%AA%E5%8A%A8%E6%9C%BA/" title="有限状态自动机"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/09/14/cbpNo.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="有限状态自动机"/></a><div class="content"><a class="title" href="/2022/09/21/%E6%9C%89%E9%99%90%E7%8A%B6%E6%80%81%E8%87%AA%E5%8A%A8%E6%9C%BA/" title="有限状态自动机">有限状态自动机</a><time datetime="2022-09-21T01:55:14.000Z" title="发表于 2022-09-21 09:55:14">2022-09-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/15/%E6%95%B0%E5%AD%A6%E6%9D%82%E9%A1%B9/" title="数学杂项"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/09/14/cwytP.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="数学杂项"/></a><div class="content"><a class="title" href="/2022/09/15/%E6%95%B0%E5%AD%A6%E6%9D%82%E9%A1%B9/" title="数学杂项">数学杂项</a><time datetime="2022-09-15T14:11:24.000Z" title="发表于 2022-09-15 22:11:24">2022-09-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2022/09/14/9-11-9-13%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.11-9.13做题总结"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://s1.328888.xyz/2022/08/10/4eQhJ.webp" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="9.11-9.13做题总结"/></a><div class="content"><a class="title" href="/2022/09/14/9-11-9-13%E5%81%9A%E9%A2%98%E6%80%BB%E7%BB%93/" title="9.11-9.13做题总结">9.11-9.13做题总结</a><time datetime="2022-09-14T06:42:11.000Z" title="发表于 2022-09-14 14:42:11">2022-09-14</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2022 By Pozhu</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="chat_btn" type="button" title="聊天"><i class="fas fa-sms"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><div class="js-pjax"><script>if (!window.MathJax) {
  window.MathJax = {
    tex: {
      inlineMath: [ ['$','$'], ["\\(","\\)"]],
      tags: 'ams'
    },
    chtml: {
      scale: 1.2
    },
    options: {
      renderActions: {
        findScript: [10, doc => {
          for (const node of document.querySelectorAll('script[type^="math/tex"]')) {
            const display = !!node.type.match(/; *mode=display/)
            const math = new doc.options.MathItem(node.textContent, doc.inputJax[0], display)
            const text = document.createTextNode('')
            node.parentNode.replaceChild(text, node)
            math.start = {node: text, delim: '', n: 0}
            math.end = {node: text, delim: '', n: 0}
            doc.math.push(math)
          }
        }, ''],
        insertScript: [200, () => {
          document.querySelectorAll('mjx-container:not\([display]\)').forEach(node => {
            const target = node.parentNode
            if (target.nodeName.toLowerCase() === 'li') {
              target.parentNode.classList.add('has-jax')
            } else {
              target.classList.add('has-jax')
            }
          });
        }, '', false]
      }
    }
  }
  
  const script = document.createElement('script')
  script.src = 'https://cdn.jsdelivr.net/npm/mathjax/es5/tex-mml-chtml.min.js'
  script.id = 'MathJax-script'
  script.async = true
  document.head.appendChild(script)
} else {
  MathJax.startup.document.state(0)
  MathJax.texReset()
  MathJax.typeset()
}</script><script>function loadGiscus () {
  let nowTheme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light'

  const config = Object.assign({
    src: 'https://giscus.app/client.js',
    'data-repo': 'pukui/comment',
    'data-repo-id': 'R_kgDOIBC3iw',
    'data-category-id': 'DIC_kwDOIBC3i84CRme7',
    'data-mapping': 'pathname',
    'data-theme': nowTheme,
    'data-reactions-enabled': '1',
    crossorigin: 'anonymous',
    async: true
  },null)

  let ele = document.createElement('script')
  for (let key in config) {
    ele.setAttribute(key, config[key])
  }
  document.getElementById('giscus-wrap').insertAdjacentElement('afterbegin',ele)
}

function changeGiscusTheme () {
  const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'light'

  function sendMessage(message) {
    const iframe = document.querySelector('iframe.giscus-frame');
    if (!iframe) return;
    iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
  }

  sendMessage({
    setConfig: {
      theme: theme
    }
  });
}

if ('Giscus' === 'Giscus' || !false) {
  if (false) btf.loadComment(document.getElementById('giscus-wrap'), loadGiscus)
  else loadGiscus()
} else {
  function loadOtherComment () {
    loadGiscus()
  }
}</script><script>function loadValine () {
  function initValine () {
    const valine = new Valine(Object.assign({
      el: '#vcomment',
      appId: 'FT8G3pBXmRbzp9WigXTv6Myu-MdYXbMMI',
      appKey: 'pzv72ZU5yq0jHCmG9wbBuL1l',
      avatar: 'monsterid',
      serverURLs: 'https://FT8G3pBX.api.lncldglobal.com',
      emojiMaps: "",
      path: window.location.pathname,
      visitor: false
    }, null))
  }

  if (typeof Valine === 'function') initValine() 
  else getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js').then(initValine)
}

if ('Giscus' === 'Valine' || !false) {
  if (false) btf.loadComment(document.getElementById('vcomment'),loadValine)
  else setTimeout(loadValine, 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script src="//code.tidio.co/d8owaeytaz6ydoshtoescuj9qseqxpnf.js" async="async"></script><script>function onTidioChatApiReady() {
  window.tidioChatApi.hide();
  window.tidioChatApi.on("close", function() {
    window.tidioChatApi.hide();
  });
}
if (window.tidioChatApi) {
  window.tidioChatApi.on("ready", onTidioChatApiReady);
} else {
  document.addEventListener("tidioChat-ready", onTidioChatApiReady);
}

var chatBtnFn = () => {
  document.getElementById("chat_btn").addEventListener("click", function(){
    window.tidioChatApi.show();
    window.tidioChatApi.open();
  });
}
chatBtnFn()
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>